/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mendix/sys/Remote",["mendix/lang","mendix/ov","mendix/logger","mendix/lib/Error","mendix/lib/MxContext"],function(_1,ov,_2,_3,_4){var _5="mendix.sys.Remote",_6={text_message:_7,refresh_object_list:_8,refresh_class:_9,open_form:_a,download_file:_b,show_login:_c,logout:_d,close:_e};function _f(){this.toString=function(){return _5;};this.execute=function(_10,_11,_12,_13){if(!this.hasInstructions(_10)){if(_13){_13();}return;}var _14=_10.instructions.filter(_15),_16=_10.instructions.filter(function(_17){return !_15(_17);}),_18=!_12?_14.concat(_16):_16;var _19=_18.map(function(_1a){if(_1a.target!="system"||!(_1a.type in _6)){throw new _3("Unsupported instruction received from the server: "+JSON.stringify(_1a));}return _6[_1a.type].bind(null,_1a,_11||{});});_1.sequence(_19,_13);function _15(_1b){return _1b.type==="open_form"||_1b.type==="close";};};this.hasInstructions=function(_1c){return !!(_1c&&_1c.instructions!=null&&_1c.instructions.length);};this.hasValidation=function(_1d){return ov.hasValidations(_1d);};this.getValidations=function(_1e){return ov.getValidations(_1e);};};function _7(_1f,_20,_21){var _22=_1f.args,_23=_22.MessageContent,_24=_22.MessageType,_25=String(_22.MessageBlock)=="true";if(_23!=null&&_24!=null){(window.mx.ui[_24.toLowerCase()]||window.mx.ui.info)(_23,_25);}else{throw new _3(_5+".actTextMessage: message content is null");}if(_21){_21();}};function _8(_26,_27,_28){var _29=_26.args.mxobjects,_2a=[];if(_29&&_29.length){var _2b={},_2c=_29.length;while(_2c--){var obj=_29[_2c];if(typeof obj=="object"&&obj.objectType){var _2d=window.mx.data.setOrRetrieveMxObject(obj);_2b[_2d.getEntity()]=true;_2a.push((function(_2e){return function(cb){window.mx.data.update({guid:_2e.getGuid(),callback:cb});};})(_2d));}else{throw new _3(_5+"actRefreshObjectList: invalid json object");}}_2a=_2a.concat(Object.keys(_2b).map(function(_2f){return function(cb){window.mx.data.sendClassUpdate(_2f,cb);};}));_1.collect(_2a,_28);}else{if(_28){_28();}}};function _9(_30,_31,_32){var _33=_30.args.ObjectClass;if(_33!=null){window.mx.data.sendClassUpdate(_33);}else{}if(_32){_32();}};function _a(_34,_35,_36){var _37=_38(_34.context),_39=_34.args,_3a=_39.FormTarget;if(_39.FormGuid){_37.setContext(_39.FormEntity,_39.FormGuid);}else{_37.setTrackId(null);_37.setTrackEntity(null);}if(_3a=="popup"||_3a=="modal"){window.mx.router.openFormInPopup(_39.FormPath,{title:_39.FormTitle,width:_39.FormWidth,height:_39.FormHeight,resizable:_39.FormResizable,modal:_3a=="modal"},_37,null,_36);}else{window.mx.router.openFormInContent(_39.FormPath,_39.FormTitle,_37,null,_36);}function _38(_3b){var _3c=new _4();if(!_3b){return _3c;}var _3d="",_3e=_3b.items||[];for(var i=0,_3f;_3f=_3e[i];i++){var _40=_3f.guid,_41=_3f.classname;if(_41&&_40){_3c.setContext(_41,_40);if(_40==_3b.activeguid){_3d=_41;}}}if(_3d){_3c.setTrackEntity(_3d);}return _3c;};};function _b(_42,_43,_44){var _45=_42.args.FileDocument,_46=_42.args.Target;if(_45){window.mx.ui.downloadFile({mxobject:window.mx.data.setOrRetrieveMxObject(_45),target:_46});}if(_44){_44();}};function _c(_47,_48,_49){window.mx.ui.showLogin();if(_49){_49();}};function _d(_4a,_4b,_4c){window.mx.logout();if(_4c){_4c();}};function _e(_4d,_4e,_4f){_4e.origin.close(_4f);};return _f;});