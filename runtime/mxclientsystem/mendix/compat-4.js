/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mendix/compat-4",["mendix/lib/MxContext","mendix/lib/MxObject","mendix/lang","dojo/_base/kernel","dojo/_base/lang","dojo/number","mendix/exposed","mxui/startup","mendix/compat-5"],function(_1,_2,_3,_4,_5){var _6="6.0";dojo.require("dojo.number");_3.deprecate("mendix.lang",{runBindActions:"sequence",runAsyncActions:"collect",runActions:"sequence"},_6);_3.deprecate("mendix.lang","clone","dojo","clone",_6);_3.deprecate("mendix.lang","dupObject","dojo","clone",_6);_3.deprecate("mendix.lang","round","dojo.number","round",_6);_3.deprecate("mendix.lang","toFixed","dojo.number","round",_6);var _7={sequence:_3.sequence,collect:_3.collect};_5.mixin(_3,{sequence:function(_8,_9,_a){if(_9 instanceof Array){_4.deprecated("mendix.lang.sequence","Method signature has changed to sequence(seq, callback, scope)",_6);return _7.sequence.call(_3,_9,_a,_8);}else{return _7.sequence.apply(_3,arguments);}},collect:function(_b,_c,_d){if(_c instanceof Array){_4.deprecated("mendix.lang.collect","Method signature has changed to collect(coll, callback, scope)",_6);return _7.collect.call(_3,_c,_d,_b);}else{return _7.collect.apply(_3,arguments);}}});window.mx.moduleUrl=function(_e,_f){_4.deprecated("mx.moduleUrl","Use dojo.require.toUrl instead",_6);if(_f!==undefined){return dojo.moduleUrl(_e,_f);}return new dojo._Url(dojo.moduleUrl(_e)).path+"/";};_3.deprecate("mx.meta",{getMetaMap:"getMap"},_6);var _10=window.mx.meta;_5.mixin(_10,{getMetaEntity:function(_11,_12){_4.deprecated("mx.meta.getMetaEntity is deprecated, use getEntity instead","",_6);if(typeof _11!="string"){_4.deprecated("mx.meta.getEntity should have one parameter of type string, which is the entity name","",_6);var _13=_10.getEntity(_11.className),_14=_11.error,_15=_11.callback;if(!_13){_14&&_14.call(_12);}else{_15&&_15.call(_12,_13);}return _13;}return _10.getEntity.apply(_10,arguments);}});_3.deprecate("mx.metadata","mx.meta",_6);_3.deprecate("mx.server",{getResource:"get"},_6);_3.deprecate("mx.xas","action","mx.data","action",_6);var _16=window.mx.data,_17={},_18={types:{},guids:{}};for(var _19 in _16){_17[_19]=_16[_19];}var _1a=function(_1b,map){if(_1b.length==1&&map.length!=1){return _1b[0];}else{var _1c={};for(var i=0,l=map.length;i<l;i++){var _1d=map[i],_1e=_1b[i];if(_1e){_1c[_1d]=_1e;}}return _1c;}};var _1f=function(_20,_21){if(arguments.length>1){_4.deprecated("mx.data."+_20+": deprecated arguments, use use { xpath : '', resulttype : '', callback : callback, error : error } instead","",_6);_21=_1a([].slice.call(arguments,1),["xpath","callback","resulttype"]);}return _17[_20](_21);};_5.mixin(_16,{distributeChange:function(_22,_23,_24){_4.deprecated("mx.data.distributeChange is deprecated, use update instead","",_6);return _16.update({guid:_22,attr:_23,value:_24});},addChangeListener:function(_25,_26,_27){_4.deprecated("mx.data.addChangeListener is deprecated, use subscribe instead","",_6);return _16.subscribe({guid:_25,attr:_26,callback:_27});},removeChangeListener:function(_28){_4.deprecated("mx.data.removeChangeListener is deprecated, use unsubscribe instead","",_6);return _16.unsubscribe(_28);},subscribeToClass:function(_29,_2a){_4.deprecated("mx.data.subscribeToClass is deprecated, use subscribe instead","",_6);var id=_29.id,sub=_18.types,map=sub[id]||(sub[id]={});if(map[_2a]){return map[_2a];}else{var _2b=_16.subscribe({entity:_2a,callback:_5.hitch(_29,"objectUpdate")});return (map[_2a]=_2b);}},unSubscribeFromClass:function(_2c,_2d){_4.deprecated("mx.data.unSubscribeFromClass is deprecated, use unsubscribe instead","",_6);var id=_2c.id,sub=_18.types,_2e=sub[id]&&sub[id][_2d];if(_2e){_16.unsubscribe(_2e);delete sub[id][_2d];if(!_3.itemCount(sub[id])){delete sub[id];}}},subscribeToGUID:function(_2f,_30){_4.deprecated("mx.data.subscribeToGUID is deprecated, use subscribe instead","",_6);var id=_2f.id,sub=_18.guids,map=sub[id]||(sub[id]={});if(map[_30]){return map[_30];}else{var _31=_16.subscribe({guid:_30,callback:_5.hitch(_2f,"objectUpdate")});return (map[_30]=_31);}},unSubscribeFromGUID:function(_32,_33){_4.deprecated("mx.data.unSubscribeFromGUID is deprecated, use unsubscribe instead","",_6);var id=_32.id,sub=_18.guids,_34=sub[id]&&sub[id][_33];if(_34){_16.unsubscribe(_34);delete sub[id][_33];if(!_3.itemCount(sub[id])){delete sub[id];}}},xasAction:function(_35){_4.deprecated("mx.data.xasAction is deprecated, use action instead","",_6);var _36=_35.callback;_35.callback=function(_37,_38){return _36&&_36(_38,_37);};return _16.action.call(_16,_35);},action:function(_39){if(_39.caller){_4.deprecated("mx.data.action: deprecated arguments, use store property for caller parameter ({ store : { caller : obj }})","",_6);var _3a=_39.caller,_3b=_39.store||(_39.store={});_3b.caller=_39.caller;}if(_39.params){_17.action.apply(_16,arguments);}else{_4.deprecated("mx.data.action: deprecated arguments, use params property for action parameters","",_6);var _3c={context:_39.context,callback:_39.callback,error:_39.error,store:_39.store,onValidation:_39.onValidation,async:_39.async,params:_39};delete _39.context;delete _39.callback;delete _39.error;delete _39.store;delete _39.caller;delete _39.onValidation;delete _39.async;_17.action(_3c);}},getObjectsByXPath:function(){_4.deprecated("mx.data.getObjectsByXPath is deprecated, use get instead","",_6);var _3d=arguments;var _3e=(typeof _3d[1]=="function")?_1a(_3d,["xpath","callback","useCache"]):_1a(_3d,["xpath","options","callback","useCache"]);var _3f=_3e.xpath,_40=_3e.options||{},_41=_3e.callback,_42=_3e.error||_40.error;return _16.get({xpath:_3f,callback:_41,error:_40.error,count:_40.addcount,filter:{limit:_40.limit,offset:_40.offset,sort:_40.sort,attributes:_40.tags}});},getAttributeListByXPath:function(_43){_4.deprecated("mx.data.getAttributeListByXPath is deprecated, use get instead","",_6);_43=_43||{};var _44=_43.callback,_45=_43.error,_46=_43.options,_47=_43.attribute;return _16.get({xpath:_43.xpath,callback:function(_48){var _49={};for(var i=0,l=_48.length;i<l;i++){var _4a=_48[i].getAttribute(_47);_49[_4a]=_4a;}_44&&_44(_49);},error:_45,filter:{limit:_46.limit,offset:_46.offset,sort:_46.sort,attributes:[_47],distinct:true}});},getObjectsByXPathSchema:function(){_4.deprecated("mx.data.getObjectsByXPathSchema is deprecated, use get instead","",_6);var _4b=_1a(arguments,["xpath","options","callback","useCache"]),_4c=_4b.options||{},_4d=_4b.xpath,_4e=_4b.callback,_4f=_4b.error||_4c.error;return _16.get({xpath:_4d,callback:_4e,error:_4c.error,count:_4c.addcount,noCache:!_4b.useCache,filter:{id:_4c.queryid,limit:_4c.limit,offset:_4c.offset,sort:_4c.sort}});},getObjectsByMicroFlow:function(_50,_51,_52){_4.deprecated("mx.data.getObjectsByMicroFlow is deprecated, use get instead","",_6);_51=_51||{};_16.action({params:{actionname:_50,applyto:_51.applyto||"none",constraints:_51.constraints||"",guids:_51.guids||null},context:_51.context,callback:_52,error:function(e){_51.error?_51.error(e):_52&&_52([]);}});},getObjectsById:function(_53){_4.deprecated("mx.data.getObjectsById is deprecated, use get instead","",_6);var _54,_55,_56,_57;if(_53.length==null&&arguments.length==1){var _58=_53;_53=_58.ids;_54=_58.options;_55=_58.callback;_57=_58.error;_56=_58.nocache;}else{if(typeof arguments[1]=="function"){_55=arguments[1];_56=arguments[2];}else{_54=arguments[1];_55=arguments[2];_56=arguments[3];_57=_54?_54.error:null;}}_54=_54||{};return _16.get({guids:_53,callback:_55,error:_57,count:_54.addcount,filter:{limit:_54.limit,offset:_54.offset,sort:_54.sort,attributes:_54.tags}});},getObjectByXPath:function(_59){_4.deprecated("mx.data.getObjectByXPath is deprecated, use get instead","",_6);return _16.get({xpath:_59.xpath,callback:_59.callback,error:_59.error,filter:{limit:1}});},getObject:function(_5a,_5b,_5c){_4.deprecated("mx.data.getObject is deprecated, use get instead","",_6);var _5d=_1a(arguments,["objId","callback","nocache"]);return _16.get({guid:_5d.objId,error:_5d.error,callback:_5d.callback,noCache:_5d.nocache});},createObjectByClass:function(){_4.deprecated("mx.data.createObjectByClass is deprecated, use create instead","",_6);var _5e=arguments[0],_5f=arguments[1],_60=arguments[2],_61=arguments[3];if((typeof _5e!="string")&&(!(_5e instanceof String))){throw new Error(name+".createObjectByClass: parameter entity is not of type String");}else{if(typeof _5f!="function"){throw new Error(name+".createObjectByClass: parameter callbackFunction is not of type Function");}else{if(!(_60 instanceof _1)){}}}return _16.create({entity:_5e,callback:_5f,error:_61,context:_60});},createObject:function(_62){_4.deprecated("mx.data.createObject is deprecated, use create instead","",_6);return _16.create({entity:_62.className,callback:_62.callback,error:_62.error,context:_62.context});},deleteObjectsByGUID:function(_63,_64,_65){_4.deprecated("mx.data.deleteObjectsByGUID is deprecated, use remove instead","",_6);return _16.remove({guids:_63,callback:_64,error:_65});},saveObject:function(_66,_67){_4.deprecated("mx.data.saveObject is deprecated, use save instead","",_6);return _16.save({mxobj:_66,callback:_67.callback,error:_67.error});},commitObject:function(obj,_68){_4.deprecated("mx.data.commitObject is deprecated, use commit instead","",_6);return _16.commit({mxobj:obj,callback:_68.callback,error:_68.error});},rollbackObject:function(obj,_69){_4.deprecated("mx.data.rollbackObject is deprecated, use rollback instead","",_6);return _16.rollback({mxobj:obj,callback:_69.callback,error:_69.error});},deleteObject:function(obj,_6a){_4.deprecated("mx.data.deleteObject is deprecated, use remove instead","",_6);return _16.remove({guid:obj.getGuid(),callback:_6a.callback,error:_6a.error});},deleteMxObjects:function(_6b){_4.deprecated("mx.data.deleteMxObjects is deprecated, use remove instead","",_6);var ids=[],_6c=[],_6d=_6b.mxObjects;for(var i in _6d){ids.push(_6d[i].getGuid());_6c.push(_6d[i].getEntity());}_16.remove({guids:ids,callback:function(){for(var i=0,_6e;_6e=_6c[i];i++){_16.sendClassUpdate(_6e);}_6b.callback&&_6b.callback();},error:_6b.error});},sizeOfXPathSet:function(_6f){return _1f("sizeOfXPathSet",_6f);},sumOfXPathQuery:function(_70){_4.deprecated("mx.data.sumOfXPathQuery is deprecated, use sumOfXPathSet instead","",_6);return _1f("sumOfXPathSet",_70);},sizeOfXPathQuery:function(_71){_4.deprecated("mx.data.sizeOfXPathQuery is deprecated, use sizeOfXPathSet instead","",_6);return _1f("sizeOfXPathQuery",_71);},countOfXPathQuery:function(_72){_4.deprecated("mx.data.countOfXPathQuery is deprecated, use sizeOfXPathSet instead","",_6);return _1f("countOfXPathQuery",_72);},avgOfXPathQuery:function(_73){_4.deprecated("mx.data.avgOfXPathQuery is deprecated, use avgOfXPathSet instead","",_6);return _1f("avgOfXPathQuery",_73);},maxOfXPathQuery:function(_74){_4.deprecated("mx.data.maxOfXPathQuery is deprecated, use maxOfXPathSet instead","",_6);return _1f("maxOfXPathQuery",_74);},minOfXPathQuery:function(_75){_4.deprecated("mx.data.minOfXPathQuery is deprecated, use minOfXPathSet instead","",_6);return _1f("minOfXPathQuery",_75);},ceilingOfXPathQuery:function(_76){_4.deprecated("mx.data.ceilingOfXPathQuery is deprecated, use maxOfXPathSet instead","",_6);return _1f("maxOfXPathQuery",_76);},floorOfXPathQuery:function(_77){_4.deprecated("mx.data.floorOfXPathQuery is deprecated, use minOfXPathSet instead","",_6);return _1f("minOfXPathQuery",_77);}});_3.deprecate("mx.processor","mx.data",_6);_3.deprecate("mendix.lib.MxContext",{hasActiveClass:"hasTrackEntity",hasActiveGUID:"hasTrackId",hasTrackID:"hasTrackId",getActiveClass:"getTrackEntity",getActiveGUID:"getTrackId",getTrackID:"getTrackId",setActiveClass:"setTrackEntity",setActive:"setTrackEntity",setTrackID:"setTrackId",setContextFromMxObject:"setContext"},_6);_3.deprecate("mendix.lib.MxObject",{getGUID:"getGuid",getClass:"getEntity",getAttribute:"get",setAttribute:"set",hasAttribute:"has",getAttributeClass:"getAttributeType",inheritsOf:"inheritsFrom",hasSubClasses:"hasSubEntities",getSubClasses:"getSubEntities",hasSuperClasses:"hasSuperEntities",getSuperClasses:"getSuperEntities",getSelectorClass:"getSelectorEntity"},_6);_5.extend(_2,{save:function(_78){_4.deprecated("mendix.lib.MxObject.save is deprecated, use mx.data.save instead","",_6);return window.mx.data.save({mxobj:this,error:_78.error,callback:_78.callback});},commit:function(_79){_4.deprecated("mendix.lib.MxObject.commit is deprecated, use mx.data.commit instead","",_6);return window.mx.data.commit({mxobj:this,error:_79.error,callback:_79.callback});},rollback:function(_7a){_4.deprecated("mendix.lib.MxObject.rollback is deprecated, use mx.data.rollback instead","",_6);return window.mx.data.rollback({mxobj:this,error:_7a.error,callback:_7a.callback});},saveSequence:function(_7b){_4.deprecated("mendix.lib.MxObject.saveSequence is deprecated, use mx.data.save and mx.data.commit instead","",_6);var _7c=this;return window.mx.data.save({mxobj:_7c,callback:function(){window.mx.data.commit({mxobj:_7c,callback:function(){}});}});}});_3.deprecate("mendix.lib.MxMetaObject",{getGUID:"getGuid",getClass:"getEntity",hasAttribute:"has",getAttributeClass:"getAttributeType",inheritsOf:"inheritsFrom",hasSubClasses:"hasSubEntities",getSubClasses:"getSubEntities",hasSuperClasses:"hasSuperEntities",getSuperClasses:"getSuperEntities",getSelectorClass:"getSelectorEntity"},_6);});