
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mendix/lib/ObjectValidation",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mendix.lib.ObjectValidation");mendix.lib.MxValidator=mendix.lib.ObjectValidation=function(_4){var _5=_4.msg;var _6={};this.getGuid=function(){return mendix.ov.getGuid(_5);};this.getFields=this.getAttributes=function(){var _7=[];for(var i in _6){_7.push({name:i,reason:_6[i]});}return _7;};this.addField=this.addAttribute=function(_8,_9){if(_6[_8]!=undefined){return false;}else{_6[_8]=_9;}};this._addFields=function(_a){var _b=_a.errorFields;if((this.getGuid()==this.constructor.getGuid(_a))&&_b){for(var i=0;i<_b.length;i++){_6[_b[i].name]=_b[i].message;}}};this.removeField=this.removeAttribute=function(_c){if(_6[_c]!=undefined){delete _6[_c];return true;}else{return false;}};this.getErrorReason=this.getReasonByAttribute=function(_d){return (_6[_d]);};this.clone=function(){var s=new this.constructor({msg:_1.clone(_5)});for(var i in _6){s.addField(i,_6[i]);}return s;};this.toString=function(){var _e="";var _f="";for(var i in _6){_e=_e+""+i+" "+_6[i]+_f;_f="; ";}return _e;};this._addFields(_5);};mendix.lib.MxValidator.getGuid=mendix.lib.ObjectValidation.getGuid=function(msg){return mendix.ov.getGuid(msg);};mendix.ov={};_1.mixin(mendix.ov,{getGuid:function(msg){return (msg instanceof mendix.lib.ObjectValidation)?msg.getGuid():msg.guid;},getValidationByGUID:function(_10,g){var raw=this._getRawValidations(_10)||_10;var _11=null;_1.forEach(raw,function(msg){var _12=mendix.ov.getGuid(msg);if(_12==g){if(_11){_11._addFields(msg);}else{_11=new mendix.lib.ObjectValidation({msg:msg});}}});return _11;},hasValidations:function(_13){return (_13.datavalidation!=null);},_getRawValidations:function(_14){if(typeof _14.datavalidation=="string"){logger.error("Server message error : validations included as type String instead of Array, compensating via eval");_14.datavalidation=_1.fromJson(_14.datavalidation);}return _14.datavalidation;},getValidations:function(_15){var _16=[];var map={};var raw=this._getRawValidations(_15)||_15;if(raw){_1.forEach(raw,function(msg){var _17=mendix.ov.getGuid(msg);if(!map[_17]){map[_17]=new mendix.lib.ObjectValidation({msg:msg});_16.push(map[_17]);}else{map[_17]._addFields(msg);}});}map=null;return _16;},getValidation:function(msg){return new mendix.lib.ObjectValidation(msg);}});});