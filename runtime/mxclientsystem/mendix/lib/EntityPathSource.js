
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mendix/lib/EntityPathSource",["dojo","dijit","dojox","dojo/require!mendix/lib/DataSource"],function(_1,_2,_3){_1.provide("mendix.lib.EntityPathSource");_1.require("mendix.lib.DataSource");_1.declare("mendix.lib.EntityPathSource",mendix.lib.DataSource,{name:"mendix.lib.EntityPathSource",_pathElements:null,_objs:null,constructor:function(_4){this.inherited(arguments);this._pathElements=_4.path.split("/");},reload:function(_5){this._runQuery(_5);},refresh:function(_6){this._pageUpdate(_6);},entityUpdate:function(_7){this._runQuery(_7);},generateExport:function(_8){var _9=_1.map(this._objs,function(_a){return _a.getGuid();});_8.params=_1.mixin({},_8.params,{guids:_9,gridid:this._schemaId});mx.data.generateExport(_8);},_runQuery:function(_b){this.release();var _c=this.context.getTrackId(this._pathElements[0]);if(_c){mx.data.get({guid:_c,path:this._pathElements[1],callback:function(_d){_d=(_d instanceof Array)?_d:[];this._objs=_d;this.hold(_d);this._pageUpdate(_b);},error:function(e){mx.onError(e);_b&&_b();}},this);}else{this._objs=[];this._pageUpdate(_b);}},_pageUpdate:function(_e){var _f=this.getOffset(),_10=this._objs.slice(_f,_f+this.getPageSize());this._setObjects(_10);this._setSetSize(this._objs.length);mendix.lang.nullExec(_e);}});});