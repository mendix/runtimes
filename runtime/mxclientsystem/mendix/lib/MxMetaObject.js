
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mendix/lib/MxMetaObject",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mendix.lib.MxMetaObject");mendix.lib.MxMetaObject=function(_4){var _5=_4.json?_4.json:false;var _6=0;var _7={};var _8={};var _9=[];var _a={};var _b={};var _c={};var _d=this;var _e=0;if(_5){var _f=_5.guid;var _10=_5.objectType;}else{var _f="0";var _10="";}var _11=function(_12){return (_5.attributes[_12]);};this.getGuid=function(){return (_f);};this.has=function(_13){if(!(typeof (_13)=="string")){throw new Error("mendix.lib.MxMetaObject.has: parameter attr is not of type String.");}return (_5.attributes[_13]!=null);};this.isEnum=function(_14){if(!(typeof (_14)=="string")){throw new Error("mendix.lib.MxMetaObject.isEnum : parameter attr is not of type String.");}var _15=this.getAttributeType(_14);return ((_15=="Enum")||(_15=="EnumSet"));};this.isNumber=function(_16){if(!(typeof (_16)=="string")){throw new Error("mendix.lib.MxMetaObject.isNumber : parameter attr is not of type String.");}var _17=this.getAttributeType(_16);return /Integer|Float|Long|AutoNumber/.test(_17);};this.isPassword=function(_18){if(!(typeof (_18)=="string")){throw new Error("mendix.lib.MxMetaObject.isDate : parameter attr is not of type String.");}var _19=this.getAttributeType(_18);return (_19=="HashString");};this.isCurrency=function(_1a){if(!(typeof (_1a)=="string")){throw new Error("mendix.lib.MxMetaObject.isCurrency : parameter attr is not of type String.");}return (this.getAttributeType(_1a)=="Currency");};this.isDate=function(_1b){if(!(typeof (_1b)=="string")){throw new Error("mendix.lib.MxMetaObject.isDate : parameter attr is not of type String.");}var _1c=this.getAttributeType(_1b);return ((_1c=="Date")||(_1c=="DateTime"));};this.isLocalizedDate=function(_1d){if(this.isDate(_1d)){return /true/.test(_11(_1d)["localize"]);}else{return null;}};this.isBoolean=function(_1e){if(!(typeof (_1e)=="string")){throw new Error("mendix.lib.MxMetaObject.isBoolean : parameter attr is not of type String.");}var _1f=this.getAttributeType(_1e);return (_1f=="Boolean");};this.isReference=function(_20){if(!(typeof (_20)=="string")){throw new Error("mendix.lib.MxMetaObject.isReference : parameter attr is not of type String.");}var _21=this.getAttributeType(_20);return (!((_21!="ObjectReference")&&(_21!="ObjectReferenceSet")));};this.isObjectReference=function(_22){if(!(typeof (_22)=="string")){throw new Error("mendix.lib.MxMetaObject.isObjectReference : parameter attr is not of type String.");}return (this.getAttributeType(_22)=="ObjectReference");};this.isObjectReferenceSet=function(_23){if(!(typeof (_23)=="string")){throw new Error("mendix.lib.MxMetaObject.isObjectReferenceSet : parameter attr is not of type String.");}return (this.getAttributeType(_23)=="ObjectReferenceSet");};this.getOptions=function(_24){if(!(typeof (_24)=="string")){throw new Error("mendix.lib.MxMetaObject.getOptions : parameter attr is not of type String.");}else{if(!(this.isEnum(_24))){throw new Error("mendix.lib.MxMetaObject.getOptions : attribute '"+_24+"' is not an Enumeration.");}}try{var _25=false;if(_11(_24)){var arr=_11(_24)["options"];if(arr&&arr.length){_25=[];for(var i=0;i<arr.length;i++){for(var j in arr[i]){_25.push(arr[i][j]);}}}return _25;}}catch(e){return false;}};this.getEnumKeys=function(_26,_27){if(!this.isEnum(_26)){}var arr=_11(_26)["options"];var _28={};var ret=[];if(typeof (_27)=="string"){_27=_27.split(/,/);}for(var i=0;i<arr.length;i++){for(var j in arr[i]){_28[j]=arr[i][j];}}for(var i in _28){for(var j=0;j<_27.length;j++){if(_27[j]==_28[i]){ret.push(i);}}}return (ret.join(","));};this.getEnumMap=function(_29){if(!this.isEnum(_29)){return null;}var map=[];var arr=_11(_29)["options"];for(var i=0;i<arr.length;i++){for(var j in arr[i]){map.push({key:j,caption:arr[i][j]});break;}}return map;};this.getEnumKVPairs=function(_2a){if(!this.isEnum(_2a)){return null;}var map={};var arr=_11(_2a)["options"];for(var i=0;i<arr.length;i++){for(var j in arr[i]){map[j]=arr[i][j];}}return map;};this.getEnumValue=function(_2b,_2c){return _2c;};this.getEnumCaption=function(_2d,_2e){if(!this.isEnum(_2d)){return null;}var arr=_11(_2d)["options"];for(var i=0;i<arr.length;i++){var _2f=arr[i];for(var key in _2f){if(key==_2e){return _2f[key];}}}return _2e;};this.getReferenceAttributes=function(){var _30=[];for(var i in _5.attributes){if(this.isReference(i)){_30.push(i);}}return _30;};this.getAttributes=function(){var _31=[];for(var i in _5.attributes){_31.push(i);}return (_31);};this.getAttributesWithoutReferences=function(){var _32=[];for(var i in _5.attributes){if(!this.isReference(i)){_32.push(i);}}return _32;};this.getAttributeType=function(_33){if(!(typeof (_33)=="string")){throw new Error("mendix.lib.MxMetaObject.getAttributeType : parameter attr is not of type String.");}if(this.has(_33)){return (_11(_33)["type"]);}else{return false;}};this.getSelectorEntity=function(_34){if(!(typeof (_34)=="string")){throw new Error("mendix.lib.MxMetaObject.getSelectorEntity : parameter attr is not of type String.");}if(this.has(_34)){return _11(_34)["klass"];}else{return false;}};this.getEntity=function(){return (_5["objectType"]);};this.isA=function(_35){if(this.getEntity()==_35){return true;}return this.inheritsFrom(_35);};this.hasSuperEntities=function(){return (_5.properties["superclasses"].length!=0);};this.getSuperEntities=function(){var _36=_5.properties["superclasses"];if(typeof (_36)=="string"){return ([_36]);}else{return _36;}};this.hasSubEntities=function(){return (_5.properties["subclasses"].length!=0);};this.getSubEntities=function(){var _37=_5.properties["subclasses"];return (typeof (_37)=="string")?[_37]:_37;};this.serialize=function(){alert("mxobject.serialize : XXX");return (_1.toJson(_5,true));};this.dump=function(){return _1.toJson(_5).replace(/}/g,"}\n");};this.dumpAttribute=function(_38){return _5.attributes[_38].toSource();};this.inheritsFrom=function(_39){var _3a=this.getSuperEntities()||[];for(var i=0,_3b;_3b=_3a[i];i++){if(_39==_3b){return true;}var _3c=mx.meta.getEntity("System.User");if(_3c.inheritsFrom(_39)){return true;}}return false;};};});