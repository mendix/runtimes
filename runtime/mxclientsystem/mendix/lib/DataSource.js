
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mendix/lib/DataSource",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mendix.lib.DataSource");_1.declare("mendix.lib.DataSource",null,{name:"mendix.lib.DataSource",context:null,_pageSize:0,_offset:0,_pageObjs:null,_setsize:0,_holdObjs:null,_schemaId:"",constructor:function(_4){this.context=_4.context;this._pageSize=_4.page||0;this._offset=_4.offset||0;this._pageObjs=[];this._holdObjs=[];this._schemaId=_4.queryid||"";if(_4.load){logger.scream(this.name+".constructor : Do not pass callbacks into a constructor! Stop doing this!");mendix.lang.thread(_4.load);}},reload:function(_5){_5&&_5();},refresh:function(_6){_6&&_6();},update:function(_7){_7&&_7();},entityUpdate:function(_8){_8&&_8();},isValid:function(_9){_9&&_9(true);},destroy:function(){},_setSetSize:function(n){this._setsize=n;},_setObjects:function(_a){this._pageObjs=_a;},getSetSize:function(){return this._setsize||0;},getObjects:function(){return this._pageObjs||[];},getPageSize:function(){return this._pageSize;},setPageSize:function(n,_b){this._pageSize=n;if(_b){this.refresh(_b);}},getOffset:function(){return this._offset;},setOffset:function(n,_c){this._offset=n;if(_c){this.refresh(_c);}},first:function(_d){this._offset=0;if(_d){this.refresh(_d);}},last:function(_e){var _f=this.getSetSize();if(this._pageSize>=_f){this._offset=0;}else{this._offset=Math.floor((_f-1)/this._pageSize)*this._pageSize;}if(_e){this.refresh(_e);}},toPage:function(n,_10){var off=(n-1)*this._pageSize;if(off>=0&&off<this.getSetSize()){this._offset=off;}if(_10){this.refresh(_10);}},next:function(_11){if(this.atEnd()){this._offset=this.getSetSize()-this._pageSize;}else{this._offset=this._offset+this._pageSize;}if(_11){this.refresh(_11);}},previous:function(_12){if((this.getSetSize()<this._pageSize)||((this._offset-this._pageSize)<=0)){this._offset=0;}else{this._offset-=this._pageSize;}if(_12){this.refresh(_12);}},getStatusMessage:function(){var st=0,en=0,_13=this.getSetSize();if(_13!=0){st=this._offset+1;en=Math.min(this._offset+this._pageSize,_13);}return mx.ui.translate("mxui.lib.MxDataSource","status",[st,en,_13]);},generateExport:function(_14){_14.callback&&_14.callback();},atBeginning:function(){return (this._offset==0);},atEnd:function(){return !this._hasPaging()||(this._offset>=(this.getSetSize()-this._pageSize));},getAttributes:function(_15){return _1.map(this.getObjects(),function(obj){return obj.get(_15);});},getObject:function(_16){var _17=this.getObjects();for(var i=0,obj;obj=_17[i];++i){if(obj.getGuid()==_16){return obj;}}return null;},each:function(_18){return _1.map(this.getObjects(),_18);},insertMxObjectAtStart:function(obj){var _19=this._pageObjs;_19.unshift(obj);if(this._hasPaging()&&this._pageSize<_19.length){_19.pop();}this._setsize++;},insertMxObjectAtEnd:function(_1a){var _1b=this._pageObjs;_1b.push(_1a);if(this._hasPaging()!=0&&this._pageSize<_1b.length){_1b.shift();}this._setsize++;},clean:function(_1c){this._setsize=0;this._offset=0;this._pageObjs=[];_1c&&_1c();},hold:function(_1d){if(this._holdObjs.length){this.release();}this._holdObjs=this._holdObjs.concat(_1d);},release:function(){mx.data.release(this._holdObjs);this._holdObjs=[];},destroy:function(){this.release();},toString:function(){return this.name;},_hasPaging:function(){return this._pageSize!=0;},_pageUpdate:function(_1e){var _1f=this.getOffset(),_20=this._hasPaging()?this._objs.slice(_1f,_1f+this.getPageSize()):this._objs;this._setObjects(_20);this._setSetSize(this._objs.length);mendix.lang.nullExec(_1e);}});(function(){var _21=mendix.lib.DataSource.prototype;_21.size=_21.getSize=_21.getSetSize;_21.getGeneratedXPath=_21.getCurrentXPath;})();});