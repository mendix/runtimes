
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mendix/lib/SimpleXPathSource",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mendix.lib.SimpleXPathSource");_1.declare("mendix.lib.SimpleXPathSource",[mendix.lib.XPathSourceBase],{name:"mendix.lib.SimpleXPathSource",_xpath:"",_count:0,constructor:function(_4){var _5=_4.path;this._xpath="//"+_4.entity+this.getStaticConstraint();if(_5.length){this._xpath+="["+_5.reverse().join("/")+"=\"[%CurrentObject%]\"]";}},reload:function(_6){this._runQuery(_6);},refresh:function(_7){this._runQuery(_7);},update:function(_8){this._runQuery(_8);},getCurrentXPath:function(){return this._xpathString();},entityUpdate:function(_9){this._runQuery(_9);},_runQuery:function(_a){var _b=this._xpathString();if(_b){mx.data.get({xpath:this.getCurrentXPath(),filter:this.getFilterOptions(),count:true,callback:function(_c,_d){this._setObjects(_c);this._setSetSize(_d.count);mendix.lang.nullExec(_a);},error:function(e){mx.onError(e);mendix.lang.nullExec(_a);}},this);}else{this._setObjects([]);this._setSetSize(0);mendix.lang.nullExec(_a);}},_xpathString:function(){var _e=this._xpath+this.getConstraints();if(/\[%CurrentObject%\]/.test(_e)){var _f=this.context.getTrackId();if(_f){return _e.replace(/\[%CurrentObject%\]/g,this.context.getTrackId());}else{return "";}}else{return _e;}}});});