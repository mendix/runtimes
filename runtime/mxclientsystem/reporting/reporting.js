
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
require({cache:{"reporting/widget/_base":function(){define(["dojo","dijit","dojox","dojo/require!reporting/widget/Report,reporting/widget/ReportMatrix,reporting/widget/ReportChart,reporting/widget/ReportTrigger,reporting/widget/ReportParameter,reporting/widget/DateRange"],function(_1,_2,_3){if(!reporting.widget){reporting.widget={};}_1.provide("reporting.widget._base");_1.require("reporting.widget.Report");_1.require("reporting.widget.ReportMatrix");_1.require("reporting.widget.ReportChart");_1.require("reporting.widget.ReportTrigger");_1.require("reporting.widget.ReportParameter");_1.require("reporting.widget.DateRange");mxui.dom.insertCss("mxclientsystem/reporting/ui/base.css?"+_1.config.cacheBust);});},"reporting/widget/Report":function(){define(["dojo","dijit","dojox","dojo/require!reporting/mixin/_Reportable"],function(_4,_5,_6){_4.provide("reporting.widget.Report");_4.require("reporting.mixin._Reportable");mxui.widget.declare("reporting.widget.Report",{mixins:[_5._TemplatedMixin,_5._Container,_5._Contained,mxui.mixin._Contextable,reporting.mixin._Reportable],inputargs:{content:"",reportid:"",startdormant:true},isContainer:true,constructor:function(){this.templatePath=null;this.templateString="<div class='reportingReport'></div>";this.content="";this.startdormant=true;this.domNode=null;var _7="";this.postCreate=function(){this.initContext();this.sequence(["actFetchContent","actRenderContent","actLoaded"]);};this.actFetchContent=function(_8){this.domNode.appendChild(mx.ui.getTemplate(this.mxid,"content"));_8&&_8();};this.actRenderContent=function(_9){var _a=mxui.html.parser.parse(this.domNode,{mxform:this.mxform});mxui.widget.fireOnReady(_a,_9);};this.uninitialize=function(_b){try{mxui.widget.destroyChildren(this.domNode);}catch(e){}};}});});},"reporting/mixin/_Reportable":function(){define(["dojo","dijit","dojox"],function(_c,_d,_e){_c.provide("reporting.mixin._Reportable");_c.declare("reporting.mixin._Reportable",null,{inputargs:["reportid"],fetchReportParams:function(){},registerContent:function(){reporting.store.ParameterStore.registerLead(this.mxform.hash,this.reportid);},actContentHook:function(_f){mendix.lang.delay(_f,function(){return true;},1000);},uninitialize:function(){}});});},"reporting/widget/ReportMatrix":function(){define(["dojo","dijit","dojox","dojo/require!reporting/lib/OQLSource,reporting/lib/MetaResult,reporting/store/ParameterStore,reporting/mixin/_Reportable"],function(_10,_11,_12){_10.provide("reporting.widget.ReportMatrix");_10.require("reporting.lib.OQLSource");_10.require("reporting.lib.MetaResult");_10.require("reporting.store.ParameterStore");_10.require("reporting.mixin._Reportable");mxui.widget.declare("reporting.widget.ReportMatrix",{mixins:[_11._TemplatedMixin,_11._Container,_11._Contained,mxui.mixin._Contextable,reporting.mixin._Reportable],inputargs:{testing:false,nested:false,flip:false,startdormant:false,showexportbutton:true,highlights:"",reportid:"",intervalvalues:"",target:"",pagesize:10,usepaging:false,columns:null},constructor:function(){this.templateString=_10.cache("reporting.widget","templates/ReportMatrix.html","<div class=\"mx-grid mx-reportmatrix\" style=\"display:none;\">\n\t<div class=\"mx-grid-controlbar clearfix\" focusIndex=\"0\">\n        <div class=\"mx-grid-pagingbar\" dojoAttachPoint=\"pagingNode\"></div>\n        <div class=\"mx-grid-toolbar\" dojoAttachPoint=\"toolBarNode\"></div>\n\t</div>\n\t<div class=\"mx-grid-content\" focusIndex=\"1\">\n        <table class=\"table table-bordered table-striped mx-reportmatrix-table\">\n            <thead dojoAttachPoint=\"theadNode\"></thead>\n            <tbody dojoAttachPoint=\"tbodyNode\"></tbody>\n            <tfoot dojoAttachPoint=\"tfootNode\"></tfoot>\n        </table>\n    </div>\n</div>\n");this.reportid="";this.startdormant=false;this.flip=false;this.highlights="";this.testing=false;this.intervalvalues="";this.target="";this.showexportbutton=true;this.alignment="";this.weights="";this.pagesize=10;this.usepaging=false;this.domNode=null;this.theadNode=null;this.tfootNode=null;this.tbodyNode=null;this.toolBarNode=null;this.btFirst=null;this.btPrevious=null;this.btNext=null;this.btLast=null;this.pagingNode=null;this.pagingStatusNode=null;this.returnValue=null;var _13=_10.hitch;var _14=mxui.dom.setOpacity;var _15=mxui.dom;var _16=null;var _17={};var _18=[];var _19={};var _1a=[];var _1b=[];var _1c=[];var _1d=[];var _1e=null;var _1f=function(_20){_20&&_20();};var _21=" ";this.postCreate=function(){this.initContext();var _22="context_seed_"+this.mxform.hash,_23=_10.subscribe(_22,_10.hitch(this,"contextNotification"));this.addOnDestroy(function(){_10.unsubscribe(_23);});this.sequence(["actInitialize","actSetupOQLSource","actSetupEvents","actLoaded"]);};this.applyContext=function(_24,_25){if(!this.startdormant){this.contextNotification(_24);this.sequence(["actRefreshMatrix","actUpdatePagingStatus"],_25);}else{this.startdormant=false;_25&&_25();}};var _26=function(_27){mxui.dom.show(this.domNode);_1b=_16.getSeriesData();_1c=_16.getSeriesDescriptives();_1d=_16.getIntervalDescriptives();_19=mendix.lang.arrayToObject(_16.getAggregateRows());var _28=_16.getSeriesTypes();_1e=new reporting.lib.MetaResult(_28);var _29=99/(_1c.length+1);_29=_29.toString()+"%";var i,tr;var _2a="";var _2b=_15.th();_2b.innerHTML="&nbsp;";_2b.setAttribute("width","1%");tr=_15.tr(_2b);this.theadNode.appendChild(tr);var _2c={};var _2d;for(i=0;i<_1c.length;i++){_2d=this.columns[i];_2a=_1c[i].toString();_2a=(_2a=="")?" ":_2a;_2b=_15.th(_2a);_2b.setAttribute("width",_2d.weight+"%");if(!_2d.weight){_2c[i]=true;}else{tr.appendChild(_2b);}mxui.dom.setClass(_2b,this._getAlignmentClass(_2d.alignment));}for(i=0;i<_1d.length;i++){_2a=_1d[i].toString();_2a=(/^\s*$/.test(_2a))?"&nbsp;":_2a;var _2e=_15.th();_2e.innerHTML=_2a;tr=_15.tr(_2e);tr.setAttribute("offset",i);if(_19[i]!=null){mxui.dom.setClass(tr,"mx-reportmatrix-aggregate-row");}for(var j=0;j<_1c.length;j++){if(!_2c[j]){_2a=(_1b[j][i]!=null)?_1b[j][i]:_21;if((typeof (_2a)!="boolean")&&(typeof (_2a)!="number")){_2a=(_2a=="")?" ":_1e.getRenderValue(j,_2a);}else{_2a=_1e.getRenderValue(j,_2a);}_2a=(_2a=="")?" ":_2a;_2b=_15.td(_2a);tr.appendChild(_2b);mxui.dom.setClass(_2b,this._getAlignmentClass(this.columns[j].alignment));}}this.tbodyNode.appendChild(tr);}_27&&_27();};this.actInitialize=function(_2f){if(this.reportid==""){logger.error(this.id+".actInitialize : No report parameter passed. Aborting!");throw ("No report parameter passed to Report Matrix : aborting!");}if(!this.usepaging){mxui.dom.hide(this.pagingNode);}this.registerContent();try{mxui.dom.empty(this.theadNode);mxui.dom.empty(this.tbodyNode);mxui.dom.empty(this.tfootNode);}catch(e){logger.warn(this.id+".actInitialize : can't clear body : "+e.message);}this.actFillMatrix=_10.hitch(this,_26);if(this.highlights!=""){this.highlights=this.highlights.split(/;/);for(var i=0;i<this.highlights.length;i++){highlights[this.highlights[i]]=true;}}_2f();};this.actSetupOQLSource=function(_30){_16=new reporting.lib.OQLSource({reportid:this.reportid,page:(this.usepaging)?this.pagesize:null,startdormant:true,load:_30});};this.actRunReport=function(_31){_16.execQuery(_31);};this.actFillMatrix=function(_32){_32();};this.actRefreshMatrix=function(_33){this.sequence(["actRunReport","actRefreshView",_33?_33:_1f]);};this.actRefreshView=function(_34){this.sequence(["actResetMatrix","actUpdatePagingStatus","actFillMatrix",_34?_34:_1f]);};this.actSetupEvents=function(_35){_18.push(_10.subscribe("report_"+this.mxform.hash,this,"topicUpdate"));this.connect(this.tbodyNode,"ondblclick","eventMatrixClicked");if(this.showexportbutton){var _36=new mxui.widget.Button({"caption":mx.ui.translate(this.declaredClass,"excel_btn_caption"),"onClick":_13(this,"eventExcelExportClicked"),"cssClasses":["reportingReportMatrix_exportButton"],"iconUrl":"mxclientsystem/reporting/ui/widget/images/ReportMatrix/icnExcel.gif"});this.toolBarNode.appendChild(_36.domNode);}else{mxui.dom.hide(this.toolBarNode);}if(this.usepaging){var ltr=this.isLeftToRight(),_37=document.createDocumentFragment(),$=mxui.dom.create;this.btFirst=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-step-backward":"glyphicon-step-forward"),"onClick":_10.hitch(this,"eventPagingButtonClicked","first")});_37.appendChild($("#",this.btFirst.domNode," "));this.btPrevious=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-backward":"glyphicon-forward"),"onClick":_10.hitch(this,"eventPagingButtonClicked","previous")});_37.appendChild($("#",this.btPrevious.domNode," "));this._pagingStatusNode=mxui.dom.div({"class":"dijitInline mx-grid-paging-status"});_37.appendChild($("#",this._pagingStatusNode," "));this.btNext=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-forward":"glyphicon-backward"),"onClick":_10.hitch(this,"eventPagingButtonClicked","next")});_37.appendChild($("#",this.btNext.domNode," "));this.btLast=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-step-forward":"glyphicon-step-backward"),"onClick":_10.hitch(this,"eventPagingButtonClicked","last")});_37.appendChild($("#",this.btLast.domNode," "));this.pagingNode.appendChild(_37);mxui.dom.disableSelection(this.pagingNode);}_35&&_35();};this.actResetMatrix=function(_38){try{mxui.dom.empty(this.theadNode);mxui.dom.empty(this.tbodyNode);mxui.dom.empty(this.tfootNode);}catch(e){logger.warn(this.id+".actResetMatrix : can't clear body : "+e.message);}_38&&_38();};this.actUpdatePagingStatus=function(_39){if(!this.usepaging){_39&&_39();return;}mxui.html.setContent(this._pagingStatusNode,_16.getStatusMessage());if(_16.atBeginning()){this.btFirst.set("disabled",true);this.btPrevious.set("disabled",true);}else{this.btFirst.set("disabled",false);this.btPrevious.set("disabled",false);}if(_16.atEnd()){this.btNext.set("disabled",true);this.btLast.set("disabled",true);}else{this.btNext.set("disabled",false);this.btLast.set("disabled",false);}_39&&_39();};this.topicUpdate=function(arr){_16.first(0);this.actRefreshMatrix();};this.contextNotification=function(_3a){var _3b=_3a.getParams();for(var p in _3b){_17[p]=_3b[p];}_16.first(0);_16.setParams(_17);};this.contextUpdate=function(){};this.eventMatrixClicked=function(e){var _3c=e.target;var tr=_3c.parentNode;var _3d=parseInt(tr.getAttribute("offset"));var _3e=this.createContext();_3e.dupFrom(this.mxcontext);var _3f=this.intervalvalues;if(_3f!=""){try{for(var i=0;i<_3f.length;i++){var key=_3f[i];if(key!=""&&!_3e.hasParam(key)){var _40=_1b[i][_3d];_3e.setParam(key,_40);}}}catch(e){}}if(this.target!=""){mx.ui.openForm(this.target,{context:_3e});}else{}};this.eventExcelExportClicked=function(e){mx.server.request({request:{action:"report_export_excel",params:{reportid:this.reportid,params:_16.getQueryParameters()}},options:{callback:mx.data.mxObjectsCallback(function(_41){mx.ui.downloadFile({mxobject:_41[0]});}),useCache:false}});};this.eventPagingButtonClicked=function(_42,e){switch(_42.toString().toLowerCase()){case "first":if(!_16.atBeginning()){_16.first(_13(this,"actRefreshView"));}break;case "last":if(!_16.atEnd()){_16.last(_13(this,"actRefreshView"));}break;case "next":if(!_16.atEnd()){_16.next(_13(this,"actRefreshView"));}break;case "previous":if(!_16.atBeginning()){_16.previous(_13(this,"actRefreshView"));}break;default:_10.debug(this.id+".eventPagingButtonClicked : no action matched. This shouldn't happen!");break;}};this.uninitialize=function(_43){try{_16.uninitialize();for(var i=0;i<_18.length;i++){_10.unsubscribe(_18[i]);}mxui.widget.destroyChildren(this.toolBarNode);}catch(e){}delete _16;};this._getAlignmentClass=function(_44){if(mx.ui.isRtl()){_44=_44=="right"?"left":"right";}return {left:"mx-left-aligned",right:"mx-right-aligned",center:"mx-center-aligned"}[_44];};}});});},"reporting/lib/OQLSource":function(){define(["dojo","dijit","dojox","dojo/require!reporting/store/ParameterStore"],function(_45,_46,_47){_45.provide("reporting.lib.OQLSource");_45.require("reporting.store.ParameterStore");reporting.lib.OQLSource=function(_48){var _49="reporting.lib.OQLSource";var _4a=this;var _4b=(_48.reportid||null);var _4c=(_48.context||null);var _4d=(_48.startdormant||true);var _4e=(_48.load||null);var _4f=_48.page;var _50=function(_51){_4e&&mendix.lang.thread(_4e);_51&&_51();};var _52="uninitialized";var _53={information:{title:"Empty report",xaxis:"X",yaxis:"Y"},interval_descriptives:[],series_descriptives:[],series_data:[]};var _54={};var _55={};var _56=0;var _57=0;var _58=_45.hitch;var _59=function(_5a){_5a&&_5a();};var _5b=function(){return _55;};var _5c=function(_5d){mx.server.request({request:{action:"report_retrieve_params",params:{actiontype:"retrieve_params",reportid:_4b}},options:{callback:function(_5e,res){if(!res||!res.report||!res.report.params){logger.error(_49+"["+_4b+"].actGetQueryParams.callback : No valid report parameters received!");}else{_54=res.report.params;}_5d();},error:function(e){mx.onError(e);_5d();}}});};var _5f=function(_60){reporting.store.ParameterStore.registerParams(_4b,_54);_60&&_60();};var _61=function(_62){mx.server.request({request:{action:"report",params:{reportid:_4b,offset:_56,limit:_4f||null,params:_5b()}},options:{callback:function(_63,res){if(!res||!res.report){logger.error(_49+"["+_4b+"].actExecQuery.callback : No valid report structure received!");}else{_53=res.report;if(res.report.information&&res.report.information.count){_57=res.report.information.count;}}_62();},error:function(e){mx.onError(e);_62();}}});};this.execQuery=function(_64){mendix.lang.sequence([_58(this,_61),_64||_59]);};var _65=_45.hitch(this,"execQuery");this.getQueryParameters=function(){return _5b();};this.setParameters=function(_66){return this.setParams(_66);};this.getInformation=function(){return _53.information;};this.getSeriesDescriptives=function(){return _53.series_descriptives;};this.getAggregateRows=function(){return _53.aggregate_rows||[];};this.getSeriesTypes=function(){return _53.series_info||[];};this.getIntervalType=function(){return _53.interval_info||{};};this.getIntervalDescriptives=function(){if((_53.interval_descriptives)&&(_53.interval_descriptives.length)&&(_53.interval_descriptives.length!=0)){return _53.interval_descriptives;}else{if(_53.series_data.length>0){var res=[];for(var i=0;i<_53.series_data[0].length;i++){res.push(" ");}return res;}else{return [];}}};this.getSeriesData=function(row){if(row){return (_53.series_data[row]);}else{return (_53.series_data);}};this.setParams=function(_67){_55={};for(var i in _67){if(!i.match(/_config_hash/)){if(_67[i]!=""){_55[i]=_67[i];}}else{if(!i.match(/_config_hash/)){}}}};this.size=function(){return _57;};this.getSize=function(){return this.size();};this.getPageSize=function(){return (_4f);};this.setPageSize=function(n,_68){_4f=n;_68&&_65(_68);};this.getOffset=function(){return (_56);};this.setOffset=function(n,_69){_56=n;_69&&_65(_69);};this.setPageSize=function(n,_6a){_4f=n;_6a&&_65(_6a);};this.getOffset=function(){return (_56);};this.first=function(_6b){_56=0;_6b&&_65(_6b);};this.last=function(_6c){if(_4f>=_57){_56=0;}else{_56=_57-_4f;}_6c&&_65(_6c);};this.next=function(_6d){if(_56>=(_57-_4f)){_56=_57-_4f;}else{_56+=_4f;}_6d&&_65(_6d);};this.previous=function(_6e){if((_57<_4f)||((_56-_4f)<=0)){_56=0;}else{_56-=_4f;}_6e&&_65(_6e);};this._getstats=function(){var _6f=_53;if(_6f){var _70=_6f.information.count;if(_70==null){_70=_57;}var _71=_6f.series_data;var agl=_6f.aggregate_rows?_6f.aggregate_rows.length:0;var _72=_71.length?_71[0].length-agl:0;var st=_72!=0?_56+1:_56;var en=_56+_72;return [st,en,_70];}return [0,0,0];};this.getStatusMessage=function(){return (mx.ui.translate("mxui.lib.MxDataSource","status",this._getstats()));};this.atBeginning=function(){return (_56==0);};this.atEnd=function(){var _73=this._getstats();return _73[1]>=_73[2];};mendix.lang.sequence([_58(this,_5c),_58(this,_5f),!_4d?_58(this,_61):_59,_50]);this.uninitialize=function(){delete _4a;};};});},"reporting/store/ParameterStore":function(){define(["dojo","dijit","dojox"],function(_74,_75,_76){_74.provide("reporting.store.ParameterStore");if(!reporting.store){reporting.store={};}reporting.store.ParameterStore=(new function(){var _77={};var _78={};var _79={};var _7a="reporting.store.ParameterStore";this.registerParams=function(id,_7b){_77[id]=_7b;if(_78[id]){for(var i=0;i<_78[id].length;i++){_78[id][i](_7b);}_78[id]=null;}};this.retrieveParams=function(id,_7c){if(_77[id]){_7c(_77[id]);}else{if(!_78[id]){_78[id]=[];}_78[id].push(_7c);}};this.registerLead=function(_7d,id){if(_79[_7d]){_79[_7d].push(id);}else{_79[_7d]=[id];}};this.retrieveLead=function(_7e){return _79[_7e]||[];};});});},"reporting/lib/MetaResult":function(){define(["dojo","dijit","dojox"],function(_7f,_80,_81){_7f.provide("reporting.lib.MetaResult");reporting.lib.MetaResult=function(_82){var _83=_82;var _84=[];var _85=[];var _86=_7f.hitch(mx.parser,"formatDate");this.getRenderValue=function(_87,_88){var _89=_83[_87];switch(_89.type){case "Boolean":var _8a=String(_88);return (_8a.match(/true|false/))?mx.ui.translate("mxui.widget.DataGrid",_8a):_88;break;case "Currency":case "String":case "AutoNumber":case "Int":case "Integer":case "Float":case "Long":case "URI":return String(_88);break;case "Date":case "DateTime":if(typeof (_88)=="string"){return String(_88);}else{var _8b=mx.parser.formatDate(_88,{datePattern:_89.format});if(mx.ui.isRtl()&&_8b){return _8b.split("‏/").reverse().join("/");}else{return _8b;}}break;case "Enum":if(_89.options){for(var i=0;i<_89.options.length;i++){var _8c=_89.options[i];for(var key in _8c){if(_88==key){return _8c[key];}break;}}}return _88;break;default:return String(_88);}};};});},"reporting/widget/ReportChart":function(){define(["dojo","dijit","dojox","dojo/require!reporting/lib/OQLSource,reporting/lib/ChartBuilder,reporting/mixin/_Reportable,reporting/FusionChartsFree/FusionChartsFree"],function(_8d,_8e,_8f){_8d.provide("reporting.widget.ReportChart");_8d.require("reporting.lib.OQLSource");_8d.require("reporting.lib.ChartBuilder");_8d.require("reporting.mixin._Reportable");_8d.require("reporting.FusionChartsFree.FusionChartsFree");mxui.widget.declare("reporting.widget.ReportChart",{mixins:[_8e._TemplatedMixin,_8e._Container,_8e._Contained,mxui.mixin._Contextable,reporting.mixin._Reportable],inputargs:{aspect:"",reportid:"",yaxisminimum:"",yaxismaximum:"",yaxisprecision:0,yaxiscaption:"",xaxiscaption:"",charttype:"",nested:false,startdormant:false,width:550,height:350},constructor:function(){this.templateString=_8d.cache("reporting.widget","templates/ReportChart.html","<div class=\"ReportCharts\" style=\"z-index:-1;display:none;\">\r\n\t<div style=\"clear:both\"/>\r\n\t<div style=\"text-align:center; padding:10px 0px 10px;\">\r\n\t\t<div dojoAttachPoint=\"chartNode\">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n");this.reportid="XXX";this.startdormant=false;this.charttype="";this.domNode=null;this.chartNode=null;this.width=550;this.height=350;this.aspect="";this.xaxiscaption="";this.yaxiscaption="";this.yaxisminimum=null;this.yaxismaximum=null;this.yaxisprecision=0;var _90=null;var _91="MSColumn3D";var _92="";var _93={};var _94=[];var _95="mxclientsystem/reporting/FusionChartsFree/charts/";this.returnValue=null;var _96=_8d.hitch;var _97=mxui.dom.hide;var _98=mxui.dom.show;var _99=_8d.addClass;var _9a=_8d.removeClass;var _9b=_8d.addClass;var _9c=mxui.dom.setClass;var _9d=mxui.dom.getClass;var _9e=mxui.dom.setOpacity;var _9f=mxui.dom;var _a0=null;var _a1={};var _a2=function(_a3){_a3&&_a3();};var _a4={MSBar2D:"",MSLine:"",MSArea2D:"",MSColumn2D:"",MSColumn3D:"",StackedArea2D:"",StackedBar2D:"",StackedColumn2D:"",StackedColumn3D:""};this.postCreate=function(){this.initContext();this.registerContent();if(this.charttype==""){}else{if(this.charttype in _a4){_91=this.charttype;}else{}}if(this.yaxisminimum!=""){this.yaxisminimum=parseFloat(this.yaxisminimum);}if(this.yaxismaximum!=""){this.yaxismaximum=parseFloat(this.yaxismaximum);}var _a5=["actSetupOQLSource","actSetupChart","actRegisterUIEvents"];if(!this.startdormant){_a5.push("actRunReport","actFillChart");}this.sequence(_a5);};this.applyContext=function(_a6,_a7){if(!this.startdormant){this.contextNotification(_a6);mendix.lang.runBindActions(this,["refresh"],_a7);}else{this.startdormant=false;_a7&&_a7();}};this.actSetupOQLSource=function(_a8){_a0=new reporting.lib.OQLSource({reportid:this.reportid,startdormant:this.startdormant,load:_a8});};this.actSetupChart=function(_a9){var swf="FCF_"+_91+".swf";var _aa=this.id+"_flashNode";var w=null;var h=null;var asp=null;if(this.aspect){try{var _ab=this.aspect.split(/:/);asp=(parseInt(_ab[1])/parseInt(_ab[0]));}catch(e){asp=0.5;}}else{asp=0.5;}var _ac=_8d._getContentBox(this.domNode.parentNode);if(_ac.w!=null){w=_ac.w;h=(w*asp)*0.7;w=w.toString();h=h.toString();}else{w=this.width;h=this.height;}_93={rendered:false,node:this.chartNode,flash:new FusionChartsFree(_95+swf,_aa,w,h,"0","1"),_id:_aa};_93.node.id=this.id+"_parentNode";this.loaded();_a9();};this.actRunReport=function(_ad){_a0.execQuery(_ad);};this.actFillChart=function(_ae){mxui.dom.show(this.domNode);_92=reporting.lib.ChartBuilder({oqlsource:_a0,ymin:this.yaxisminimum,ymax:this.yaxismaximum,precision:this.yaxisprecision,xcaption:this.xaxiscaption,xcaption:this.xaxiscaption,ycaption:this.yaxiscaption});try{if(_93.rendered){window.infosoftglobal.FusionChartsFreeUtil.updateChartXML(_93._id,_92);}else{_93.flash.setDataXML(_92);_93.rendered=true;_93.flash.render(_93.node.id);}}catch(e){logger.error(this.id+".actFillChart : Problem rendering chart : "+e.message);}_ae&&_ae();};this.actReloadChart=function(_af){this.sequence([_96(_a0,"refresh"),"actRefreshChart",_af?_af:_a2]);};this.actRegisterUIEvents=function(_b0){_94.push(_8d.subscribe("report_"+this.mxform.hash,this,"topicUpdate"));_b0();};this.refresh=function(_b1){this.sequence(["actRunReport","actFillChart",_b1||_a2]);};this.contextUpdate=function(){};this.topicUpdate=function(){this.refresh();};this.contextNotification=function(_b2){var _b3=_b2.getParams();for(var p in _b3){_a1[p]=_b3[p];}_a0.setParams(_a1);};this.uninitialize=function(_b4){try{_a0.uninitialize();for(var i=0;i<_94.length;i++){_8d.unsubscribe(_94[i]);}}catch(e){}delete _a0;};}});});},"reporting/lib/ChartBuilder":function(){define(["dojo","dijit","dojox"],function(_b5,_b6,_b7){if(!reporting.lib){reporting.lib={};}_b5.provide("reporting.lib.ChartBuilder");reporting.lib.ChartBuilder=function(_b8){var _b9=_b8.oqlsource;var _ba=_b9.getSeriesData();var _bb=_b9.getSeriesDescriptives();var _bc=_b9.getIntervalDescriptives();var _bd=_b9.getInformation();var _be=null;var _bf=null;var _c0=0;var _c1=new reporting.lib.MetaResult([_b9.getIntervalType()]);if(typeof (_b8.ymin)=="number"){_be=_b8.ymin;}if(typeof (_b8.ymax)=="number"){_bf=_b8.ymax;}if(typeof (_b8.precision)=="number"){_c0=_b8.precision;}var _c2={};_c2.multi=["38BDFF","387EFF","5638FF","B938FF","FF38A6","FF4538","FF8938","FFB538","FFDD38","F9FF38","C7F627","21F228"];_c2.single=["0099FF","0037FF","4800FF","C800FF","FF006A","FF3300","FF7900","FFAE00","FFE100","EAFF00","97CE0C","0CCE86"];var _c3=7;var _c4=0;var _c5=function(){_c4=_c3;};var _c6=function(_c7){_c4=(_c4==_c2[_c7].length)?0:_c4+1;return _c2[_c7][_c4];};var _c8=function(){var _c9=_b5.getObject("dojo.cldr.nls.number")||{};var _ca=(_b5.locale||"").toLowerCase().replace(/-/,"_");if(!_c9[_ca]){_ca=_ca.replace(/_.*$/,"");}if(!_c9[_ca]){logger.error("reporting.lib.ChartBuilder : unable to obtain number settings, defaulting to en-us");return {group:",",decimal:"."};}else{return _c9[_ca];}};if(_bd.title!=null){}var _cb=function(str){return str.replace(/[\'\"\<\>\&]/g," ");};var _cc=function(str){return str.replace(/"/g,"%26quot;").replace(/'/g,"%26apos;");};_bd.title="";_bd.xaxis=_cb(_b8.xcaption);_bd.yaxis=_cb(_b8.ycaption);var _cd="<graph caption='"+_bd.title+"' xAxisName='"+_bd.xaxis+"' yAxisName='"+_bd.yaxis+"' showValues='0' rotateNames='0' slantLabels='0' showShadow='1' showToolTip='1' formatNumberScale='0'";var _ce=isNaN(_be)?0:parseInt(_be);var _cf=isNaN(_bf)?1:(_bf>_ce?parseInt(_bf):(_ce+1));_cd+=" yAxisMinValue='"+parseInt(_ce)+"'";_cd+=" yAxisMaxValue='"+parseInt(_cf)+"'";if(_cf==1&&_ce==0&&_c0==0){_c0=2;}if(_c0!=null){_cd+=" decimalPrecision='"+_c0+"'";}var _d0=_c8();_cd+=" thousandSeparator='"+_d0.group+"'";_cd+=" decimalSeparator='"+_d0.decimal+"'";_cd+=">";_cd+="<categories>";for(var i=0;i<_bc.length;i++){_cd+="<category name='"+_cc(_c1.getRenderValue(0,_bc[i]))+"' />";}_cd+="</categories>";for(var i=0;i<_bb.length;i++){_cd+="<dataset seriesName='"+_cc(_bb[i])+"' color='"+_c6("multi")+"'>";for(var j=0;j<_ba[i].length;j++){_cd+="<set value='"+_ba[i][j]+"' />";}_cd+="</dataset>";}_cd+="</graph>";return _cd;};});},"reporting/FusionChartsFree/FusionChartsFree":function(){define(["dojo","dijit","dojox"],function(_d1,_d2,_d3){if(!reporting){reporting={};}if(!reporting.FusionChartsFree){reporting.FusionChartsFree={};}_d1.provide("reporting.FusionChartsFree.FusionChartsFree");if(typeof window.infosoftglobal=="undefined"){window.infosoftglobal=new Object();}if(typeof window.infosoftglobal.FusionChartsFreeUtil=="undefined"){window.infosoftglobal.FusionChartsFreeUtil=new Object();}window.infosoftglobal.FusionChartsFree=function(swf,id,w,h,_d4,_d5,c,_d6,_d7,_d8,_d9){if(!document.getElementById){return;}this.initialDataSet=false;this.params=new Object();this.variables=new Object();this.attributes=new Array();if(swf){this.setAttribute("swf",swf);}if(id){this.setAttribute("id",id);}if(w){this.setAttribute("width",w);}if(h){this.setAttribute("height",h);}if(c){this.addParam("bgcolor",c);}this.addParam("quality","high");this.addParam("allowScriptAccess","always");this.addVariable("chartWidth",w);this.addVariable("chartHeight",h);_d4=_d4?_d4:0;this.addVariable("debugMode",_d4);this.addVariable("DOMId",id);_d5=_d5?_d5:0;this.addVariable("registerWithJS",_d5);_d6=_d6?_d6:"noScale";this.addVariable("scaleMode",_d6);_d7=_d7?_d7:"EN";this.addVariable("lang",_d7);this.detectFlashVersion=_d8?_d8:1;this.autoInstallRedirect=_d9?_d9:1;this.installedVer=window.infosoftglobal.FusionChartsFreeUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){window.infosoftglobal.FusionChartsFree.doPrepUnload=true;}};window.infosoftglobal.FusionChartsFree.prototype={setAttribute:function(_da,_db){this.attributes[_da]=_db;},getAttribute:function(_dc){return this.attributes[_dc];},addParam:function(_dd,_de){this.params[_dd]=_de;},getParams:function(){return this.params;},addVariable:function(_df,_e0){this.variables[_df]=_e0;},getVariable:function(_e1){return this.variables[_e1];},getVariables:function(){return this.variables;},getVariablePairs:function(){var _e2=new Array();var key;var _e3=this.getVariables();for(key in _e3){_e2.push(key+"="+_e3[key]);}return _e2;},getSWFHTML:function(){var _e4="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){_e4="<embed type=\"application/x-shockwave-flash\" src=\""+this.getAttribute("swf")+"\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\"  ";_e4+=" id=\""+this.getAttribute("id")+"\" name=\""+this.getAttribute("id")+"\" ";_e4+="wmode=\"transparent\" ";var _e5=this.getParams();for(var key in _e5){_e4+=[key]+"=\""+_e5[key]+"\" ";}var _e6=this.getVariablePairs().join("&");if(_e6.length>0){_e4+="flashvars=\""+_e6+"\"";}_e4+="/>";}else{_e4="<object id=\""+this.getAttribute("id")+"\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\">";_e4+="<param name=\"movie\" value=\""+this.getAttribute("swf")+"\" />";_e4+="<param name=\"wmode\" value=\"transparent\" />";var _e5=this.getParams();for(var key in _e5){_e4+="<param name=\""+key+"\" value=\""+_e5[key]+"\" />";}var _e6=this.getVariablePairs().join("&");if(_e6.length>0){_e4+="<param name=\"flashvars\" value=\""+_e6+"\" />";}_e4+="</object>";}return _e4;},setDataURL:function(_e7){if(this.initialDataSet==false){this.addVariable("dataURL",_e7);this.initialDataSet=true;}else{var _e8=window.infosoftglobal.FusionChartsFreeUtil.getChartObject(this.getAttribute("id"));_e8.setDataURL(_e7);}},setDataXML:function(_e9){if(this.initialDataSet==false){this.addVariable("dataXML",_e9);this.initialDataSet=true;}else{var _ea=window.infosoftglobal.FusionChartsFreeUtil.getChartObject(this.getAttribute("id"));_ea.setDataXML(_e9);}},render:function(_eb){if((this.detectFlashVersion==1)&&(this.installedVer.major<6)){if(this.autoInstallRedirect==1){var _ec=window.confirm("You need Adobe Flash Player 6 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.");if(_ec){window.location="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash";}else{return false;}}else{return false;}}else{var n=(typeof _eb=="string")?document.getElementById(_eb):_eb;n.innerHTML=this.getSWFHTML();if(!document.embeds[this.getAttribute("id")]&&!window[this.getAttribute("id")]){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"));}return true;}}};window.infosoftglobal.FusionChartsFreeUtil.getPlayerVersion=function(){var _ed=new window.infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_ed=new window.infosoftglobal.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _ee=3;while(axo){try{_ee++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_ee);_ed=new window.infosoftglobal.PlayerVersion([_ee,0,0]);}catch(e){axo=null;}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_ed=new window.infosoftglobal.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always";}catch(e){if(_ed.major==6){return _ed;}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(e){}}if(axo!=null){_ed=new window.infosoftglobal.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));}}}return _ed;};window.infosoftglobal.PlayerVersion=function(_ef){this.major=_ef[0]!=null?parseInt(_ef[0]):0;this.minor=_ef[1]!=null?parseInt(_ef[1]):0;this.rev=_ef[2]!=null?parseInt(_ef[2]):0;};window.infosoftglobal.FusionChartsFreeUtil.cleanupSWFs=function(){var _f0=document.getElementsByTagName("OBJECT");for(var i=_f0.length-1;i>=0;i--){_f0[i].style.display="none";for(var x in _f0[i]){if(typeof _f0[i][x]=="function"){_f0[i][x]=function(){};}}}};if(window.infosoftglobal.FusionChartsFree.doPrepUnload){if(!window.infosoftglobal.unloadSet){window.infosoftglobal.FusionChartsFreeUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",window.infosoftglobal.FusionChartsFreeUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",window.infosoftglobal.FusionChartsFreeUtil.prepUnload);window.infosoftglobal.unloadSet=true;}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id];};}if(Array.prototype.push==null){Array.prototype.push=function(_f1){this[this.length]=_f1;return this.length;};}window.infosoftglobal.FusionChartsFreeUtil.getChartObject=function(id){var _f2=null;if(navigator.appName.indexOf("Microsoft Internet")==-1){if(document.embeds&&document.embeds[id]){_f2=document.embeds[id];}else{_f2=window.document[id];}}else{_f2=window[id];}if(!_f2){_f2=document.getElementById(id);}return _f2;};window.infosoftglobal.FusionChartsFreeUtil.updateChartXML=function(_f3,_f4){var _f5=window.infosoftglobal.FusionChartsFreeUtil.getChartObject(_f3);_f5.SetVariable("_root.dataURL","");_f5.SetVariable("_root.isNewData","1");_f5.SetVariable("_root.newData",_f4);_f5.TGotoLabel("/","JavaScriptHandler");};window.FusionChartsFree=window.infosoftglobal.FusionChartsFree;});},"reporting/widget/ReportTrigger":function(){define(["dojo","dijit","dojox"],function(_f6,_f7,_f8){_f6.provide("reporting.widget.ReportTrigger");mxui.widget.declare("reporting.widget.ReportTrigger",{superclass:mxui.widget.Button,mixins:[_f7._Contained,mxui.mixin._Contextable],cssClasses:["reportingReportTrigger"],postCreate:function(){this.initContext();this.inherited(arguments);this.loaded();},onClick:function(e){_f6.publish("report_"+this.mxform.hash,["runreport"]);}});});},"reporting/widget/ReportParameter":function(){define(["dojo","dijit","dojox","dojo/require!reporting/lib/OQLSource,reporting/lib/ChartBuilder,reporting/mixin/_Reportable"],function(_f9,_fa,_fb){_f9.provide("reporting.widget.ReportParameter");_f9.require("reporting.lib.OQLSource");_f9.require("reporting.lib.ChartBuilder");_f9.require("reporting.mixin._Reportable");mxui.widget.declare("reporting.widget.ReportParameter",{mixins:[_fa._TemplatedMixin,_fa._Contained,mxui.mixin._Contextable,reporting.mixin._Reportable],inputargs:{reportid:"",nested:false,parameter:"",paramtype:"",query:"",config:""},constructor:function(){this.templatePath=null;this.templateString="<div class='reportingReportParameter'></div>";this.parameter="";this.config="";this.query="";this.paramtype="";this.domNode=null;this.returnValue=null;var _fc=_f9.hitch;var _fd=mxui.dom.hide;var _fe=mxui.dom.show;var _ff=_f9.addClass;var _100=_f9.removeClass;var _101=_f9.addClass;var _102=mxui.dom.setClass;var _103=mxui.dom.getClass;var _104=mxui.dom.setOpacity;var _105=mxui.dom;var _106=null;var _107={};var _108=null;var _109=function(_10a){_10a&&_10a();};var _10b=function(){var _10c=mxui.dom.getSelectedValue(_106);if(_108.isRange&&_108.isRange=="true"){if(_10c==""){return _10c;}else{return (_108.values[parseInt(_10c)]);}}else{return _10c;}};this.postCreate=function(){this.initContext();this.sequence(["actSetup","actContentHook","actRetrieveParameters","actBuildUI","actRegisterUIEvents","actLoaded"]);};this.applyContext=function(_10d,_10e){this.cloneContext(_10d);var _10f=this.paramtype;var has=this.mxcontext.hasParam(this.parameter);try{if(has){var _110=this.mxcontext.getParam(this.parameter);if(_10f=="integer"||_10f=="float"){var val=(_110.length)?_111(_110):_110;mxui.dom.selectOptionByText(_106,val);var _112=_106.selectedIndex;if(_112==0&&_106.getAttribute("isRange")&&(typeof (_110.length=="undefined"))){var opts=_106.options;for(var i=0;i<opts.length;i++){var opt=opts[i];var _113=Number(opt.getAttribute("range-start"));var end=Number(opt.getAttribute("range-end"));if(val>_113&&val<end){_106.selectedIndex=i;break;}}}}else{mxui.dom.selectOption(_106,String(_110));}}}catch(e){}_10e&&_10e();};this.actSetup=function(_114){if(this.parameter==""){logger.error(this.id+".actSetup : no parameter attribute passed.");}else{}_114();};this.actRetrieveParameters=function(_115){var _116=reporting.store.ParameterStore.retrieveLead(this.mxform.hash);if(_116.length==0){_115&&_115();}else{for(var i=0;i<_116.length;i++){_107[_116[i]]={callbacked:false,params:{}};}for(var i=0;i<_116.length;i++){(function(lead){reporting.store.ParameterStore.retrieveParams(lead,function(p){_107[lead]={callbacked:true,params:p};var done=true;for(var x in _107){if(!_107[x].callbacked){done=false;}}if(done){_115&&_115();}});})(_116[i]);}}};var _117=this.declaredClass;var _111=function(arr){if((arr[0]==-Infinity)&&(arr[1]==Infinity)){return mx.ui.translate(_117,"all");}else{if(arr[0]==-Infinity){return mx.ui.translate(_117,"less_than",arr[1].toString());}else{if(arr[1]==Infinity){return mx.ui.translate(_117,"greater_than",arr[0].toString());}else{return mx.ui.translate(_117,"from_to",[arr[0].toString(),arr[1].toString()]);}}}};var _118=function(_119){var vStr=String(_119);return (vStr.match(/true|false/))?mx.ui.translate("mxui.widget.DataGrid",vStr):_119;};var _11a=function(_11b,_11c){var ret=[];if(_11c=="enum"){for(var key in _11b){ret.push([key,_11b[key]]);}}else{if(_11b.length){if(typeof (_11b[0])=="string"){for(var i=0;i<_11b.length;i++){ret.push([_11b[i],_11b[i]]);}}else{ret=_11b;}}else{if(_11b.isRange){if(_11b.isRange=="true"){for(var i=0,val;val=_11b.values[i];i++){ret.push([i,_111(val)]);}}else{ret={};for(var i=0,val;val=_11b.values[i];i++){for(var j=parseInt(val[0]);j<parseInt(val[1]);j++){ret[j.toString()]=j.toString();}}}}else{if(_11b.values){ret=_11b.values;}else{ret=_11b;}}}}if(ret.length!=null){var old=ret;ret={};var _11d=null;for(var i=0,val;val=old[i];i++){ret[val[0]]=_118(val[1]||val[0]);}}return ret;};this.actBuildUI=function(_11e){_106=mxui.dom.select({"class":"form-control"});try{this.domNode.appendChild(_106);}catch(e){}try{for(var i in _107){var _11f=_107[i];var _120=_11f.params[this.parameter];if(_120!=null){_108=_120;_120=_11a(_120,this.paramtype);if(_120!=null){mxui.dom.setSelectOptions(_106,_120,"");if(/true/.test(_108.isRange)){_106.setAttribute("isRange","true");var opts=_106.options;var lol=_108.values;for(var i=0;i<lol.length;i++){var opt=opts[i+1];if(opt){var _121=lol[i];opt.setAttribute("range-start",String(_121[0]));opt.setAttribute("range-end",String(_121[1]));}}}}}else{var _122=[];for(var j in _11f.params){_122.push(j);}}}}catch(e){logger.error(this.id+".actBuildUI : Unable to find parameter in params list : "+e.message);mxui.dom.setSelectOptions(_106,{},"");}_11e&&_11e();};this.updateTrigger=function(){};this.actRegisterUIEvents=function(_123){this.connect(_106,"onchange","eventControlChanged");_123();};this.eventControlChanged=function(e){if(e){e.preventDefault();e.stopPropagation();}this.syncFormControlWithContext();};this.eventOnKeyUp=function(e){if(e.keyCode==13){this.eventControlChanged(e);_f9.publish("report_"+this.mxform.hash,["runreport"]);}else{}};this.syncFormControlWithContext=function(){var _124=this.createContext();_124.setParam(this.parameter,_10b());_f9.publish("context_seed_"+this.mxform.hash,[_124]);};this.refresh=function(_125){this.sequence(["actFillChart",_125||_109]);};this.objectUpdate=function(){};this.contextUpdate=function(){};this.parentUpdate=function(_126){};this.uninitialize=function(_127){};}});});},"reporting/widget/DateRange":function(){define(["dojo","dijit","dojox","dojo/require!reporting/lib/OQLSource,reporting/lib/DateHelpers,reporting/mixin/_Reportable"],function(dojo,_128,_129){dojo.provide("reporting.widget.DateRange");dojo.require("reporting.lib.OQLSource");dojo.require("reporting.lib.DateHelpers");dojo.require("reporting.mixin._Reportable");mxui.widget.declare("reporting.widget.DateRange",{mixins:[_128._TemplatedMixin,_128._Contained,mxui.mixin._Contextable,reporting.mixin._Reportable],inputargs:{reportid:"",nested:false,paramtype:"",parameter:"",query:"",config:""},constructor:function(){this.templatePath=null;this.templateString="<div class='reportingDateRange'><div dojoAttachPoint='containerNode'></div></div>";this.isContainer=true;this.parameter="param";this.paramtype="";this.config="";this.query="";this.domNode=null;this.returnValue=null;var _12a=dojo.hitch;var self=this;var hide=mxui.dom.hide;var show=mxui.dom.show;var _12b=dojo.addClass;var _12c=dojo.removeClass;var _12d=dojo.addClass;var _12e=mxui.dom.setClass;var _12f=mxui.dom.getClass;var _130=mxui.dom.setOpacity;var _131=mxui.dom;var _132={};var _133=[];var _134={};var _135="";var _136=0;var _137=6;var _138=(1000*3600*24);var _139=(_138*7);var _13a=dojo.hitch(mx.parser,"formatDate");var _13b=function(_13c){_13c&&_13c();};var name=null;this.postCreate=function(){this.initContext();name=this.id;this.sequence(["actSetup","actContentHook","actParseContent","actRetrieveParameters","actLoaded"]);};this.applyContext=function(_13d,_13e){this.cloneContext(_13d);this.sequence(["actSetDate"],_13e);};var _13f={0:"Januari",1:"Februari",2:"Maart",3:"April",4:"Mei",5:"Juni",6:"Juli",7:"Augustus",8:"September",9:"Oktober",10:"November",11:"December"};var _140={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};var _141={LAST_WEEK:"Vorige week",THIS_WEEK:"Deze week",NEXT_WEEK:"Volgende week",LAST_MONTH:"Vorige maand",THIS_MONTH:"Deze maand",NEXT_MONTH:"Next month",LAST_QUARTER:"Vorig kwartaal",THIS_QUARTER:"Dit kwartaal",NEXT_QUARTER:"Volgend kwartaal"};var _142={LAST_WEEK:"Last week",THIS_WEEK:"This week",NEXT_WEEK:"Next week",LAST_MONTH:"Last month",THIS_MONTH:"This month",NEXT_MONTH:"Next month",LAST_QUARTER:"Last quarter",THIS_QUARTER:"This quarter",NEXT_QUARTER:"Next quarter"};var _143=function(node){var _144={};for(var i=0;i<53;i++){_144[i]="Week "+(i+1).toString();}mxui.dom.setSelectOptions(node,_144,"");};var _145=function(node){var _146=mx.ui.getLocale();var _147=(_146.match(/nl/i))?_13f:_140;mxui.dom.setSelectOptions(node,_147,"");};var _148=function(node){mxui.dom.setSelectOptions(node,{0:"1",1:"2",2:"3",3:"4"},"");};var _149=function(node){if(node.options.length==0){mxui.dom.setSelectOptions(node,{2006:"2006",2007:"2007",2008:"2008",2009:"2009",2010:"2009",2011:"2011",2012:"2012",2013:"2013",2014:"2014",2015:"2015",2016:"2016",2017:"2017",2018:"2018",2019:"2019",2020:"2020"},"");}};var _14a=function(i){var node=_132[i];if(node){var _14b=node.getAttribute("ref_id");return _128.byId(_14b);}return null;};var _14c=function(node){var _14d=new mxui.widget.FormDatePicker({},node);dojo.connect(_14d,"onChange",dojo.hitch(self,"syncDateRangeWithContext"));node.setAttribute("ref_id",_14d.id);_133.push(_14d);};var _14e=function(node){mxui.dom.setSelectOptions(node,{},"");};var _14f=function(node){mxui.dom.hide(node);};var _150=function(){var from=_14a("from");var to=_14a("to");return (from&&(from.get("value")!="")&&to&&(to.get("value")!=""));};var _151=function(){return (mxui.dom.getSelectedValue(_132.year)!="");};var _152=function(){return parseInt(mxui.dom.getSelectedValue(_132.year));};var _153=function(){return parseInt(mxui.dom.getSelectedValue(_132.quarter))+1;};var _154=function(){return parseInt(mxui.dom.getSelectedValue(_132.month));};var _155=function(){return parseInt(mxui.dom.getSelectedValue(_132.week));};var _156=function(){return mxui.dom.getSelectedValue(_132.range);};var _157=function(){return mxui.dom.getSelectedValue(_132.period);};var _158=function(){var _159=["month","quarter","week","period","year"];for(var i=0;i<_159.length;i++){if(_132[_159[i]]){if(mxui.dom.getSelectedValue(_132[_159[i]])!=""){return _159[i];}}}return false;};var _15a=function(){switch(_158()){case "year":case "period":return true;break;case "range":return false;break;default:return _151();break;}};var _15b=function(_15c){var _15d=_158();if(_15d!="year"){if(_15d=="week"&&_15c){return _15e(_15f(),_155()).getFullYear();}else{if(_15d=="period"){return _160(_157())[0].getFullYear();}else{if(_132.year&&(_152()!="")){return _152();}else{return (new Date()).getUTCFullYear();}}}}else{if(_15d=="year"){return _152();}}};var _161=function(){return _15b();};var _162=function(){switch(_158()){case "week":return _15e(_15f(),_155()+1).getFullYear();break;case "period":return _160(_157())[1].getFullYear();break;default:return _15b();}};var _163=function(){var hash={};for(var i in _132){hash[i]=_132[i].value;}return hash;};var _164=function(hash){for(var i in hash){if(_132[i]){mxui.dom.selectOption(_132[i],hash[i]);}}};var _165=function(n){return new Date(_15b(),n,0);};var _166=function(){return _165(0);};var _167=function(d){var date=new Date(d);var _168=date.getMonth();if(_168>=2){date.setMonth(3);}else{if(_168>=5){date.setMonth(6);}else{if(_168>=8){date.setMonth(9);}else{date.setMonth(12);}}}date.setDate(1);return date;};var _169=function(d){var date=new Date(d);var _16a=date.getMonth();if(_16a>=2){date.setMonth(0);}else{if(_16a>=5){date.setMonth(3);}else{if(_16a>=8){date.setMonth(6);}else{date.setMonth(9);}}}date.setDate(1);return date;};var _16b=function(d){var date=new Date(d);date.setMonth(date.getMonth()+1);date.setDate(0);return date;};var _16c=function(d){var date=new Date(d);date.setDate(1);return date;};var _16d=function(d){var date=new Date(d);while(date.getDay()!=_136){date.setDate(date.getDate()-1);}return date;};var _16e=function(d){var date=new Date(d);while(date.getDay()!=_137){date.setDate(date.getDate()+1);}return date;};var _15f=function(){return new Date(reporting.lib.DateHelpers.getFirstWeekOfYear(_15b()));};var _15e=function(date,n){return (new Date(date.valueOf()+(n*_139)));};var _16f=function(d,n){var date=new Date(d);date.setMonth(date.getMonth()+n);return date;};var _170=function(d,_171,_172){var date=new Date(d);switch(_171){case "last":switch(_172){case "week":return _15e(date,-1);break;case "month":return _16f(date,-1);break;default:break;}break;case "next":switch(_172){case "week":return _15e(date,1);break;case "month":return _16f(date,1);break;default:break;}break;default:break;}return date;};var _160=function(_173){_173=_173.toLowerCase().split(/_/);var _174=_173[0];var _175=_173[1];var date=_170(new Date(),_174,_175);switch(_175){case "week":return [_16d(date),_16e(date)];break;case "month":return [_16c(date),_16b(date)];break;case "quarter":return [_169(date),_167(date)];break;case "period":var _176=_174.split("-");return [new Date(Number(_176[0])),new Date(Number(_176[1]))];break;default:break;}};var _177=function(){switch(_158()){case "month":return _154()+1;break;case "week":return (_15e(_15f(),(_155())).getMonth()+1);break;case "quarter":switch(_153()){case 1:return 1;break;case 2:return 4;break;case 3:return 7;break;case 4:return 10;break;}break;case "period":return _160(_157())[0].getMonth()+1;break;default:return 1;break;}};var _178=function(){switch(_158()){case "month":return _154()+1;break;case "week":return (_15e(_15f(),_155()).getMonth()+1);break;case "quarter":switch(_153()){case 1:return 3;break;case 2:return 6;break;case 3:return 9;break;case 4:return 12;break;}break;case "period":return _160(_157())[1].getMonth()+1;break;default:return 12;break;}};var _179=function(){switch(_158()){case "month":return 1;break;case "week":return _15e(_15f(),(_155())).getDate();break;case "quarter":return 1;break;case "period":return _160(_157())[0].getDate();break;default:return 1;break;}};var _17a=function(){switch(_158()){case "month":var date=_165(_154()+2);date.setDate(0);return date.getDate();break;case "week":return _15e(_15f(),_155()+1).getDate()-1;break;case "quarter":switch(_153()){case 1:case 4:return 31;break;case 2:case 3:return 30;break;}break;case "period":return _160(_157())[1].getDate();break;default:return 31;break;}};var _17b=function(type){if(_132[type]){mxui.dom.selectOption(_132[type],"");}};var _17c=function(_17d){mendix.lang.map(_17d.split(/,/),_17b);};var _17e={yearChanged:function(){_17c("period,range");},quarterChanged:function(){_17c("week,month,period,range");},monthChanged:function(){_17c("week,quarter,period,range");},weekChanged:function(){_17c("month,quarter,period,range");},toChanged:function(){_17c("month,quarter,period,range");},fromChanged:function(){_17c("month,quarter,period,range");},rangeChanged:function(){_17c("year,month,quarter,week,period");},periodChanged:function(){_17c("month,quarter,range");}};var _17f=function(){var from=_14a("from");if(from){var _180=new Date(_15b(),_177()-1,_179());from.set("value",+_180);}var to=_14a("to");if(to){var _180=new Date(_162(),_178()-1,_17a());_180.setDate(_180.getDate()+1);to.set("value",+_180);}};var _181=function(){var from=_14a("from");if(from){from.set("value","");}var to=_14a("to");if(to){to.set("value","");}};var _182=function(){if(_150()){var from=_14a("from");var to=_14a("to");return [from.get("value"),to.get("value")];}else{return "";}};this.actSetup=function(_183){if(this.parameter==""){logger.error(this.id+".actSetup : no valid parameter passed.");}_135=this.parameter.toString()+"_config_hash";this.domNode.parentNode.style.padding="0px";this.containerNode.appendChild(mx.ui.getTemplate(this.mxid,"content"));_183();};this.actParseContent=function(_184){var _185={};mxui.dom.walkTree(this.containerNode,function(node){if(node.nodeName.toLowerCase()=="select"||node.nodeName.toLowerCase()=="input"){_185[node.getAttribute("name")]=node;}});!_185.from&&(_185.from=mxui.dom.input());!_185.to&&(_185.to=mxui.dom.input());for(var i in _185){if((i!="from")&&(i!="to")){this.connect(_185[i],"onchange","eventControlChanged");}else{}switch(i){case "quarter":_148(_185[i]);break;case "week":_143(_185[i]);break;case "month":_145(_185[i]);break;case "year":_149(_185[i]);break;case "period":_14e(_185[i]);break;case "range":_14f(_185[i]);break;case "from":case "to":_14c(_185[i]);break;default:break;}}_132=_185;_184();};this.actRetrieveParameters=function(_186){var _187=reporting.store.ParameterStore.retrieveLead(this.mxform.hash);if(_187.length==0){_186&&_186();}else{for(var i=0;i<_187.length;i++){_134[_187[i]]={callbacked:false,params:{}};}for(var i=0;i<_187.length;i++){(function(lead){reporting.store.ParameterStore.retrieveParams(lead,function(p){_134[lead]={callbacked:true,params:p};var done=true;for(var x in _134){if(!_134[x].callbacked){done=false;}}if(done){_186&&_186();}});})(_187[i]);}}};this.actSetDate=function(_188){if(this.mxcontext.hasParam(this.parameter)){var vals=this.mxcontext.getParam(this.parameter);var _189;var _18a;if(vals.length){_18a=vals[0];_189=vals[1];}else{_18a=_189=vals;}if(_18a){var _18b=_14a("from");if(_18b){_18b.set("value",_18a);}}if(_189){var _18b=_14a("to");if(_18b){_18b.set("value",_189);}}if(this.mxcontext.hasParam(_135)){_164(this.mxcontext.getParam(_135));}}_188&&_188();};var _18c=function(){var _18d=reporting.lib.DateHelpers;switch(_158()){case "year":var year=_15b();var _18e=_18d.getFirstWeekOfYear(year);var end=_18e;var _18f={};var _190=year;var _191=1;var test=_18d.getFirstWeekOfYear(year+1);while(year==_190&&test>end){var _192=_18e;end=_18e+=(4*_18d.weekMs);if(_191==14){end=test;}end-=_18d.dayMs;_18f[_192+"-"+end+"_period"]=(_191++);year=new Date(_18e).getUTCFullYear();}var node=_132.period;if(node){mxui.dom.setSelectOptions(node,_18f,"");}break;default:}};this.eventControlChanged=function(e){if(e){e.preventDefault();e.stopPropagation();}_17e[e.target.getAttribute("name")+"Changed"]();if(_15a()){_17f();}else{_181();}_18c();this.syncDateRangeWithContext();};this.eventInputChanged=function(e){this.syncDateRangeWithContext();};this.eventOnKeyUp=function(e){if(e.keyCode==13){this.eventControlChanged(e);dojo.publish("report_"+this.content_id.toString(),["runreport"]);}else{}};this.syncDateRangeWithContext=function(){var _193=this.createContext();if(!_150()){_193.setParam(this.parameter,"");_193.setParam(_135,"");}else{_193.setParam(this.parameter,_182());_193.setParam(_135,_163());}dojo.publish("context_seed_"+this.mxform.hash,[_193]);};this.refresh=function(_194){};this.objectUpdate=function(){};this.contextUpdate=function(){};this.parentUpdate=function(_195){};this.uninitialize=function(_196){delete _132;};}});});},"reporting/lib/DateHelpers":function(){define(["dojo","dijit","dojox"],function(dojo,_197,_198){dojo.provide("reporting.lib.DateHelpers");(function(){var _199=1000*60,_19a=_199*60,_19b=_19a*24,_19c=_19b*7,_19d=4;reporting.lib.DateHelpers={weekMs:_19c,dayMs:_19b,getFirstDayInWeek:function(){var _19e=mx.ui.getLocale();return (_19e.match(/nl/i))?1:0;},getFirstWeekOfMonth:function(_19f,year){var date=new Date(year,_19f,1);var day=date.getDay();var _1a0=date.getTime();if(day==0){return date.getTime();}var _1a1=_1a0-(day*_19b);_1a1+=(this.getFirstDayInWeek()*_19b);_1a0=_1a1;date=new Date(_1a0);if(date.getMonth()!=_19f){var _1a2=dojo.date.getDaysInMonth(date)-(7-_19d);if(date.getDate()<=_1a2){return _1a0+_19c;}}else{var _1a3=1+_19d;if(date.getDate()>=_1a3){return _1a0-_19c;}}return _1a0;},getFirstWeekOfYear:function(year){return this.getFirstWeekOfMonth(0,year);}};})();});},"reporting/_base":function(){define("reporting/_base",["dojo","dijit","dojox","dojo/require!reporting/widget/_base"],function(dojo,_1a4,_1a5){dojo.provide("reporting._base");dojo.require("reporting.widget._base");});}}});define("reporting/reporting",["dojo","dijit","dojox","dojo/require!reporting/widget/_base"],function(dojo,_1a6,_1a7){dojo.provide("reporting.reporting");dojo.require("reporting.widget._base");});