
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/Dialog",["mxui/widget/_Popup","mxui/wm/focus","mxui/dom","mendix/logger","dojo/dom-geometry","dojo/dom-style","dojo/touch","dojo/sniff","dojo/_base/fx","dojo/_base/event","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_b(_1,{declaredClass:"mxui.widget.Dialog",modal:false,caption:"",content:"",buttons:null,closable:true,autoFocus:true,resizable:true,_handler:null,_headerNode:null,_bodyNode:null,_footerNode:null,_captionNode:null,_closeButton:null,_prevFocus:null,_showAnim:null,_hideAnim:null,_layerId:1,buildRendering:function(){this.buildDialog();this.setCaption(this.caption);this.setContent(this.content);this.setButtons(this.buttons);this.inherited(arguments);},buildDialog:function(){var $=_3.create;this.domNode=$("div",{"class":"modal-dialog mx-dialog"},this._contentNode=$("div",{"class":"modal-content mx-dialog-content"},this._headerNode=$("div",{"class":"modal-header mx-dialog-header"},this._captionNode=$("h4",{"class":"caption mx-dialog-caption"})),this._bodyNode=$("div",{"class":"modal-body mx-dialog-body"}),this._footerNode=$("div",{"class":"modal-footer mx-dialog-footer",style:"display: none"})));_6.set(this.domNode,"opacity",0);if(this.closable){var _d=this._closeButton=$("button",{type:"button","class":"close mx-dialog-close"});_d.innerHTML="&times;";this.connect(_d,_7.press,function(e){this.hide();if(_8("ie")==8){_a.stop(e);}});this._headerNode.insertBefore(_d,this._captionNode);}_2.addBox(this._footerNode);},show:function(){if(this._visible){return;}this.onShow();var _e=this.domNode,_f=this.delay;if(_f){if(this._hideAnim&&this._hideAnim.status()==="playing"){this._hideAnim.stop();}document.body.appendChild(_e);this._showAnim=_9.fadeIn({node:_e,duration:_f});this._showAnim.play();}else{_6.set(_e,"opacity",1);document.body.appendChild(_e);}this._prevFocus=_2.get();if(this._prevFocus){try{this._prevFocus.blur();}catch(e){}}if(this.autoFocus){_2.first(this._footerNode);}this._handler=this.connect(window,"orientationchange","center");this.focus();this.resize();this.center();},hide:function(_10){if(!this._visible){return;}this.onHide();var _11=this.domNode,_12=this.delay;this.disconnect(this._handler);var _13=this._prevFocus;if(_13){var _14=_2.get(),_15=true;if(_14){_15=false;var _16=_14;while(_16=_16.parentNode){if(_16===_11){_15=true;break;}}}if(_15){_2.put(_13);}}var _17=this,end=function(){_3.orphan(_11);_6.set(_11,"opacity",0);_17.onAfterHide();_10&&_10();};if(_12){if(this._showAnim&&this._showAnim.status()==="playing"){this._showAnim.stop();}this._hideAnim=_9.fadeOut({node:_11,duration:_12,onEnd:end,onStop:end});this._hideAnim.play();}else{end();}},onAfterHide:function(){},layout:function(){var _18=_5.getContentBox(this.domNode).h,_19=_5.getMarginBox(this._headerNode).h,_1a=_5.getMarginBox(this._footerNode).h,_1b=_3.getNodeExtents(this._contentNode).h;_5.setContentSize(this._bodyNode,{h:_18-_1b-_19-_1a});},setCaption:function(_1c){var _1d=_3.escapeString(_1c);this._captionNode.innerHTML=_1d||"&nbsp;";},setContent:function(_1e){_3.empty(this._bodyNode);if(_1e){this._bodyNode.appendChild(_3.create("#",_1e));}},setButtons:function(_1f){_3.empty(this._footerNode);if(_1f){for(var i=0,_20;_20=_1f[i];i++){this._footerNode.appendChild(_20);}this._footerNode.style.display="";}},uninitialize:function(){this.hide();}});return _c;});