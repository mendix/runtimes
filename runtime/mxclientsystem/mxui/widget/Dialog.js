
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/Dialog",["dojo","dijit","dojox","dojo/require!mxui/widget/_Popup"],function(_1,_2,_3){_1.provide("mxui.widget.Dialog");_1.require("mxui.widget._Popup");_1.declare("mxui.widget.Dialog",mxui.widget._Popup,{modal:false,caption:"",content:"",buttons:null,closable:true,autoFocus:true,resizable:true,_handler:null,_headerNode:null,_bodyNode:null,_footerNode:null,_captionNode:null,_closeButton:null,_prevFocus:null,_showAnim:null,_hideAnim:null,_layerId:1,buildRendering:function(){this.buildDialog();this.setCaption(this.caption);this.setContent(this.content);this.setButtons(this.buttons);},buildDialog:function(){var $=mxui.dom.create;this.domNode=$("div",{"class":"modal-dialog mx-dialog"},this._contentNode=$("div",{"class":"modal-content mx-dialog-content"},this._headerNode=$("div",{"class":"modal-header mx-dialog-header"},this._captionNode=$("h4",{"class":"caption mx-dialog-caption"})),this._bodyNode=$("div",{"class":"modal-body mx-dialog-body"}),this._footerNode=$("div",{"class":"modal-footer mx-dialog-footer",style:"display: none"})));_1.style(this.domNode,"opacity",0);if(this.closable){var _4=this._closeButton=$("button",{type:"button","class":"close mx-dialog-close"});_4.innerHTML="&times;";this.connect(_4,_1.touch.press,function(){this.hide();});this._headerNode.insertBefore(_4,this._captionNode);}mxui.wm.focus.addBox(this._footerNode);},show:function(){if(this._visible){return;}this.onShow();var _5=this.domNode,_6=this.delay;if(_6){if(this._hideAnim&&this._hideAnim.status()==="playing"){this._hideAnim.stop();}_1.body().appendChild(_5);this._showAnim=_1.fadeIn({node:_5,duration:_6});this._showAnim.play();}else{_1.style(_5,"opacity",1);_1.body().appendChild(_5);}this._prevFocus=mxui.wm.focus.get();if(this._prevFocus){this._prevFocus.blur();}if(this.autoFocus){mxui.wm.focus.first(this._footerNode);}this._handler=this.connect(window,"orientationchange","center");this.focus();this.resize();this.center();},hide:function(_7){if(!this._visible){return;}this.onHide();var _8=this.domNode,_9=this.delay;this.disconnect(this._handler);var _a=this._prevFocus;if(_a){var _b=mxui.wm.focus.get(),_c=true;if(_b){_c=false;var _d=_b;while(_d=_d.parentNode){if(_d===_8){_c=true;break;}}}if(_c){mxui.wm.focus.put(_a);}}var _e=this,_f=function(){mxui.dom.orphan(_8);_1.style(_8,"opacity",0);_e.onAfterHide();_7&&_7();};if(_9){if(this._showAnim&&this._showAnim.status()==="playing"){this._showAnim.stop();}this._hideAnim=_1.fadeOut({node:_8,duration:_9,onEnd:_f,onStop:_f});this._hideAnim.play();}else{_f();}},onAfterHide:function(){},layout:function(){var _10=_1.contentBox(this.domNode).h,_11=_1.marginBox(this._headerNode).h,_12=_1.marginBox(this._footerNode).h;_1.contentBox(this._bodyNode,{h:_10-_11-_12});},setCaption:function(_13){var _14=mxui.dom.escapeString(_13);this._captionNode.innerHTML=_14||"&nbsp;";},setContent:function(_15){mxui.dom.empty(this._bodyNode);if(_15){this._bodyNode.appendChild(mxui.dom.create("#",_15));}},setButtons:function(_16){mxui.dom.empty(this._footerNode);if(_16){for(var i=0,_17;_17=_16[i];i++){this._footerNode.appendChild(_17);}this._footerNode.style.display="";}},uninitialize:function(){this.hide();}});});