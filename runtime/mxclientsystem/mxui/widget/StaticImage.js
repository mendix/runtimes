/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/StaticImage",["mxui/widget/_WidgetBase","mxui/widget/ImageZoom","mxui/dom","mendix/logger","dojo/on","dojo/_base/event","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7){var $=_3.create;var _8=_7(_1,{declaredClass:"mxui.widget.StaticImage",url:"",width:0,height:0,action:null,_overlay:null,buildRendering:function(){var _9=this.width,_a=this.height,_b=this.domNode=$("img",{"class":"mx-image"}),_c=_b.style;if(_9&&_a){this.connect(_b,"load",function(){var _d=_b.width/_b.height,_e=_9/_a;if(_d<_e){_c.width="";_c.height=_a+"px";}else{_c.width=_9+"px";_c.height="";}});}else{if(_9){_c.width=this.width+"px";}else{if(_a){_c.height=this.height+"px";}}}if(this.action){this.connect(_b,"click","onClick");_b.style.cursor="pointer";}this.setUrl(this.url);},setUrl:function(_f,_10){this.domNode.removeAttribute("width");this.domNode.removeAttribute("height");if(!_f){this.domNode.style.display="none";this.domNode.src=this._blankGif;_10&&_10();}else{_f=window.mx.appUrl+_f;if(this.domNode.src===_f){_10&&_10();}else{if(_10){var _11=_5(this.domNode,"load",function(){_11.remove();_10();});var _12=_5(this.domNode,"error",function(){_4.error(this.id+": Failed to load image with url "+_f);_12.remove();_10();});}this.domNode.style.display="";this.domNode.src=_f;}}},onClick:function(e){var _13=this.action,_14=this.mxcontext,run,_15;if("microflow" in _13||"form" in _13){_15={caller:this.mxform};run=function(){window.mx.ui.execute(_13,{context:_14,store:_15});};if(_13.microflow&&_13.microflow.validate=="view"){this.mxform.validate(run);}else{run();}}else{if(_13.type=="enlarge"){if(!this._overlay){this._overlay=new _2({src:this.domNode.src});}else{this._overlay.set("src",this.domNode.src);}this._overlay.show();}}_6.stop(e);},uninitialize:function(){this._overlay&&this._overlay.destroy();},_setWidthAttr:function(){},_setHeightAttr:function(){}});return _8;});