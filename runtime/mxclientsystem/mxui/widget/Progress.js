
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/Progress",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.widget.Progress");_1.declare("mxui.widget.Progress",mxui.widget.Dialog,{closable:false,showDelay:0,_timer:0,_count:0,_messages:null,_showing:false,_listNode:null,_minHeight:100,constructor:function(){this._messages={};this.caption=this.translate("progress_title");if(mx.ui.getProfile()=="desktop"){this.showDelay=500;}},buildRendering:function(){this.inherited(arguments);this._listNode=mxui.dom.create("ul",{"class":"mx-progress-list"});this.setContent(this._listNode);_1.addClass(this.domNode,"mx-progress");},add:function(_4,_5){this._removeMarkedMessages();var id=this._count++,_6=mxui.dom.create("li",{"class":"mx-progress-item"},_4);this._messages[id]={msg:_4,modal:_5,node:_6};this._listNode.appendChild(_6);this.show(_5);return id;},remove:function(id){var _7=this._messages[id];if(_7){if(this._hasActiveMessages(id)){this._removeMessage(id);if(_7.modal){mx.ui.hideUnderlay(this.delay);}}else{this._markMessage(id);this.hide(_7.modal);}}else{logger.error(this.id+".remove: Message id not found!");}},_markMessage:function(id){this._messages[id].removed=true;},_removeMarkedMessages:function(){for(var id in this._messages){if(this._messages[id].removed){this._removeMessage(id);}}},_removeMessage:function(id){var _8=this._messages[id];this._listNode.removeChild(_8.node);delete this._messages[id];},_hasActiveMessages:function(_9){for(var id in this._messages){if(id!=_9&&!this._messages[id].removed){return true;}}return false;},show:function(_a){if(!this._showing){this._showing=true;var _b=this,_c=arguments;var _d=function(){_b._timer=null;if(_a){mx.ui.showUnderlay(_b.delay);}_b.inherited(_c);};if(_a||!this.showDelay){_d();}else{this._timer=setTimeout(_d,this.showDelay);}}},hide:function(_e){if(this._showing){this._showing=false;if(this._timer){clearTimeout(this._timer);this._timer=null;this._removeMarkedMessages();}else{if(_e){mx.ui.hideUnderlay(this.delay);}this.inherited(arguments,[_1.hitch(this,"_removeMarkedMessages")]);}}}});});