
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/Progress",["mxui/widget/Dialog","mxui/dom","mendix/logger","dojo/dom-class","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6){var $=_2.create;var _7=_6(_1,{declaredClass:"mxui.widget.Progress",closable:false,showDelay:0,_timer:0,_count:0,_messages:null,_showing:false,_listNode:null,_minHeight:100,constructor:function(){this._messages={};this.caption=this.translate("progress_title");if(window.mx.ui.getProfile()=="desktop"){this.showDelay=500;}},buildRendering:function(){this.inherited(arguments);this._listNode=$("ul",{"class":"mx-progress-list"});this.setContent(this._listNode);_4.add(this.domNode,"mx-progress");},add:function(_8,_9){this._removeMarkedMessages();var id=this._count++,_a=$("li",{"class":"mx-progress-item"},_8);this._messages[id]={msg:_8,modal:_9,node:_a};this._listNode.appendChild(_a);this.show(_9);return id;},remove:function(id){var _b=this._messages[id];if(_b){if(this._hasActiveMessages(id)){this._removeMessage(id);if(_b.modal){window.mx.ui.hideUnderlay(this.delay);}}else{this._markMessage(id);this.hide(_b.modal);}}else{_3.error(this.id+".remove: Message id not found!");}},_markMessage:function(id){this._messages[id].removed=true;},_removeMarkedMessages:function(){for(var id in this._messages){if(this._messages[id].removed){this._removeMessage(id);}}},_removeMessage:function(id){var _c=this._messages[id];this._listNode.removeChild(_c.node);delete this._messages[id];},_hasActiveMessages:function(_d){for(var id in this._messages){if(id!=_d&&!this._messages[id].removed){return true;}}return false;},show:function(_e){if(!this._showing){this._showing=true;var _f=this,_10=arguments;var _11=function(){_f._timer=null;if(_e){window.mx.ui.showUnderlay(_f.delay);}_f.inherited(_10);};if(_e||!this.showDelay){_11();}else{this._timer=setTimeout(_11,this.showDelay);}}},hide:function(_12){if(this._showing){this._showing=false;if(this._timer){clearTimeout(this._timer);this._timer=null;this._removeMarkedMessages();}else{if(_12){window.mx.ui.hideUnderlay(this.delay);}this.inherited(arguments,[_5.hitch(this,"_removeMarkedMessages")]);}}}});return _7;});