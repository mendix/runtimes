/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/TextArea",["mxui/widget/_FormWidget","mxui/dom","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/dom-style","dojo/dom-geometry","dojo/sniff","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var $=_2.create;var _b=_a(_1,{declaredClass:"mxui.widget.TextArea",placeholder:"",counterMsg:"",textTooLongMsg:"",rows:0,maxLength:0,_countNode:null,buildRendering:function(){var _c=this.editNode=$("textarea",{"class":"form-control mx-textarea-input",placeholder:this.placeholder});this.inherited(arguments);if(this.counterMsg){var _d=this._countNode=$("label",{"class":"mx-textarea-counter"});_3.place(_d,_c,"after");this._updateCount();this.connect(_c,"keyup","_updateCount");}_4.add(this.domNode,"mx-textarea");if(this.maxLength>0){_5.set(_c,"maxlength",this.maxLength);}if(this.rows===0){this.connect(_c,"keyup","resize");this.connect(this.mxform,"resize","resize");}else{_4.add(_c,"mx-textarea-input-noresize");_5.set(_c,"rows",this.rows);}},resize:function(){if(this.rows===0&&!this.get("disabled")){this.editNode.style.height="";this.editNode.style.height="calc("+this.editNode.scrollHeight+"px + 2em)";}},validate:function(){var _e=this.inherited(arguments);if(_e!=null){return _e;}else{if(this.get("value")==null){return this.textTooLongMsg||window.mx.ui.translate("mendix.lib.Validations","value_too_long");}}},_updateCount:function(){_2.text(this._countNode,this.counterMsg.replace("{1}",this.editNode.value.length).replace("{2}",this.maxLength));},_getValueAttr:function(){var _f=this.editNode.value;return this.maxLength&&_f.length>this.maxLength?null:_f;},_setValueAttr:function(_10){this.editNode.value=_10;this.readNode.innerHTML=_10?_2.convertNlToBr(_2.escapeString(_10)):"&nbsp;";this.resize();}});return _b;});