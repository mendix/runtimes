
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/TextArea",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.widget.TextArea");_1.declare("mxui.widget.TextArea",mxui.widget._FormWidget,{placeholder:"",counterMsg:"",textTooLongMsg:"",rows:0,maxLength:0,_cloneNode:null,_countNode:null,buildRendering:function(){var $=mxui.dom.create,_4=this.editNode=$("textarea",{"class":"form-control mx-textarea-input",placeholder:this.placeholder});this.readNode=$("label");this.inherited(arguments);if(this.counterMsg){var _5=this._countNode=$("label",{"class":"mx-textarea-counter"});_1.place(_5,_4,"after");this._updateCount();this.connect(_4,"keyup","_updateCount");}_1.addClass(this.domNode,"mx-textarea");if(this.maxLength>0){_1.attr(_4,"maxlength",this.maxLength);}if(this.rows===0){var _6=this._cloneNode=_1.clone(_4);_1.addClass(_6,"mx-textarea-clone");this.connect(_4,"keyup","resize");this.connect(this.mxform,"resize","resize");this.domNode.appendChild(_6);}else{_1.addClass(_4,"mx-textarea-input-noresize");_1.attr(_4,"rows",_1.isFF?Math.max(1,this.rows-1):this.rows);}},resize:function(){if(this._cloneNode){var _7=this.editNode,_8=this._cloneNode,_9=this.get("disabled");this.domNode.appendChild(_8);_8.value=_7.value+(_9?"":"\n\n");_8.scrollTop=10000;var _a=_1._getPadExtents(_7).h,_b=Math.max(_8.scrollTop+_a,28);_1.style(_7,"height",_b+"px");this.domNode.removeChild(_8);}},validate:function(){var _c=this.inherited(arguments);if(_c!=null){return _c;}else{if(this.get("value")==null){return this.textTooLongMsg||mx.ui.translate("mendix.lib.Validations","value_too_long");}}},_updateCount:function(){mxui.dom.text(this._countNode,this.counterMsg.replace("{1}",this.editNode.value.length).replace("{2}",this.maxLength));},_getValueAttr:function(){var _d=this.editNode.value;return this.maxLength&&_d.length>this.maxLength?null:_d;},_setValueAttr:function(_e){this.editNode.value=_e;this.readNode.innerHTML=_e?mxui.dom.convertNlToBr(mxui.dom.escapeString(_e)):"&nbsp;";this.resize();}});});