/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/TextArea",["mxui/widget/_FormWidget","mxui/dom","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/dom-style","dojo/dom-geometry","dojo/sniff","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var $=_2.create;var _b=_a(_1,{declaredClass:"mxui.widget.TextArea",placeholder:"",counterMsg:"",textTooLongMsg:"",rows:0,maxLength:0,_cloneNode:null,_countNode:null,buildRendering:function(){var _c=this.editNode=$("textarea",{"class":"form-control mx-textarea-input",placeholder:this.placeholder});this.inherited(arguments);if(this.counterMsg){var _d=this._countNode=$("label",{"class":"mx-textarea-counter"});_3.place(_d,_c,"after");this._updateCount();this.connect(_c,"keyup","_updateCount");}_4.add(this.domNode,"mx-textarea");if(this.maxLength>0){_5.set(_c,"maxlength",this.maxLength);}if(this.rows===0){var _e=this._cloneNode=_9.clone(_c);_4.add(_e,"mx-textarea-clone");_5.set(_e,"tabindex",-1);this.connect(_c,"keyup","resize");this.connect(this.mxform,"resize","resize");}else{_4.add(_c,"mx-textarea-input-noresize");_5.set(_c,"rows",this.rows);}},resize:function(){if(!this._cloneNode){return;}this._cloneNode.value=this.editNode.value+"\n\n";_3.place(this._cloneNode,this.domNode,"first");this._cloneNode.scrollTop=100000;var _f=Math.max(this._cloneNode.scrollHeight,28);_6.set(this.editNode,"height",_f+"px");_2.orphan(this._cloneNode);},validate:function(){var _10=this.inherited(arguments);if(_10!=null){return _10;}else{if(this.get("value")==null){return this.textTooLongMsg||window.mx.ui.translate("mendix.lib.Validations","value_too_long");}}},_updateCount:function(){_2.text(this._countNode,this.counterMsg.replace("{1}",this.editNode.value.length).replace("{2}",this.maxLength));},_getValueAttr:function(){var _11=this.editNode.value;return this.maxLength&&_11.length>this.maxLength?null:_11;},_setValueAttr:function(_12){this.editNode.value=_12;this.readNode.innerHTML=_12?_2.convertNlToBr(_2.escapeString(_12)):"&nbsp;";this.resize();}});return _b;});