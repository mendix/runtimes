
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/LayoutContainer",["mxui/widget/_WidgetBase","mxui/dom","dojo/aspect","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/window","dojo/_base/declare","dojo/_base/fx","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var _b=_8([_1],{declaredClass:"mxui.widget.LayoutContainer",design:"",regions:null,_isFixed:false,_regionMap:null,_resizeNodes:null,_toggleRegion:"",_toggleState:false,_overlayNode:null,startup:function(){this._regionMap={};this._resizeNodes=[];this._isFixed=_4.contains(this.domNode,"mx-layoutcontainer-fixed");var _c=this.domNode.children,_d;for(var i=0;_d=_c[i];i++){var _e=this.regions[i],_f=_d.children[0];var _10=this._regionMap[_e.position]={node:_d,width:_d.offsetWidth,position:_e.position};if(_e.collapsible){this._toggleRegion=_10;var _11=_d.style.width;_10.cssWidth=parseInt(_11,10);_10.cssUnits=_11.indexOf("%")!=-1?"%":"px";_10.node.setAttribute("focusIndex",-1);}if(_f&&_f.style.height){_f.style.overflow="auto";}if(this.design!=="vertical"||_e.position==="middle"){this._resizeNodes.push(_d.children[0]);}}if(this._toggleRegion){_6.set(this.domNode.parentNode,"overflowX","hidden");this.listen("toggleSidebar",this.toggleSidebar,function(cb){this.toggleSidebar();cb();});_3.after(this.mxform,"onAfterHide",_a.hitch(this,"hideSidebar"));this._overlayNode=_2.create("div",{style:{position:"absolute"}});this.connect(this._overlayNode,"click","hideSidebar");}},resizeSidebar:function(){var _12=this._toggleRegion;if(!_12){return;}_6.set(this.domNode,"width","");_6.set(_12.node,"display","none");var _13=this.domNode.offsetWidth,_14=this._toggleState;if(_12.cssUnits==="%"){_12.width=_12.cssWidth*_13/100;}var _15={position:"relative",width:_13+_12.width+"px"};if(_12.position==="left"&&!_14||_12.position==="right"&&_14){_15[window.mx.ui.isRtl()?"right":"left"]=-_12.width+"px";}_6.set(this.domNode,_15);_6.set(_12.node,{display:"",width:_12.width+"px",});if(_14){this.positionOverlay();}},resize:function(box){if(!this._resizeNodes){return;}this.resizeSidebar();if(box){var _16=box.h;if(this.design==="vertical"){for(var _17 in this._regionMap){var _18=this._regionMap[_17];if(_17==="top"||_17==="bottom"){_16-=_18.node.offsetHeight;}}}var _19=_16>=100;for(var j=0,_1a;_1a=this._resizeNodes[j];j++){var _1b=Math.max(0,_16)+"px";if(this._isFixed){_1a.style.height=_19?_1b:"auto";this.resizeChildren(_1a,!_19);}else{_1a.style.minHeight=_19?_1b:"";this.resizeChildren(_1a,true);}}}else{for(var k=0,_1a;_1a=this._resizeNodes[k];k++){_1a.style.height="auto";this.resizeChildren(_1a,true);}}},toggleSidebar:function(){if(this._toggleState){this.hideSidebar();}else{this.showSidebar();}},showSidebar:function(){var _1c=this._toggleRegion;if(!_1c){return;}this._toggleState=true;var _1d={},_1e={end:_1c.position==="left"?0:-_1c.width,units:"px"};_1d[window.mx.ui.isRtl()?"right":"left"]=_1e;_9.animateProperty({node:this.domNode,duration:300,properties:_1d}).play();document.body.appendChild(this._overlayNode);this.positionOverlay();},hideSidebar:function(){var _1f=this._toggleRegion;if(!_1f){return;}this._toggleState=false;var _20={},_21={end:_1f.position==="left"?-_1f.width:0,units:"px"};_20[window.mx.ui.isRtl()?"right":"left"]=_21;this._animOut=_9.animateProperty({node:this.domNode,duration:300,properties:_20}).play();_2.orphan(this._overlayNode);},positionOverlay:function(){var _22=this._toggleRegion,rtl=window.mx.ui.isRtl();_5.setMarginBox(this._overlayNode,{t:_5.position(_22.node,true).y,l:_22.position==="left"?(rtl?0:_22.width):(rtl?_22.width:0),w:Math.max(0,_7.getBox().w-_22.width),h:_22.node.offsetHeight});}});return _b;});