
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/LayoutContainer",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.widget.LayoutContainer");_1.declare("mxui.widget.LayoutContainer",[mxui.widget._WidgetBase],{design:"",regions:null,_isFixed:false,_regionMap:null,_resizeNodes:null,_toggleRegion:"",_toggleState:false,_overlayNode:null,startup:function(){this._regionMap={};this._resizeNodes=[];this._isFixed=_1.hasClass(this.domNode,"mx-layoutcontainer-fixed");var _4=this.domNode.children,_5;for(var i=0;_5=_4[i];i++){var _6=this.regions[i],_7=_5.children[0];var _8=this._regionMap[_6.position]={node:_5,width:_5.offsetWidth,position:_6.position};if(_6.collapsible){this._toggleRegion=_8;var _9=_5.style.width;_8.cssWidth=parseInt(_9,10);_8.cssUnits=_9.indexOf("%")!=-1?"%":"px";_8.node.setAttribute("focusIndex",-1);}if(_7&&_7.style.height){_7.style.overflow="auto";}if(this.design!=="vertical"||_6.position==="middle"){this._resizeNodes.push(_5.children[0]);}}if(this._toggleRegion){_1.style(this.domNode.parentNode,"overflowX","hidden");this.listen("toggleSidebar",this.toggleSidebar,function(cb){this.toggleSidebar();cb();});_1.connect(this.mxform,"onAfterHide",_1.hitch(this,"hideSidebar"));this._overlayNode=mxui.dom.create("div",{style:{position:"absolute"}});this.connect(this._overlayNode,"click","hideSidebar");}},resizeSidebar:function(){var _a=this._toggleRegion;if(!_a){return;}_1.style(this.domNode,"width","");_1.style(_a.node,"display","none");var _b=this.domNode.offsetWidth,_c=this._toggleState;if(_a.cssUnits==="%"){_a.width=_a.cssWidth*_b/100;}var _d={position:"relative",width:_b+_a.width+"px"};if(_a.position==="left"&&!_c||_a.position==="right"&&_c){_d[mx.ui.isRtl()?"right":"left"]=-_a.width+"px";}_1.style(this.domNode,_d);_1.style(_a.node,{display:"",width:_a.width+"px",});if(_c){this.positionOverlay();}},resize:function(_e){if(!this._resizeNodes){return;}this.resizeSidebar();if(_e){var _f=_e.h;if(this.design==="vertical"){for(var _10 in this._regionMap){var _11=this._regionMap[_10];if(_10==="top"||_10==="bottom"){_f-=_11.node.offsetHeight;}}}var _12=_f>=100;for(var j=0,_13;_13=this._resizeNodes[j];j++){var _14=Math.max(0,_f)+"px";if(this._isFixed){_13.style.height=_12?_14:"auto";this.resizeChildren(_13,!_12);}else{_13.style.minHeight=_12?_14:"none";this.resizeChildren(_13,true);}}}else{for(var k=0,_13;_13=this._resizeNodes[k];k++){_13.style.height="auto";this.resizeChildren(_13,true);}}},toggleSidebar:function(){if(this._toggleState){this.hideSidebar();}else{this.showSidebar();}},showSidebar:function(){var _15=this._toggleRegion;if(!_15){return;}this._toggleState=true;var _16={},_17={end:_15.position==="left"?0:-_15.width,units:"px"};_16[mx.ui.isRtl()?"right":"left"]=_17;_1.animateProperty({node:this.domNode,duration:300,properties:_16}).play();document.body.appendChild(this._overlayNode);this.positionOverlay();},hideSidebar:function(){var _18=this._toggleRegion;if(!_18){return;}this._toggleState=false;var _19={},_1a={end:_18.position==="left"?-_18.width:0,units:"px"};_19[mx.ui.isRtl()?"right":"left"]=_1a;this._animOut=_1.animateProperty({node:this.domNode,duration:300,properties:_19}).play();mxui.dom.orphan(this._overlayNode);},positionOverlay:function(){var _1b=this._toggleRegion,rtl=mx.ui.isRtl();_1.marginBox(this._overlayNode,{t:_1.position(_1b.node,true).y,l:_1b.position==="left"?(rtl?0:_1b.width):(rtl?_1b.width:0),w:Math.max(0,_2.getViewport().w-_1b.width),h:_1b.node.offsetHeight});}});});