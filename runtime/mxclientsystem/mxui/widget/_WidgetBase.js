/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/_WidgetBase",["mxui/dom","mxui/widget","mxui/html/parser","mendix/lang","mendix/lib/MxContext","mendix/logger","dijit/_WidgetBase","dijit/registry","dojo/dom-attr","dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dijit/_base"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){var _d=_c(_7,{declaredClass:"mxui.widget._WidgetBase",mxid:"",uniqueid:"",mxform:null,mxcontext:null,doParse:true,readOnly:false,ignoreUpdates:false,autoLoad:true,_loaded:false,_destroyed:false,_disabled:false,_cachedDisabled:false,_loadCalls:null,_destroyCalls:null,_listeners:null,_subscriptions:null,"-chains-":{constructor:"after",uninitialize:"before"},constructor:function(_e,_f){this._loadCalls=[];this._destroyCalls=[];this._listeners=[];this._subscriptions=[];this.mxcontext=new _5();if(this.autoLoad){this.set("loaded",true);}this._cachedDisabled=this.readOnly;},getTemplate:function(_10){return window.mx.ui.getTemplate(this.mxid,_10);},parseContent:function(_11,_12,_13){var _14={mxform:this.mxform,validator:this.validator,ignoreUpdates:this.ignoreUpdates};if(this.readOnly){_14.readOnly=true;}if(this.doParse){return _3[_13?"parseTopLevel":"parse"](_11||this.domNode,_b.mixin(_14,_12),this.uniqueid);}else{return [];}},getChildren:function(_15){if(_15){return _2.getDescendantWidgets(this.domNode);}else{return _8.findWidgets(this.domNode);}},resizeChildren:function(_16,_17){return _2.resizeWidgetsIn(_16,_17);},applyContext:function(_18,_19){var _1a=this.mxcontext;if(this.contextAction!=="reset"){_1a.mixin(_18);if(this.dropContext){for(var i=0,_1b;_1b=this.dropContext[i];i++){_1a.unsetContext(_1b);}}}else{if(this.preserveTrackObject){if(_18){_1a.setObject(_18.getTrackObject(),_18.getTrackEntity(),_18.getTrackId());}else{_1a.setObject(null);}}}if(typeof this.update=="function"){var _1c=this;window.mx.data.getObjectFromContext(_1a,function(obj){try{_1c.update(obj,_19);}catch(e){throw new Error(_1c.id+".applyContext: "+e);}});}else{var _1d=_8.findWidgets(this.domNode);this.passContext(_1d,_18,_19);}},passContext:function(_1e,_1f,_20){if(typeof _1f=="function"){_20=_1f;_1f=this.mxcontext;}else{_1f=_1f||this.mxcontext;}_2.applyContext(_1e,_1f,_b.hitch(this,_20));},subscribe:function(sub){if(this.ignoreUpdates){return;}var _21=window.mx.data.subscribe(sub,this);this._subscriptions.push(_21);return _21;},unsubscribe:function(_22){if(this.ignoreUpdates){return;}var _23=this._subscriptions;for(var i=0,_24;_24=_23[i];i++){if(_24==_22){window.mx.data.unsubscribe(_22);_23.splice(i,1);break;}}},unsubscribeAll:function(){var _25=this._subscriptions;while(_25.length){window.mx.data.unsubscribe(_25.pop());}},listen:function(_26,_27){var _28=this.mxform.listen(_26,_b.hitch(this,_27));this._listeners.push(_28);return _28;},unlisten:function(_29){var _2a=this._listeners;for(var i=0,_2b;_2b=_2a[i];i++){if(_2b==_29){this.mxform.unlisten(_29);_2a.splice(i,1);break;}}},capture:function(_2c,evt,_2d){var _2e=_1.capture(_2c,evt,_b.hitch(this,_2d));this.addOnDestroy(_2e.remove);},collect:function(_2f,_30){_4.collect(_2f,_30,this);},sequence:function(_31,_32){_4.sequence(_31,_32,this);},translate:function(str,_33,_34){return window.mx.ui.translate(this.declaredClass,str,_33,_34);},domData:function(){this.domData=_1.getScopedData();return this.domData.apply(this,arguments);},checkDisabled:function(){return this.readOnly||this._disabled;},updateDisabled:function(){this.set("disabled",undefined);},_getDisabledAttr:function(){return this._cachedDisabled;},_setDisabledAttr:function(_35){if(_35!=null){this._disabled=!!_35;}_35=this.checkDisabled();if(_35!==this._cachedDisabled){this._cachedDisabled=_35;if(_35){this.disable();}else{this.enable();}}},enable:function(){},disable:function(){},resize:function(box){this.resizeChildren(this.domNode,!box);},_setMxidAttr:function(_36){_9.set(this.domNode,"data-mendix-id",_36);},_setFocusIndexAttr:function(_37){if(_37!=null){_9.set(this.domNode,"focusindex",_37);}},_getLoadedAttr:function(){return this._loaded;},_setLoadedAttr:function(_38){this._loaded=!!_38;if(_38){var _39=this._loadCalls;while(_39.length){_39.shift()();}}},actLoaded:function(_3a){this.set("loaded",true);_3a&&_3a();},addOnLoad:function(_3b){this._loaded?_3b():this._loadCalls.push(_3b);},addOnDestroy:function(_3c){this._destroyed?_3c():this._destroyCalls.push(_3c);},destroy:function(_3d){this._beingDestroyed=true;try{this.uninitialize();}catch(e){throw new Error(this.id+".uninitialize: "+e);}function _3e(w){if(w.destroyRecursive){w.destroyRecursive(_3d);}else{if(w.destroy){w.destroy(_3d);}}};_a.forEach(this._connects,_b.hitch(this,"disconnect"));_a.forEach(this._supportingWidgets,_3e);if(this.domNode){_a.forEach(_8.findWidgets(this.domNode),_3e);}this.destroyRendering(_3d);_8.remove(this.id);this._destroyed=true;},destroyRendering:function(){var _3f=this.domNode,_40=this.srcNodeRef;this.inherited(arguments,[true]);if(_3f){_1.orphan(_3f);}this.domNode=_3f;this.srcNodeRef=_40;},uninitialize:function(){if(this._loaded){var _41=this._listeners,_42=this._destroyCalls;while(_41.length){this.mxform.unlisten(_41.pop());}this.unsubscribeAll();while(_42.length){_42.shift().call(this);}}else{_6.error(this.id+".uninitialize: widget not loaded yet, check widget structure");this.addOnLoad(_b.hitch(this,function(){try{this.uninitialize();}catch(e){throw new Error(this.id+".unitialize: "+e);}}));}}});return _d;});