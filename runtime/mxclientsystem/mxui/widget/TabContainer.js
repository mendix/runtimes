/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/TabContainer",["mxui/widget/_WidgetBase","mxui/mixin/_Stateful","mxui/dom","mendix/logger","dojo/on","dojo/dom-class","dojo/dom-geometry","dojo/_base/array","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var $=_3.create;var _a=_9([_1,_2],{declaredClass:"mxui.widget.TabContainer",validator:null,_active:null,_tabList:null,_tabPanes:null,_tabContent:null,_clickHandler:null,postMixInProperties:function(){this.doParse=true;},buildRendering:function(){var _b=this._tabList=$("ul",{"class":"nav nav-tabs mx-tabcontainer-tabs"}),_c=this._tabContent=$("div",{"class":"tab-content mx-tabcontainer-content"},this.getTemplate("pages"));this.domNode=$("div",{"class":"mx-tabcontainer"},_b,_c);var _d=this;this._clickHandler=_5(_b,_5.selector("li","click"),function(e){_d.showTab(_d.domData(this,"tab"));e.preventDefault();});},startup:function(){var _e=this._tabList,_f=this._tabContent.childNodes,_10=0,_11=this._tabPanes=[];for(var i=0,_12;_12=_f[i];i++){var li=$("li"),tab=this.parseContent(_12,{index:i,button:li,container:this,validator:this})[0];this.domData(li,"tab",tab);if(tab.selected){_10=i;}li.appendChild($("a",{href:"#","class":"mx-name-"+tab.tabName},tab.title));li.appendChild(tab.indicator);_e.appendChild(li);_11.push(tab);}this.showTab(_11[this.getState("selected",_10)]);},showTab:function(tab){var _13=this,_14=this._active;if(_14){_14.hideTab();}this._active=tab;_6.add(this._tabContent,"loading");tab.showTab(function(){if(_13._active===tab){_6.remove(_13._tabContent,"loading");}_13.mxform.resize();});},onShowTab:function(tab){if(!this._active){this.showTab(tab);this.domNode.style.display="";}},onHideTab:function(tab){if(tab===this._active){var _15=tab.index,_16=this._tabPanes,_17=_16.slice(_15+1).concat(_16.slice(0,_15)),_18;for(var i=0,_19;_19=_17[i];i++){if(!_19._hidden){_18=_19;break;}}tab.hideTab();if(_18){this.showTab(_18);}else{this._active=null;this.domNode.style.display="none";}}},resize:function(box){var _1a=true,_1b=this._tabPanes;if(box){var _1c=box.h-_7.getMarginBox(this._tabList,null).h;if(_1c>_3.minContainerHeight){_1a=false;_7.setMarginBox(this._tabContent,{h:_1c});}else{this._tabContent.style.height="auto";}}this._tabContent.style.overflow=_1a?"":"auto";for(var i=0,tab;tab=_1b[i];i++){tab.resize(_1a);}},isValid:function(){return _8.every(this._tabPanes,function(tab){return tab.isValid?tab.isValid():true;});},uninitialize:function(){this._clickHandler.remove();},storeState:function(_1d){_1d("selected",this._active&&this._active.index);}});return _a;});