
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/_Button",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.widget._Button");_1.declare("mxui.widget._Button",[mxui.widget._WidgetBase,mxui.mixin._DynamicOptionHelper],{renderType:"button",caption:"",iconUrl:"",iconClass:"",direction:0,cssClasses:null,cssStyle:"",needsObject:false,_textNode:null,_iconNode:null,_isCls:false,_clickCoords:null,_mouseUpConn:null,_ignoreClick:false,_typeRegex:/(^| )btn-(primary|info|success|warning|danger|inverse)( |$)/,buildRendering:function(){var $=mxui.dom.create,_4=this._textNode=document.createTextNode("");var _5={};if(this.cssStyle){_5={"style":this.cssStyle};}var _6=this.cssClasses||[];if(typeof _6==="string"){_6=[_6];}var _7=_6.join(" ");if(this.renderType==="link"){this.domNode=$("span",_1.mixin(_5,{"class":"mx-link"+" "+_7,})," ",$("a",{tabindex:-1},_4)," ");}else{if(!this._typeRegex.test(_6)){_7="btn-default "+_7;}this.domNode=$("button",_1.mixin(_5,{"type":"button","class":"btn mx-button "+_7,})," ",_4," ");}this.connect(this.domNode,"onclick","_onClick");this.connect(this.domNode,"mousedown","_mouseDown");this.connect(this.domNode,"click",function(e){_1.stopEvent(e);});this.connect(this.domNode,"keypress",function(e){if(e.charOrCode===_1.keys.ENTER){this.onClick(e);}});},update:function(_8,_9){this.unsubscribeAll();this._mxObject=_8;if(_8){var _a=this;this.subscribe({guid:_8.getGuid(),callback:function(){_a.refresh();}});}this.refresh(_9);},refresh:function(_b){this.updateOptions(["caption"],this._mxObject,function(_c){this.set("caption",_c.caption);_b&&_b();});},onClick:function(e){},_mouseDown:function(e){this._downPos={x:e.pageX,y:e.pageY};this._mouseUpConn=this.connect(document,"mouseup","_mouseUp");},_mouseUp:function(e){this.disconnect(this._mouseUpConn);var _d=this._downPos,_e={x:e.pageX,y:e.pageY};var _f=Math.sqrt(Math.pow(_d.x-_e.x,2)+Math.pow(_d.y-_e.y,2));if(_f<10){var evt=mxui.dom.synthesizeEvent(e,{type:"click",target:this.domNode,currentTarget:this.domNode});this.domNode.focus();this.onClick(evt);}this._ignoreClick=true;setTimeout(function(){self._ignoreClick=false;},20);},_onClick:function(e){if(this._ignoreClick){return;}this.domNode.focus();this.onClick(e);},checkDisabled:function(){return this.needsObject?!this.mxcontext.hasTrackId():false;},enable:function(){if(this.renderType=="button"){this.domNode.removeAttribute("disabled");}},disable:function(){if(this.renderType=="button"){this.domNode.setAttribute("disabled","disabled");}},_setCaptionAttr:function(_10){this._textNode.nodeValue=this.caption=_10;},_setIconClassAttr:function(cls){this._setIcon(cls,true);},_setIconUrlAttr:function(img){this._setIcon(img,false);},_setIconVisibleAttr:function(_11){this._iconNode.style.display=_11?"":"none";},_setIcon:function(_12,_13){var $=mxui.dom.create,_14=(this._isCls!=_13),_15=this.domNode,_16=this._iconNode;if(_16&&(_14||!_12)){_15.removeChild(_16.nextSibling);_15.removeChild(_16);}if(_12){if(!_16||_14){if(_13){_16=this._iconNode=$("span",{"class":_12});}else{_16=this._iconNode=$("img",{src:mx.appUrl+_12});}_1.place(_16,_15,"first");}else{if(_13){_1.replaceClass(_16,_12,this.iconClass);}else{_16.src=_12;}}if(_13){this.iconUrl="";this.iconClass=_12;}else{this.iconUrl=_12;this.iconClass="";}this._isCls=_13;}else{this._isCls=false;this._iconNode=null;this.iconUrl=this.iconClass="";}},_setFocusIndexAttr:function(_17){_1.attr(this.domNode,"tabindex",_17);}});});