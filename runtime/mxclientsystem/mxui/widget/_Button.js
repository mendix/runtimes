/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget/_Button",["mxui/widget/_WidgetBase","mxui/mixin/_DynamicOptionHelper","mxui/dom","mendix/logger","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/sniff","dojo/_base/lang","dojo/_base/event","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_b([_1,_2],{declaredClass:"mxui.widget._Button",renderType:"button",caption:"",iconUrl:"",iconClass:"",cssClasses:null,cssStyle:"",needsObject:false,_textNode:null,_iconNode:null,_isCls:false,_clickCoords:null,_mouseUpConn:null,_ignoreClick:false,_typeRegex:/(^| )btn-(primary|info|success|warning|danger|inverse)( |$)/,buildRendering:function(){var $=_3.create,_d=this._textNode=document.createTextNode("");var _e={};if(this.cssStyle){_e={"style":this.cssStyle};}var _f=this.cssClasses||[];if(typeof _f==="string"){_f=[_f];}var _10=_f.join(" ");if(this.renderType==="link"){this.domNode=$("span",_9.mixin(_e,{"class":"mx-link"+" "+_10,})," ",$("a",{tabindex:-1},_d)," ");}else{if(!this._typeRegex.test(_f)){_10="btn-default "+_10;}this.domNode=$("button",_9.mixin(_e,{"type":"button","class":"btn mx-button "+_10,})," ",_d," ");}this.connect(this.domNode,"onclick","_onClick");this.connect(this.domNode,"mousedown","_mouseDown");this.connect(this.domNode,"click",function(e){_a.stop(e);});this.connect(this.domNode,"keyup","onKeyUp");},update:function(obj,_11){this.unsubscribeAll();this._mxObject=obj;if(obj){var _12=this;this.subscribe({guid:obj.getGuid(),callback:function(){_12.refresh();}});}this.updateDisabled();this.refresh(_11);},refresh:function(_13){this.updateOptions(["caption"],this._mxObject,function(_14){this.set("caption",_14.caption);if(_13){_13();}});},onClick:function(e){},onKeyUp:function(e){},_mouseDown:function(e){this._downPos={x:e.pageX,y:e.pageY};this._mouseUpConn=this.connect(document,"mouseup","_mouseUp");},_mouseUp:function(e){this.disconnect(this._mouseUpConn);var _15=this,old=this._downPos,cur={x:e.pageX,y:e.pageY};var _16=Math.sqrt(Math.pow(old.x-cur.x,2)+Math.pow(old.y-cur.y,2));if(_16<10){var evt=_3.synthesizeEvent(e,{type:"click",target:this.domNode,currentTarget:this.domNode});this.domNode.focus();this.onClick(evt);}this._ignoreClick=true;setTimeout(function(){_15._ignoreClick=false;},_8("windowsphone")?300:20);},_onClick:function(e){if(this._ignoreClick){return;}this.domNode.focus();this.onClick(e);},checkDisabled:function(){return this.needsObject?!this.mxcontext.hasTrackId():false;},enable:function(){if(this.renderType=="button"){this.domNode.removeAttribute("disabled");}},disable:function(){if(this.renderType=="button"){this.domNode.setAttribute("disabled","disabled");}},_setCaptionAttr:function(_17){this._textNode.nodeValue=this.caption=_17;},_setIconClassAttr:function(cls){this._setIcon(cls,true);},_setIconUrlAttr:function(img){this._setIcon(img,false);},_setIconVisibleAttr:function(_18){this._iconNode.style.display=_18?"":"none";},_setIcon:function(_19,_1a){var $=_3.create;if(this._iconNode){_3.orphan(this._iconNode);this._iconNode=null;}if(_19){this._iconNode=_1a?$("span",{"class":"glyphicon "+_19}):$("img",{src:window.mx.appUrl+_19});_5.place(this._iconNode,this.domNode,"first");}},_setFocusIndexAttr:function(_1b){_7.set(this.domNode,"tabindex",_1b);}});return _c;});