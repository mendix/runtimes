
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/_Button",["mxui/widget/_WidgetBase","mxui/mixin/_DynamicOptionHelper","mxui/dom","mendix/logger","dojo/dom-construct","dojo/dom-class","dojo/dom-attr","dojo/_base/lang","dojo/_base/event","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var _b=_a([_1,_2],{declaredClass:"mxui.widget._Button",renderType:"button",caption:"",iconUrl:"",iconClass:"",direction:0,cssClasses:null,cssStyle:"",needsObject:false,_textNode:null,_iconNode:null,_isCls:false,_clickCoords:null,_mouseUpConn:null,_ignoreClick:false,_typeRegex:/(^| )btn-(primary|info|success|warning|danger|inverse)( |$)/,buildRendering:function(){var $=_3.create,_c=this._textNode=document.createTextNode("");var _d={};if(this.cssStyle){_d={"style":this.cssStyle};}var _e=this.cssClasses||[];if(typeof _e==="string"){_e=[_e];}var _f=_e.join(" ");if(this.renderType==="link"){this.domNode=$("span",_8.mixin(_d,{"class":"mx-link"+" "+_f,})," ",$("a",{tabindex:-1},_c)," ");}else{if(!this._typeRegex.test(_e)){_f="btn-default "+_f;}this.domNode=$("button",_8.mixin(_d,{"type":"button","class":"btn mx-button "+_f,})," ",_c," ");}this.connect(this.domNode,"onclick","_onClick");this.connect(this.domNode,"mousedown","_mouseDown");this.connect(this.domNode,"click",function(e){_9.stop(e);});this.connect(this.domNode,"keyup","onKeyUp");},update:function(obj,_10){this.unsubscribeAll();this._mxObject=obj;if(obj){var _11=this;this.subscribe({guid:obj.getGuid(),callback:function(){_11.refresh();}});}this.refresh(_10);},refresh:function(_12){this.updateOptions(["caption"],this._mxObject,function(_13){this.set("caption",_13.caption);_12&&_12();});},onClick:function(e){},onKeyUp:function(e){},_mouseDown:function(e){this._downPos={x:e.pageX,y:e.pageY};this._mouseUpConn=this.connect(document,"mouseup","_mouseUp");},_mouseUp:function(e){this.disconnect(this._mouseUpConn);var _14=this,old=this._downPos,cur={x:e.pageX,y:e.pageY};var _15=Math.sqrt(Math.pow(old.x-cur.x,2)+Math.pow(old.y-cur.y,2));if(_15<10){var evt=_3.synthesizeEvent(e,{type:"click",target:this.domNode,currentTarget:this.domNode});this.domNode.focus();this.onClick(evt);}this._ignoreClick=true;setTimeout(function(){_14._ignoreClick=false;},20);},_onClick:function(e){if(this._ignoreClick){return;}this.domNode.focus();this.onClick(e);},checkDisabled:function(){return this.needsObject?!this.mxcontext.hasTrackId():false;},enable:function(){if(this.renderType=="button"){this.domNode.removeAttribute("disabled");}},disable:function(){if(this.renderType=="button"){this.domNode.setAttribute("disabled","disabled");}},_setCaptionAttr:function(_16){this._textNode.nodeValue=this.caption=_16;},_setIconClassAttr:function(cls){this._setIcon(cls,true);},_setIconUrlAttr:function(img){this._setIcon(img,false);},_setIconVisibleAttr:function(_17){this._iconNode.style.display=_17?"":"none";},_setIcon:function(_18,_19){var $=_3.create,_1a=(this._isCls!=_19),_1b=this.domNode,_1c=this._iconNode;if(_1c&&(_1a||!_18)){_1b.removeChild(_1c.nextSibling);_1b.removeChild(_1c);}if(_18){if(!_1c||_1a){if(_19){_1c=this._iconNode=$("span",{"class":_18});}else{_1c=this._iconNode=$("img",{src:window.mx.appUrl+_18});}_5.place(_1c,_1b,"first");}else{if(_19){_6.replace(_1c,_18,this.iconClass);}else{_1c.src=_18;}}if(_19){this.iconUrl="";this.iconClass=_18;}else{this.iconUrl=_18;this.iconClass="";}this._isCls=_19;}else{this._isCls=false;this._iconNode=null;this.iconUrl=this.iconClass="";}},_setFocusIndexAttr:function(_1d){_7.set(this.domNode,"tabindex",_1d);}});return _b;});