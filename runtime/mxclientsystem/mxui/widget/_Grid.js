
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/widget/_Grid",["dojo","dijit","dojox","dojo/require!dojo/fx,mxui/lib/MxGridConfig,mxui/mixin/_OverflowHelper,mxui/mixin/_Contextable,mxui/mixin/_Pluggable,mxui/mixin/_Scriptable,mxui/mixin/_Internationalized"],function(_1,_2,_3){_1.provide("mxui.widget._Grid");_1.require("dojo.fx");_1.require("mxui.lib.MxGridConfig");_1.require("mxui.mixin._OverflowHelper");_1.require("mxui.mixin._Contextable");_1.require("mxui.mixin._Pluggable");_1.require("mxui.mixin._Scriptable");_1.require("mxui.mixin._Internationalized");mxui.widget.declare("mxui.widget._Grid",{mixins:[_2._TemplatedMixin,mxui.mixin._Contextable,mxui.mixin._Scriptable,mxui.mixin._Pluggable,mxui.mixin._OverflowHelper],baseClass:"mx-grid",css:mxui.widget.createCSSMap("mx-grid",{pagingStatus:"paging-status",searchButton:"search-button",resetButton:"reset-button"}),entity:"",schema:"",reference:"",useContext:false,reqConstraints:"",xpathConstraint:"",customDataSource:null,pagingBarNode:null,searchNode:null,toolBarNode:null,messageNode:null,searchButton:null,resetButton:null,_dataSource:null,_gridConfig:null,_gridState:null,_metaEntity:null,_toolWidgets:null,_pagingStatusNode:null,fetchMetaObject:function(){this._metaEntity=mx.meta.getEntity(this.entity);if(this._metaEntity==null){logger.error(this.id+": This grid has been configured for an entity the current user doesn't have access to.");return false;}return true;},_saveSelection:function(){this.mxform.setReturnValue("selection",this._getSelectedGuids());},setupGridConfig:function(){this._gridConfig=new mxui.lib.MxGridConfig({config:this.config,nested:this.nested});},setupGridState:function(){var _4=this._gridConfig,_5=this._gridState;_5.updateperiod=_4.gridSetting("refresh");_5.searchbar=_4.gridSetting("searchbar");_5.controlbar=_4.gridSetting("controlbar");_5.pagingbar=_4.gridSetting("pagingbar");_5.selectionmode=_4.gridSetting("selectionmode");_5.editable=_4.gridSetting("editable");_5.showemptyrows=_4.gridSetting("showemptyrows");_5.selectfirst=_4.gridSetting("selectfirst");_5.selectable=(_5.selectionmode!=="none");if(this.selectable){_5.selectable=/^(single|multi)$/.test(this.selectable);if(this.selectable!=="multi"||_5.selectionmode!=="simplemulti"){_5.selectionmode=this.selectable;}this.mxform.setReturnValue("selection",[]);}},setupDataSource:function(){var _6=this._gridConfig,_7=_6.getDataSource(),_8;if(this.customDataSource){_8=this.customDataSource;_8.setPageSize(_6.gridSetting("pageSize"));_8.setOffset(0);var _9=_6.gridSetting("sortparams");if(_9){_8.setSortOptions(_9[0][0],_9[0][1]);}}else{if(_7){var _a=this instanceof mxui.widget.DataGrid?this.schema:"";if(_7.microflow){_8=new mendix.lib.MicroflowSource({microflow:_7.microflow.name,queryid:_a,context:this.mxcontext,page:_6.gridSetting("pageSize")});}else{if(_7.entityPath){_8=new mendix.lib.EntityPathSource({path:_7.entityPath.path,queryid:_a,context:this.mxcontext,page:_6.gridSetting("pageSize")});}else{_8=new mendix.lib.XPathSource({entity:this.entity,queryid:_a,constraint:this.constraint,useContext:this.useContext,context:this.mxcontext,page:_6.gridSetting("pageSize"),sortparams:_6.gridSetting("sortparams"),aggregates:"Calculations" in this._gridConfig.getPlugins()});}}}}this._dataSource=_8;},resizeGrid:function(){this.contentNode.scrollTop=0;},setUpdateInterval:function(){var _b=this._gridState.updateperiod;if(_b&&_b.toString()!="0"){this.clearInterval();this._gridState.update=setInterval(_1.hitch(this,"reload"),parseInt(_b*1000,10));}},clearInterval:function(){if(this._gridState.update!=null){clearInterval(this._gridState.update);}},setupDevMode:function(_c){if(mx.session.inDevMode()){this.devBlock=new mxui.widget.MxDevBlock({parent:this,xpath:true,guid:false});}},shareSelected:function(){var _d=this.createContext();_d.setTrackEntity(this._metaEntity.getEntity());var _e=this._getCurrentGuid();if(_e){_d.setContext(this._metaEntity.getEntity(),_e);}else{_d.setContext(this._metaEntity.getEntity(),null);}_d.freeze();this.notifyListeners(_d);mx.ui.cleanContext(_d.ident,this);},actionSelectPage:function(_f){if(!this._gridState.invertedSelection){for(var i=0,_10=this._dataSource.getObjects(),_11;_11=_10[i];i++){this._addObjectToSelection(_11);}}this._saveSelection();this.refreshGrid();},actionSelectAllPages:function(_12){this._clearSelection();this._gridState.invertedSelection=true;this.refreshGrid();},actionClearSelection:function(_13){if(this._getSelectedGuids().length>0||this._gridState.invertedSelection){this._clearSelection();this._gridState.invertedSelection=false;this.refreshGrid();}},actionEditSelection:function(_14){var _15=this._getSelectedGuids();if(_15.length===0&&!this._gridState.invertedSelection){mx.ui.info(mx.ui.translate("mxui.widget.DataGrid","no_selection"));}else{for(var i=0,obj;obj=_15[i];i++){var _16=this._dataSource.getObject(obj),_17=_14[_16.getEntity()];if(_17){var _18=this.createContext();_18.dupFrom(this.mxcontext);_18.setObject(null,_16.getEntity(),_16.getGuid());mx.ui.execute(_17,{context:_18});}}}},actionInsertNew:function(_19){var _1a=this._getEntity(_19),_1b=_19[_1a];if(_1b&&_1a){mx.data.create({entity:_1a,context:this.useContext?this.mxcontext:null,persistent:_1b.persistent,callback:function(obj){if(!this.useContext){var _1c=this._gridConfig.getDataSource(),_1d=_1c.entityPath&&_1c.entityPath.path||this.reference,_1e=_1d.split("/"),_1f=this.mxcontext.getTrackId();if(_1e.length==2&&_1f){var _20=_1e[1];if(obj.isReference(_20)){obj.set(_20,_1f);}}}var _21=this.createContext();_21.setContext(obj);mx.ui.execute(_1b,{context:_21});},error:function(e){mx.onError(e);}},this);}},selectRow:function(row){this._gridState.invertedSelection?_1.removeClass(row,"selected"):_1.addClass(row,"selected");},deselectRow:function(row){!this._gridState.invertedSelection?_1.removeClass(row,"selected"):_1.addClass(row,"selected");},postCreate:function(){var req=this.reqConstraints,ref=this.reference;this.reqConstraints=req?req.split(","):[];if(ref){this.reqConstraints.push(ref.substr(0,ref.indexOf("/")));}var box=this.addFocusBox(this.controlNode);box.pressed({RIGHT_ARROW:box.FOCUS_NEXT,LEFT_ARROW:box.FOCUS_PREV});this.offerInterfaces(["close"]);this.initContext();if(this.fetchMetaObject()){this.setupGridConfig();this.setupGridState();this.buildSearchBar();this.buildControlBar();this.buildToolBar();this.buildPagingBar();this.setupDevMode();this.setupDataSource();}},getSchemaId:function(){return this.schema;},postCreateSpecific:function(){},getSelected:function(){return this._getSelectedGuids();},deselectAll:function(){this._clearSelection();this.deselectGridRows();},registerSubscriptions:function(){this.removeSubscriptions();var _22=this.mxcontext.getTrackId();if(_22){this.subscribe({guid:this.mxcontext.getTrackId(),callback:_1.hitch(this,"objectUpdate")});}this.subscribe({entity:this.entity,callback:_1.hitch(this,"objectUpdate")});},eventActionBindingHandler:function(_23,_24){var _25=this._gridConfig.gridActionBindings(),_26=this._gridConfig.getActionsByKey(_25["on"+_24]),_27=_26?this["action"+_26.actionCall]:null,_28=this._getObjectFromNode(_23);if(this._gridState.invertedSelection){return;}if(_26&&_27&&_23&&_28){if(this._gridState.selectable){this.deselectAll();mxui.dom.clearSelection();this.selectRow(_23);}this._addObjectToSelection(_28);_27&&_27.call(this,_26.params);}else{}},eventControlBarButtonClicked:function(e){var _29=e.currentTarget,_2a=_29.getAttribute("data-mendix-id");if(_2a){var _2b=this._gridConfig.getActionsByKey(_2a);if(_2b){if(_2b.actionCall==="ActionSelected"){_2b.actionCall="EditSelection";}else{if(_2b.actionCall==="Create"){_2b.actionCall="InsertNew";}}var _2c="action"+_2b.actionCall;if(this[_2c]){this[_2c](_2b.params);}else{logger.error(this.id+".eventControlBarButtonClicked: Called function '"+_2c+"' does not exist in this component");}}else{logger.error(this.id+".eventControlBarButtonClicked: Action with action key '"+_2a+"' is not defined");}}else{logger.error(this.id+".eventControlBarButtonClicked: No action key defined!");}},actionInvokeMicroflow:function(_2d){this.triggerPluginEvent("invokeMicroflow",null,_1.hitch(this,"invokeMicroflow",_2d));},invokeMicroflow:function(_2e){var _2f=this.entity,_30=_2e[_2f],_31=_30.microflow,_32={applyto:_30.applyTo};if(_30&&_2f){var _33=this._gridState.invertedSelection,_34=this._getSelectedGuids(),_35=this._dataSource,_36=this.schema,_37;switch(_30.applyTo){case "selection":if(_33){_37=[];_35.each(function(obj){var _38=obj.getGuid();if(_1.indexOf(_34,_38)===-1){_37.push(_38);}});}else{_37=_34;}if(_37.length===0){mx.ui.info(mx.ui.translate("mxui.widget.DataGrid","no_selection"));return;}_32.guids=_37;if(_37.length===1){_32.gridid=_36;}break;case "all":_37=_1.clone(_35.getObjects());_1.mixin(_32,{guids:_37,applyto:"selection"});if(_37.length===1){_32.gridid=_36;}break;case "selectionset":var _39,_3a,_3b;if(_33){_3b=_35.getSetSize()-_34.length;_39=_35.getCurrentXPath();}else{_3b=_34.length;_39="//"+_2f;}if(_3b===0){mx.ui.info(mx.ui.translate("mxui.widget.DataGrid","no_selection"));return;}var _3c=[];for(var i=0,id;id=_34[i];++i){var obj=_35.getObject(id);_3c.push("id"+(_33?"!=":"=")+"\""+id+"\"");}if(_3c.length===0){_3a="";}else{_3a="["+_3c.join(_33?" and ":" or ")+"]";}_1.mixin(_32,{xpath:_39,constraints:_3a,sort:_35.getSortSettings()});if(_3b===1){_32.gridid=_36;}break;case "set":if(_35.getSetSize()===0){_32.applyto="none";}else{_1.mixin(_32,{xpath:_35.getCurrentXPath(),sort:_35.getSortSettings()});}break;}var _3d=this,_3e=_31.confirmation,_3f=[];var _40=function(cb){mx.ui.confirmation({cancel:_3e.cancel,proceed:_3e.proceed,content:_3e.question,handler:cb});};if(this.actTriggerOnSync){_3f.push("actTriggerOnSync");}if(this.actDeferSyncAction){_3f.push("actDeferSyncAction");}var run=function(_41){mx.ui.execute({microflow:_31},{params:_32,context:_3d.mxcontext,store:{caller:_3d},callback:_41});};if(_3e){_3f.push(_40);}if(_31&&_31.validate==="view"){_3f.push(_1.hitch(this.mxform,"validate"));}_3f.push(run);_3f.push(function(_42){if(!this._destroyed&&!_30.maintainSelection){this.deselectAll();this.shareSelected();}_42();});this.sequence(_3f);}},actionReturnSelection:function(_43){var _44=this,_45=this.mxform;this._saveSelection();_45.suspend();_45.validate(function(){_45.suspend();var _46=function(e){_45.resume();if(!(e instanceof mendix.lib.ValidationError)){mx.onError(e);}};_45.save(function(){_45.commit(function(){_45.dispose();},_46);},_46);});},controlNode:null,_setToolbarAttr:function(_47){for(var i=0,btn;btn=this._toolWidgets[i++];){btn.set("disabled",_47);}},buildControlBar:function(){if(!this._gridState.controlbar&&!this._gridState.pagingbar){this.controlNode.style.display="none";}},buildToolBar:function(){this._toolWidgets=[];if(!this._gridState.controlbar){this.toolBarNode.style.display="none";return;}var _48=this._gridConfig.gridTools();var box=this.getFocusBox(this.controlNode);var _49=document.createDocumentFragment();for(var i in _48){var _4a=_48[i];var _4b=new mxui.widget.Button({"mxid":_4a.mxid,"caption":_4a.title,"iconUrl":_4a.icon,"onClick":_1.hitch(this,"eventControlBarButtonClicked"),"cssClasses":_4a.cssClass,"cssStyle":_4a.cssStyle});this._toolWidgets.push(_4b);var _4c=_4b.domNode;try{if(_48[i].gridFunction){_4c.setAttribute("gridFunction",_48[i].gridFunction);_4c.setAttribute("param",_48[i].param);if(_48[i].background){_4c.setAttribute("background-job",_48[i].background);}if(_48[i].progress){_4c.setAttribute("progress",_48[i].progress);}if(_48[i].message){_4c.setAttribute("message",_48[i].message);}}if(i>0){_48[i-1]._nextNode=_4c;}_48[i]._domNode=_4c;_49.appendChild(_4c);_49.appendChild(document.createTextNode(" "));box.add(_4c);_4b.startup();}catch(e){}}this.toolBarNode.appendChild(_49);mxui.dom.disableSelection(this.toolBarNode);},buildPagingBar:function(){if(!this._gridState.pagingbar){this.pagingBarNode.style.display="none";return;}var ltr=this.isLeftToRight(),css=this.css,_4d=document.createDocumentFragment(),box=this.getFocusBox(this.controlNode),$=mxui.dom.create;this.btFirst=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-step-backward":"glyphicon-step-forward"),"onClick":_1.hitch(this,"eventPagingFirstClicked")});_4d.appendChild($("#",this.btFirst.domNode," "));box.add(this.btFirst.domNode);this.btPrevious=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-backward":"glyphicon-forward"),"onClick":_1.hitch(this,"eventPagingPreviousClicked")});_4d.appendChild($("#",this.btPrevious.domNode," "));box.add(this.btPrevious.domNode);this._pagingStatusNode=mxui.dom.div({"class":"dijitInline "+this.css.pagingStatus});_4d.appendChild($("#",this._pagingStatusNode," "));this.btNext=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-forward":"glyphicon-backward"),"onClick":_1.hitch(this,"eventPagingNextClicked")});_4d.appendChild($("#",this.btNext.domNode," "));box.add(this.btNext.domNode);this.btLast=new mxui.widget.Button({iconClass:"glyphicon "+(ltr?"glyphicon-step-forward":"glyphicon-step-backward"),"onClick":_1.hitch(this,"eventPagingLastClicked")});_4d.appendChild($("#",this.btLast.domNode," "));box.add(this.btLast.domNode);this.pagingBarNode.appendChild(_4d);mxui.dom.disableSelection(this.pagingBarNode);},updatePagingStatus:function(_4e){if(!this._gridState.pagingbar){return;}var _4f=this._dataSource.getStatusMessage();mxui.html.setContent(this._pagingStatusNode,_4f);if(this._dataSource.atBeginning()){this.btFirst.set("disabled",true);this.btPrevious.set("disabled",true);}else{this.btFirst.set("disabled",false);this.btPrevious.set("disabled",false);}if(this._dataSource.atEnd()){this.btNext.set("disabled",true);this.btLast.set("disabled",true);}else{this.btNext.set("disabled",false);this.btLast.set("disabled",false);}},eventPagingFirstClicked:function(){if(!this._dataSource.atBeginning()){this._dataSource.first(_1.hitch(this,"refreshGrid"));}},eventPagingPreviousClicked:function(){if(!this._dataSource.atBeginning()){this._dataSource.previous(_1.hitch(this,"refreshGrid"));}},eventPagingNextClicked:function(){if(!this._dataSource.atEnd()){this._dataSource.next(_1.hitch(this,"refreshGrid"));}},eventPagingLastClicked:function(){if(!this._dataSource.atEnd()){this._dataSource.last(_1.hitch(this,"refreshGrid"));}},_searchElements:null,_searchFilled:false,searchArgumentNode:null,searchControlNode:null,_searchGetConstraints:function(){var _50="";var _51=[];_1.forEach(this._searchElements,function(_52){var _53=_52.get("value");(_53!=="")&&_51.push(_53);});if(_51.length){_50="["+_51.join(" and ")+"]";}return _50+this._gridState.xpathConstraint;},buildSearchBlock:function(){var css=this.CSS,$=mxui.dom.create;if(this._gridState.isSearchBuild){return;}this._gridState.isSearchBuild=true;var _54=this.searchButton=new mxui.widget.Button({"caption":mx.ui.translate("mxui.widget.DataGrid",["search"]),"onClick":_1.hitch(this,"eventSearchActivated"),"class":this.css.searchButton});this.searchControlNode.appendChild($("#",_54.domNode," "));var _55=this.resetButton=new mxui.widget.Button({"caption":mx.ui.translate("mxui.widget.DataGrid",["reset"]),"onClick":_1.hitch(this,"eventSearchResetClicked"),"class":this.css.resetButton});this.searchControlNode.appendChild($("#",_55.domNode," "));var _56=document.createDocumentFragment();this._searchElements=_1.map(this._gridConfig.searchBarItems(),_1.hitch(this,function(_57){var _58=new mxui.widget.SearchInput(_1.mixin({entity:this.entity,mxcontext:this.mxcontext},_57));this.connect(_58,"onKeyUp","eventSearchActivated");_56.appendChild(_58.domNode);_58.startup();return _58;}));this.searchArgumentNode.appendChild(_56);},buildSearchBar:function(){if(!this._gridState.searchbar){this.searchNode.style.display="none";this._searchFilled=true;return;}var _59=this._gridConfig.searchBarConfig();if(_59){this._gridState.searchBarVisible=!_59.startFolded;this._gridState.searchBarTogglable=!!_59.foldable;}else{this._gridState.searchBarVisible=true;}if(!this._gridState.searchBarVisible){var _5a=false;var _5b=this._gridConfig.searchBarItems();for(var i in _5b){var _5c=_5b[i];if(_5c.defaults){this.buildSearchBlock();_5a=true;break;}}this.searchNode.style.display="none";this._gridState.isSearchBuild=_5a;}else{this.buildSearchBlock();this.searchNode.style.display="";}this.checkSearchFields();},eventSearchActivated:function(e){var _5d=this;_1.stopEvent(e);var _5e=this.searchButton;var _5f=_1.hitch(this,function(){this._clearSelection();this.refreshGrid();if(this.triggerOnSearchChanged){this.triggerOnSearchChanged();}_5e.set("disabled",false);});var _60=false;if(e.type==="click"){this.checkSearchFields();_60=true;}else{if(e.shiftKey&&e.keyCode===13){}else{if(e.keyCode===13){this.checkSearchFields();_60=true;}}}if(!this.constraintsFilled()){_60=false;}if(_60){_5e.set("disabled",true);this._dataSource.isValid(function(_61){if(_61){_5d._dataSource.setConstraints(_5d._searchGetConstraints(),_5f);}else{_5e.set("disabled",false);}});}},eventSearchResetClicked:function(e){var _62=this._dataSource;_1.forEach(this._searchElements,function(_63){_63.reset();});this.checkSearchFields();_62.setConstraints(this._searchGetConstraints());var _64=_1.hitch(this,function(){this.refreshGrid();if(this.triggerOnSearchChanged){this.triggerOnSearchChanged();}});if(this.constraintsFilled()){_62.isValid(function(_65){if(_65){_62.refresh(_64);}else{_62.clean(_64);}});}},checkSearchFields:function(){var _66=this._gridConfig.gridSetting("waitforsearch");if(!_66){this._searchFilled=true;return;}this._searchFilled=_1.some(this._searchElements,_1.hitch(this,function(_67){if(_67.get("value")!==""){this.messageNode.innerHTML="";this.messageNode.style.display="none";return true;}}));if(!this._searchFilled){this.messageNode.innerHTML=mx.ui.translate("mxui.widget.DataGrid","waitForSearch");this.messageNode.style.display="block";}},constraintsFilled:function(){if(!this._searchFilled){return false;}for(var i=0,_68;_68=this.reqConstraints[i];i++){if(!this.mxcontext.getContext(_68)){return false;}}return true;},reload:function(_69){if(this.constraintsFilled()){var _6a=this;this._dataSource.isValid(function(_6b){if(_6b){_6a._dataSource.refresh(function(){_6a.refreshGrid();_69&&_69();});}});}},actionToggleSearch:function(_6c){var _6d=this;if(!this._gridState.searchBarTogglable){return;}this.buildSearchBlock();if(!(this._gridState.searchBarVisible=!this._gridState.searchBarVisible)){this._searchWipeOut=this._searchWipeOut||_1.fx.wipeOut({node:this.searchNode,duration:200,onEnd:function(){setTimeout(function(){_6d.resize(_6d._resizeBox);},0);_1.forEach(_6d._searchElements,function(_6e){_6e.cleanup();});}});this._searchWipeOut.play();}else{this._searchWipeIn=this._searchWipeIn||_1.fx.wipeIn({node:this.searchNode,duration:200,onEnd:function(){setTimeout(function(){_6d.showOverflow();_6d.resize(_6d._resizeBox);},0);try{_1.some(_6d._searchElements,function(_6f){if(!_6f.get("hidden")){_6f.focus();return true;}});}catch(e){}}});this.hideOverflow();this._searchWipeIn.play();}},applyContext:function(_70,_71){var _72=this;if(this._metaEntity==null){_71&&_71();return;}if(!this._dataSource){logger.error(this.id+".applyContext: Applying context before rendered!!!");_71&&_71();return;}this._clearSelection();this.cloneContext(_70);this.setUpdateInterval();this._gridState.xpathConstraint=this.xpathConstraint;var _73=this.mxcontext.getParam("xpathConstraint");if(_73){this._gridState.xpathConstraint+=_73;}this.removeSubscriptions();this.registerSubscriptions();if(this.reference){var _74=this.reference.split(/\//),_75=_74[0],_76=_74[1];var id=this.mxcontext.getContext(_75);if(id){var _77="["+_76+"=\""+id+"\"]";this._gridState.xpathConstraint+=_77;}else{}}if(!this._gridState.inDenial){var _78=[];if(this.constraintsFilled()){var _79=[];var _7a=function(_7b){return function(_7c){_7b.reinit(_7c);};};_1.forEach(this._searchElements,function(_7d){_79.push(_7a(_7d));});_78.push(function(cb){this.collect(_79,cb);});_78.push(function(_7e){if(this._dataSource.setConstraints){this._dataSource.setConstraints(_72._searchGetConstraints());}this._dataSource.reload(_7e);});}else{_78.push("actCleanDS");}this.sequence(_78,function(){this.refreshGrid();this.filterSelected();this.shareSelected();_71();});}else{_71&&_71();}},objectUpdateNotification:function(){var _7f=this;if(!this._gridState.inDenial&&this.constraintsFilled()){this._dataSource.isValid(function(_80){if(_80){_7f.sequence([_1.hitch(_7f._dataSource,"entityUpdate"),function(_81){_7f.refreshGrid();_81&&_81();},"filterSelected"]);}});}},refreshGrid:function(){this.updatePagingStatus();this.fillGrid();this.resizeGrid();},actCleanDS:function(_82){this._clearSelection();this._dataSource.clean(_82);},resumed:function(){this.setUpdateInterval();},suspended:function(){this.clearInterval();},actionDeleteSelection:function(_83){var _84=this._getSelectedGuids();if(this._gridState.invertedSelection){}else{if(!_84.length){mx.ui.info(mx.ui.translate("mxui.widget.DataGrid","no_selection"));}else{var _85=this;var _86=function(){var _87=_84;_85._clearSelection();_85.deselectGridRows();_85.shareSelected();mx.data.remove({guids:_87,callback:function(){mx.data.sendClassUpdate(_85.entity);},error:function(e){mx.onError(e);}});};if(_83===true){_86();}else{mx.ui.confirmation({content:mx.ui.translate("mxui.widget.DataGrid","confirm_delete",_84.length),handler:_86});}}}},resize:function(box){var _88=this.domNode,_89=this.contentNode;_1.style(_89,"height","auto");if(box){var _8a=_1.marginBox(_88),_8b=_1.marginBox(_89),_8c=box.h-(_8a.h-_8b.h);if(_8c>=100){_1.style(_89,"height",_8c+"px");if(this.headTable){_1.style(this.headTable,"top","0px");}}}this._resizeBox=box;},close:function(){this.disposeContent();},onHide:function(e){_1.forEach(this._searchElements,function(_8d){_8d.cleanup();});},uninitialize:function(_8e){var _8f=null;try{this.clearInterval();this.removeSubscriptions();mxui.widget.destroyChildren(this.searchControlNode);mxui.widget.destroyChildren(this.toolBarNode);mxui.widget.destroyChildren(this.pagingBarNode);if(this.itemNode){mxui.widget.destroyChildren(this.itemNode);}if(_8f){_8f.destroy();}_1.forEach(this._searchElements,function(_90){_90.destroy();});this.devBlock&&this.devBlock.destroyRecursive();}catch(e){logger.error(this.id+".uninitialize : error : "+e.message);}this._dataSource=null;this._gridConfig=null;this._metaEntity=null;this._searchElements=null;}});});