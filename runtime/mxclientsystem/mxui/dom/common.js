
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/dom/common",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.dom.common");(function(){var _4=0,_5=[];var _6=function(_7){_7=_7||{};var _8=function(id,_9){if(!id){id=_4++;_9.setAttribute("data-id",id);}return id;};return function(_a,_b,_c){var id=typeof _a==="string"?_a:_a.getAttribute("data-id"),_d=_7[id];switch(arguments.length){case 1:return _d;case 2:if(_b===null){delete _7[id];return;}else{if(typeof _b=="object"){if(!_d){return _7[_8(id,_a)]=_b;}else{return _1.mixin(_d,_b);}}else{return _d&&_d[_b];}}break;case 3:if(_c===null){if(_d){delete _d[_b];}for(var i in _d){return;}delete _7[id];return;}else{if(!_d){_d=_7[_8(id,_a)]={};}return _d[_b]=_c;}}};};var _e=function(_f,_10){var _11=_f.parentNode;if(_11&&(!_10.parentNode||_10.parentNode.nodeType==11)){_11.insertBefore(_10,_f);_11.removeChild(_f);return true;}return false;};mxui.dom={nodeTypes:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},showNode:function(_12){for(var i=0,_13;_13=_5[i];i++){if(_13.node==_12){var _14=_13.span;_e(_14,_12);_5.splice(i,1);return true;}}return false;},hideNode:function(_15){var _16=mxui.dom.span();if(_e(_15,_16)){_5.push({node:_15,span:_16});return true;}return false;},copyChildren:function(src,_17){var _18=src.cloneNode(true);while(_18.firstChild){_17.appendChild(_18.removeChild(_18.firstChild));}},insertBefore:function(src,_19){if(_19.parentNode){_19.parentNode.insertBefore(src,_19);}},insertAfter:function(src,_1a){if(_1a.parentNode){if(_1a.nextSibling){_1a.nextSibling.parentNode.insertBefore(src,_1a.nextSibling);}else{_1a.parentNode.appendChild(src);}}},walkTree:function(_1b,_1c){if(_1b&&_1b.hasChildNodes){for(var i=0;i<_1b.childNodes.length;i++){mxui.dom.walkTree(_1b.childNodes[i],_1c);}}_1c(_1b);},walkNode:function(_1d,_1e,_1f){var _20=[0],_21;var _22=function(_23){try{_21=_23?_1e.call(_1f,_23,_20.slice())!==false:false;}catch(e){logger.error("mxui.dom.walkNode: Unable to execute action on node: "+e.message);_21=false;}if(_21&&_23.hasChildNodes){var i=_20.push(0)-1;var _24=null,_25=_23.firstChild;while(_25){_25=(_24=_25).nextSibling;_22(_24);_20[i]++;}_20.pop();}};_22(_1d);},nextNode:function(_26,_27){if(!_26||!_27){return true;}var cl=_27.length,sl=_26.length,_28=_27.length-1;return (sl>cl)||(cl==sl&&_27[_28]>_26[_28]);},getAncestorNode:function(_29,_2a,_2b){return _29&&((_29.nodeName==_2a)?_29:((--_2b==0)?false:arguments.callee(_29.parentNode,_2a,_2b)));},getFirstChild:function(_2c,_2d){_1.deprecated("mxui.dom.getFirstChild","Use dojo.query instead","5.0");if(typeof _2d=="string"){_2d=[_2d.toLowerCase()];}var _2e=false;var _2f=function(_30){for(var i=0;i<_2d.length;i++){if(_30.nodeName.toLowerCase()==_2d[i]){if(_2e==false){_2e=_30;return false;}}}return true;};var s=(function(_31,_32){if(_31&&_32(_31)&&_31.hasChildNodes){for(var i=0;i<_31.childNodes.length;i++){arguments.callee(_31.childNodes[i],_32);}}})(_2c,_2f);return _2e;},escapeHTMLQuotes:function(str){return str.replace(/\'/g,"&#39;").replace(/\"/g,"&#34;");},convertNlToBr:function(str){return str.replace(/\n/g,"<br />");},setSelectOptions:function(_33,_34,_35){var $=mxui.dom.create;if(!_33){return;}_34=_34||{};mxui.dom.empty(_33);_33.appendChild($("option",{value:""},""));for(var key in _34){var _36=$("option",{value:key},_34[key]);_33.appendChild(_36);if(key==_35){_36.selected=true;}}},getSelectedValue:function(_37){if(_37.nodeName.toLowerCase()=="select"){return (_37.selectedIndex!=-1)?_37.options[_37.selectedIndex].value:null;}else{return null;}},getSelectedText:function(_38){if(mendix.isIE){return _38.options[_38.selectedIndex].textValue;}else{return _38.options[_38.selectedIndex].text;}},selectOptionByText:function(_39,str){var i;if(mendix.isIE){for(i=0;i<_39.length;i++){if(_39.options[i].textValue==str){_39.options[i].selected=true;}}}else{for(i=0;i<_39.length;i++){if(_39.options[i].text==str){_39.options[i].selected=true;}}}},enableNode:function(_3a){_3a.removeAttribute("readonly");_3a.removeAttribute("disabled");},disableNode:function(_3b){_3b.setAttribute("disabled","disabled");_3b.setAttribute("readonly","readonly");},strip:function(_3c,_3d){mxui.dom.walkTree(_3c,function(e){if(e&&e.getAttribute&&e.getAttribute(_3d)){e.removeAttribute(_3d);}});return _3c;},disableSelection:function(e){if(!_1.isIE){e.style.MozUserSelect="none";}else{e.unselectable="on";}return true;},clearSelection:function(){var w=window,s=document.selection;if(s){try{s.empty&&s.empty();}catch(e){}}else{s=w.getSelection&&w.getSelection();s&&s.removeAllRanges&&s.removeAllRanges();}},selectTextRange:function(_3e,_3f,_40){if(_3e.createTextRange){var _41=_3e.createTextRange();_41.collapse(true);_41.moveEnd("character",_40);_41.moveStart("character",_3f);_41.select();}else{if(_3e.setSelectionRange){_3e.setSelectionRange(_3f,_40);}}},getCursorPosition:function(_42){if(document.selection){var _43=Math.abs(document.selection.createRange().moveStart("character",-1000000));var end=Math.abs(document.selection.createRange().moveEnd("character",-1000000));return _43;}else{if(_42.setSelectionRange){return _42.selectionStart;}}},getSelection:function(_44){if(document.selection){var _45=Math.abs(document.selection.createRange().moveStart("character",-1000000));var end=Math.abs(document.selection.createRange().moveEnd("character",-1000000));return {start:_45,end:end};}else{if(_44.setSelectionRange){return {start:_44.selectionStart,end:_44.selectionEnd};}}},liveConnect:function(_46,evt,_47,r,_48){if(arguments.length==3){r=_47;_47=null;}var _49={},_4a=[];for(var i in r){var _4b=i.split(".");var tag=_4b[0];var _4c=_4b[1];var _4d=r[i];if((typeof _4d=="string"&&_47[_4d])||typeof _4d=="function"){var _4e={fnc:_4d};if(tag){_49[String(tag).toUpperCase()]=_4e;}else{if(_4c){_4a.push(_4e);}}if(_4c){_4e.clazz=_4c;}}}var _4f=_1.hasClass;var _50=function(_51){for(var i=0,_4d;_4d=_4a[i];i++){if(_4f(_51,_4d.clazz)){return _4d;}}return null;};var run=function(fnc,e){if(typeof (fnc)=="function"){fnc(e);}else{_47&&_47[fnc](e);}};return _1.connect(_46,evt,function(e){var _52=e.target;var _53=_46;var e2={target:e.target};for(var i in e){var val=e[i];if(val==null||!(val instanceof Object)){e2[i]=val;}}while(_52!=_53&&_52!=null){var _54=_49[_52.nodeName];var _55=_50(_52);if(_54){var _56=_54.clazz;_54=((!_56)||(_4f(_52,_56)))?_54:null;}e2.currentTarget=_52;_54&&run(_54.fnc,e2);_55&&run(_55.fnc,e2);if(_48&&(_54||_55)){break;}_52=_52.parentNode;}});},liveDisconnect:function(_57){_1.disconnect(_57);},removeTabIndex:function(_58){if(_1.isIE){_58.removeAttribute("tabIndex");}_58.removeAttribute("tabindex");},isChild:function(_59,_5a){var _5b=_59;while((_5b=_5b.parentNode)!=null){if(_5b==_5a){return true;}}return false;},create:function(tag,_5c,_5d){var _5e,_5f=[].slice.call(arguments,1);_5c=_5c||{};if(_5c.nodeName||typeof _5c=="string"){_5d=_5f;_5c={};}else{_5d=_5f.slice(1);}if(tag=="#"){_5e=document.createDocumentFragment();}else{_5e=document.createElement(tag);for(var _60 in _5c){var _61=_5c[_60];if(_60=="style"&&typeof _61!="string"){var _62=_5e.style;for(var i in _61){_62[i]=_61[i];}}else{_5e.setAttribute(_60,_61);}}}_1.forEach(_5d,function(_63){if(typeof _63=="string"){_1.forEach(_63.split("\r\n"),function(_64,i){if(i>0){_5e.appendChild(mxui.dom.create("br"));}_5e.appendChild(document.createTextNode(_64));});}else{_5e.appendChild(_63);}});return _5e;},synthesizeEvent:function(evt,_65){var _66=_1.mixin({},evt,_65);_66.preventDefault=function(){evt.preventDefault();};_66.stopPropagation=function(){evt.stopPropagation();};return _66;},capture:function(_67,evt,_68){var _69=!_67.addEventListener,_6a=_67[_69?"attachEvent":"addEventListener"],_6b=_67[_69?"detachEvent":"removeEventListener"],_6c=_69?"on"+evt:evt;_6a.call(_67,_6c,_68,true);return {remove:function(){_6b.call(_67,_6c,_68,true);}};},supports:function(_6d){var _6e=_1.body().style;if(_6d in _6e){return _6d;}else{var _6f=["Webkit","Moz"],_70=_6d.charAt(0).toUpperCase()+_6d.slice(1);for(var i=_6f.length;i--;){var _71=_6f[i]+_70;if(_71 in _6e){return _71;}}}},supportsFixed:function(){var ua=navigator.userAgent,_72=true,_73;if(/AppleWebKit\/\d+/.test(ua)){if(/iPhone|iPad/.test(ua)){_73=/OS (\d)_/.exec(ua);_72=_73[1]&&_73[1]>=5;}else{if(/Android/.test(ua)){_73=/Android (\d\.\d)/.exec(ua);_72=_73[1]&&_73[1]>=2.2;}}}else{if(/Trident\/\d+/.test(ua)){_73=/MSIE (\d+)/.exec(ua);if(_73){_72=_73[1]&&_73[1]>=10;}else{_72=true;}}}return _72;},decodeXML:function(str){return str.replace(/&(lt|gt|apos|quot|amp);/g,function(_74,_75){return {lt:"<",gt:">",apos:"'",quot:"\"",amp:"&"}[_75];});},text:function(_76,str){if(typeof str!=="undefined"){_76.innerHTML="";_76.appendChild(document.createTextNode(str));}else{return "textContent" in _76?_76.textContent:_76.innerText;}},html:function(_77,str){if(typeof str!=="undefined"){_77.innerHTML=str;}else{return _77.innerHTML;}},orphan:function(_78){var p=_78.parentNode;if(p){p.removeChild(_78);}},empty:function(_79){var _7a;while(_7a=_79.firstChild){_79.removeChild(_7a);}},toArray:function(_7b){return _1.map(_7b,function(_7c){return _7c;});},escapeString:function(str){var _7d=mxui.dom.create("p");mxui.dom.escapeString=function(str){var _7e=str.split(/\r\n|\n/),out=[];for(var i=0;i<_7e.length;++i){mxui.dom.text(_7d,_7e[i]);out.push(_7d.innerHTML);}return out.join("\n");};return mxui.dom.escapeString(str);},getCss:function(_7f,doc,_80){doc=doc||document;var _81=doc.getElementsByTagName("link"),re=new RegExp(mx.appUrl+_7f);for(var i=0,_82;_82=_81[i];i++){if(re.test(_82.href)){return _82;}}return null;},addCss:function(_83,doc,_84){doc=doc||document;if(mxui.dom.getCss(_83,doc,_84)){return;}var _85=doc.getElementsByTagName("head")[0],_86=mxui.dom.create("link",{rel:"stylesheet",type:"text/css",media:_84||"screen",href:mx.appUrl+_83});_85.appendChild(_86);},removeCss:function(_87,doc,_88){var _89=mxui.dom.getCss(_87,doc,_88);if(_89){_89.parentNode.removeChild(_89);return true;}return false;},ieFocusable:{"a":true,"body":true,"button":true,"frame":true,"iframe":true,"input":true,"isIndex":true,"object":true,"select":true,"textarea":true},getTabIndex:function(_8a){if(!_8a||!_8a.getAttribute){return null;}var _8b;if(_1.isIE){_8b=_8a.tabIndex;if(_8b===0){var _8c=_8a.nodeName.toLowerCase(),_8d=_8a.attributes.tabIndex,_8e=_8d&&_8d.specified===true;return _8e||mxui.dom.ieFocusable[_8c]?"0":null;}else{return ""+_8b;}}else{var _8f=_8a.getAttribute("tabindex");_8b=String(_8a.tabIndex);if(_8f!=null||_8b>=0){if(!_1.isFF){return (_8f==="")?null:_8b;}else{return _8b;}}else{return null;}}},getFocusIndex:function(_90){var _91=mxui.dom.getTabIndex(_90);return _91>=0?_91:null;},coords:function(_92){return _1.mixin(_1.position(_92),_1.marginBox(_92));},data:_6(),getScopedData:_6,moveIntoView:function(_93,_94){_94=_94||0;var pos=_1.position(_93),_95=_2.getViewport(),_96=_93.style,_97=pos.y+pos.h+_94,_98=pos.x+pos.w+_94;if(pos.y<_94||pos.h+_94*2>_95.h){_96.top=_94+"px";}else{if(_97>_95.h){_96.top=pos.y-(_97-_95.h)+"px";}}if(pos.x<_94||pos.w+_94*2>_95.w){_96.left=_94+"px";}else{if(_98>_95.w){_96.left=pos.x-(_98-_95.w)+"px";}}}};})();});