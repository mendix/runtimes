/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget",["mxui/widget/_Button","mxui/widget/_WidgetBase","mxui/widget/_Widget","mxui/html/parser","mxui/dom","mendix/lang","mendix/logger","dijit/_Widget","dijit/registry","dojo/dom-geometry","dojo/_base/kernel","dojo/_base/array","dojo/_base/lang","dojo/_base/declare","exports"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){_f.getDisableables=function(_10){var _11=[];var run=function(_12){var _13=_12.childNodes;for(var i=0,_14;_14=_13[i];i++){if(_14.nodeType!=1){continue;}var id=_14.getAttribute("widgetId"),_15=_9.byId(id);if(_15&&!(/^dijit/.test(id)||_15._btn_||_15 instanceof _1)){_11.push(_15);}if(!(_15 instanceof _2)){run(_14);}}};run(_10);return _11;};_f.findNonPlaceholderParent=function(_16){var pn=_16.parentNode;while(pn&&pn.hasAttribute("data-mx-placeholder")){pn=pn.parentNode;}return pn;};_f.resizeWidgetsIn=function(_17,_18){var _19=_9.findWidgets(_17);if(!_18&&_19.length==1&&_17.children.length==1&&_19[0].domNode.parentNode.children.length==1){var _1a=_19[0],_1b=_f.findNonPlaceholderParent(_1a.domNode);if(_1b==_17||_1b==_1a.mxform.domNode){var box=_a.getContentBox(_17);var _1c=_1a.domNode.style;_1c.marginTop=_1c.marginBottom="0";_1a.resize({w:box.w,h:box.h});return;}}_c.forEach(_19,function(_1d){_1d.resize();});};_f.fireOnReady=function(_1e,_1f){var _20=[];dojo.forEach(_1e,function(w){if(w.addOnLoad){_20.push(function(h){w.addOnLoad(h);});}});_6.sequence(_20,_1f);};_f.destroyWidgetsIn=function(_21){var _22=_9.findWidgets(_21),_23=_f.getDescendantWidgets(_21);_c.forEach(_22,function(_24){try{_24.destroyRecursive();}catch(e){_7.error(_24.id+".destroy: Unable to destroy:"+e.message);}});_c.forEach(_23,function(_25){if(!_25._destroyed){_7.error(_25.id+": widget not destroyed, check parent's uninitialize method");}});};function _26(_27,_28,_29){var _2a=[],i=_27.length;while(i--){var _2b=_27[i].prototype,fnc=_2b[_29];if(fnc){_2a.push(fnc);}}return _2a.length?function(){for(var i=0,_2c;_2c=_2a[i];i++){try{_2c.call(this);}catch(e){var _2d=_2c.ctor&&_2c.ctor.prototype,_2e=(_2d&&_2d.declaredClass)||"some";_7.error(this.id+"."+_28+": Can not execute "+_29+" function of "+_2e+" addon :"+e.message);}}}:function(){};};function _2f(_30,_31,_32){var _33=function(_34){if(this instanceof arguments.callee){var _35=(_34&&_34.callee==arguments.callee)?_34:arguments;try{if(_30){_30.apply(this,_35);}}catch(e){var _36=typeof e=="string"?e:e.message;_7.error(this.id+".Unable to render widget. ERROR: "+_36);this.loaded();this._broken=true;this._brokenError=_36;var _37=this.domNode&&this.domNode.parentNode,_38=_5.div({refWidgetId:this.id,style:"color:red"},"Unable to render "+this.id+" widget: "+_36);if(_37){_37.removeChild(this.domNode);_37.appendChild(_38);}else{var _39=(arguments.length==2&&arguments[1].nodeName)?arguments[1]:null;if(_39&&_39.parentNode){_39.parentNode.appendChild(_38);}}}}else{if(_31){var _3a=(arguments.callee.caller)?"from scope "+arguments.callee.caller.toString():"from unknown scope";}return new arguments.callee(arguments);}};if(_30){for(var x in _30){_33[x]=_30[x];}_33.prototype=_30.prototype;_33.prototype.constructor=_33;}return _33;};function _3b(_3c){var _3d=[];for(var i=0,l=_3c.length;i<l;i++){var _3e=_3c[i],_3f=(typeof _3e=="string")?_d.getObject(_3e):_3e;if(_3f==null||typeof (_3f)=="object"){throw new Error("mxui/widget/declare: Mixin '"+_3e.toString()+"' is not loaded! Maybe it's broken???");}_3d.push(_3f);}return _3d;};function _40(_41,_42,_43){var _44=function(_45){var _46=_45.inputargs,_47=false;if(_46 instanceof Array){var _48={};for(var i=0,l=_46.length;i<l;i++){if(typeof _46[i]=="object"){for(var x in _46[i]){_48[x]=_46[i][x];break;}_47=true;}else{_48[_46[i]]="";}}if(_47){}_46=_48;}if(_46){var _49=_41.__inputargs?_41.__inputargs:(_41.__inputargs={});for(var j in _46){_49[j]=_41[j]=_46[j];}}};for(var k=0,l=_42.length;k<l;k++){var _4a=_42[k].prototype;_44(_4a);}_44(_41);for(var m=0,n=_43.length;m<n;m++){var _4b=_43[m].prototype;_44(_4b);}};_f.declare=function(_4c,_4d){var _4e=_4d.superclass||_8,_4f=_4d.mixins||[],_50=_4c.split(".");if(_50.length==1){_4c="mxui.widget."+_50;_50=_4c.split(".");}var _51=_4e.prototype._mx_?[_4e]:[_4e,_3];var _52=_51.concat(_3b(_4f)),_53=_50.pop();_4d.moduleName=_50.join(".");_4d.className=_53;_4d.initializer=_26(_52,"create","initialize");_4d.uninitializer=_26(_52,"destroy","uninitialize");_40(_4d,_51,_4f);var _54=_e(_4c,_52,_4d);var _55=_2f(_54,true,_4c);return _d.setObject(_4c,_55);};_f.createCSSMap=function(_56,css){for(var i in css){css[i]=_56+"-"+css[i];}css.baseClass=_56;return css;};_f.getDescendantWidgets=function(_57){return _57?_c.map(_57.querySelectorAll("[widgetid]"),_9.byNode):[];};_f.loadWidgetsIn=function(_58,_59,_5a,_5b){_4.parse(_58,_59);var _5c=_9.findWidgets(_58);_6.collect(_c.map(_5c,function(_5d){var _5e=_f.getDescendantWidgets(_5d.domNode),_5f=_5e.concat([_5d]);return function(_60){_f.fireOnReady(_5f,function(){_f.applyContext([_5d],_5a,_60);});};}),_5b);};_f.ready=function(_61,_62,_63){var _64=[];_c.forEach(_61,function(_65){if(_65.addOnLoad){_64.push(function(_66){_65.addOnLoad(_66);});}});_6.collect(_64,_62,_63);};_f.applyContext=function(_67,_68,_69){_6.collect(_c.map(_67,function(_6a){if(_6a.applyContext){return function(cb){try{_6a.applyContext(_68,cb);}catch(e){throw new Error(_6a.id+".applyContext: "+e);}};}else{return function(cb){try{var _6b=_9.findWidgets(_6a.domNode);_f.applyContext(_6b,_68,cb);}catch(e){throw new Error(_6a.id+".applyContext: "+e);}};}}),_69);};});