/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget",["mxui/widget/_Button","mxui/widget/_WidgetBase","mxui/widget/_Widget","mxui/html/parser","mxui/dom","mendix/lang","mendix/logger","dijit/_Widget","dijit/registry","dojo/dom-geometry","dojo/_base/kernel","dojo/_base/array","dojo/_base/lang","dojo/_base/declare","exports"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){_f.getDisableables=function(_10){var _11=[];var run=function(_12){var _13=_12.childNodes;for(var i=0,_14;_14=_13[i];i++){if(_14.nodeType!=1){continue;}var id=_14.getAttribute("widgetId"),_15=_9.byId(id);if(_15&&!(/^dijit/.test(id)||_15._btn_||_15 instanceof _1)){_11.push(_15);}if(!(_15 instanceof _2)){run(_14);}}};run(_10);return _11;};_f.findNonPlaceholderParent=function(_16){var pn=_16.parentNode;while(pn&&pn.hasAttribute("data-mx-placeholder")){pn=pn.parentNode;}return pn;};_f.resizeWidgetsIn=function(_17,_18){var _19=_9.findWidgets(_17);if(!_18&&_19.length==1&&_17.children.length==1&&_19[0].domNode.parentNode.children.length==1){var _1a=_19[0],_1b=_f.findNonPlaceholderParent(_1a.domNode);if(_1b==_17||_1b==_1a.mxform.domNode){var box=_a.getContentBox(_17);_1a.resize({w:box.w,h:box.h});return;}}_c.forEach(_19,function(_1c){_1c.resize();});};_f.fireOnReady=function(_1d,_1e){var _1f=[];dojo.forEach(_1d,function(w){if(w.addOnLoad){_1f.push(function(h){w.addOnLoad(h);});}});if(_1e){_1f.push(function(){_1e();});}_6.sequence(_1f);};_f.destroyWidgetsIn=function(_20){var _21=_9.findWidgets(_20),_22=_f.getDescendantWidgets(_20);_c.forEach(_21,function(_23){try{_23.destroyRecursive();}catch(e){_7.error(_23.id+".destroy: Unable to destroy:"+e.message);}});_c.forEach(_22,function(_24){if(!_24._destroyed){_7.error(_24.id+": widget not destroyed, check parent's uninitialize method");}});};function _25(_26,_27,_28){var _29=[],i=_26.length;while(i--){var _2a=_26[i].prototype,fnc=_2a[_28];fnc&&_29.push(fnc);}return _29.length?function(){var _2b=null;for(var i=0,_2c;_2c=_29[i];i++){try{_2c.call(this);}catch(e){var _2d=_2c.ctor&&_2c.ctor.prototype,_2e=(_2d&&_2d.declaredClass)||"some";_7.error(this.id+"."+_27+": Can not execute "+_28+" function of "+_2e+" addon :"+e.message);}}}:function(){};};function _2f(_30,_31,_32){var _33=function(_34){if(this instanceof arguments.callee){var _35=(_34&&_34.callee==arguments.callee)?_34:arguments;try{_30&&_30.apply(this,_35);}catch(e){var _36=typeof e=="string"?e:e.message;_7.error(this.id+".Unable to render widget. ERROR: "+_36);this.loaded();this._broken=true;this._brokenError=_36;var _37=this.domNode&&this.domNode.parentNode,_38=_5.div({refWidgetId:this.id,style:"color:red"},"Unable to render "+this.id+" widget: "+_36);if(_37){_37.removeChild(this.domNode);_37.appendChild(_38);}else{var _39=(arguments.length==2&&arguments[1].nodeName)?arguments[1]:null;if(_39&&_39.parentNode){_39.parentNode.appendChild(_38);}}}}else{if(_31){var _3a=(arguments.callee.caller)?"from scope "+arguments.callee.caller.toString():"from unknown scope";}return new arguments.callee(arguments);}};if(_30){for(var x in _30){_33[x]=_30[x];}_33.prototype=_30.prototype;_33.prototype.constructor=_33;}return _33;};function _3b(_3c){var _3d=[];for(var i=0,l=_3c.length;i<l;i++){var _3e=_3c[i],_3f=(typeof _3e=="string")?_d.getObject(_3e):_3e;if(_3f==null||typeof (_3f)=="object"){throw new Error("mxui/widget/declare: Mixin '"+_3e.toString()+"' is not loaded! Maybe it's broken???");}_3d.push(_3f);}return _3d;};function _40(_41,_42,_43){var _44=function(_45){var _46=_45.inputargs,_47=false;if(_46 instanceof Array){var _48={};for(var i=0,l=_46.length;i<l;i++){if(typeof _46[i]=="object"){for(var x in _46[i]){_48[x]=_46[i][x];break;}_47=true;}else{_48[_46[i]]="";}}if(_47){}_46=_48;}if(_46){var _49=_41.__inputargs?_41.__inputargs:(_41.__inputargs={});for(var i in _46){_49[i]=_41[i]=_46[i];}}};for(var i=0,l=_42.length;i<l;i++){var _4a=_42[i].prototype;_44(_4a);}_44(_41);for(var i=0,l=_43.length;i<l;i++){var _4b=_43[i].prototype;_44(_4b);}};_f.declare=function(_4c,_4d){var _4e=_4d.superclass||_8,_4f=_4d.mixins,_50=_4d.constructor,_51=_4c.split(".");if(!_4f&&_4d.addons){_b.deprecated("mxui.widget.declare: addons are deprecated, use mixins instead (widget: "+_4c+")","","3.1");_4f=_4d.addons;}_4f=_4f||[];if(_51.length==1){_4c="mxui.widget."+_51;_51=_4c.split(".");}var _52=_4e.prototype["_mx_"]?[_4e]:[_4e,_3];var _4f=_3b(_4f),_53=_52.concat(_4f),_54=_51.pop();_4d.moduleName=_51.join(".");_4d.className=_54;_4d["initializer"]=_25(_53,"create","initialize");_4d["uninitializer"]=_25(_53,"destroy","uninitialize");_40(_4d,_52,_4f);var _55=_e(_4c,_53,_4d);var _56=_2f(_55,true,_4c);return _d.setObject(_4c,_56);};_f.createCSSMap=function(_57,css){for(var i in css){css[i]=_57+"-"+css[i];}css.baseClass=_57;return css;};_f.getDescendantWidgets=function(_58){return _58?_c.map(_58.querySelectorAll("[widgetid]"),_9.byNode):[];};_f.loadWidgetsIn=function(_59,_5a,_5b,_5c){_4.parse(_59,_5a);var _5d=_9.findWidgets(_59);_6.collect(_c.map(_5d,function(_5e){var _5f=_f.getDescendantWidgets(_5e.domNode),_60=_5f.concat([_5e]);return function(_61){_f.fireOnReady(_60,function(){_f.applyContext([_5e],_5b,_61);});};}),_5c);};_f.ready=function(_62,_63,_64){var _65=[];_c.forEach(_62,function(_66){if(_66.addOnLoad){_65.push(function(_67){_66.addOnLoad(_67);});}});_6.collect(_65,_63,_64);};_f.applyContext=function(_68,_69,_6a){_6.collect(_c.map(_68,function(_6b){if(_6b.applyContext){return function(cb){try{_6b.applyContext(_69,cb);}catch(e){throw new Error(_6b.id+".applyContext: "+e);}};}else{return function(cb){try{var _6c=_9.findWidgets(_6b.domNode);_f.applyContext(_6c,_69,cb);}catch(e){throw new Error(_6b.id+".applyContext: "+e);}};}}),_6a);};});