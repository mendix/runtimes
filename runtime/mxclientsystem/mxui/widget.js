/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/widget",["mxui/widget/_MasterTooltip","mxui/widget/_Button","mxui/widget/_WidgetBase","mxui/widget/_Widget","mxui/html/parser","mxui/dom","mendix/lang","mendix/logger","dijit/_Widget","dijit/registry","dojo/dom-geometry","dojo/_base/kernel","dojo/_base/array","dojo/_base/lang","dojo/_base/declare","exports"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10){_10.getDisableables=function(_11){var _12=[];var run=function(_13){var _14=_13.childNodes;for(var i=0,_15;_15=_14[i];i++){if(_15.nodeType!=1){continue;}var id=_15.getAttribute("widgetId"),_16=_a.byId(id);if(_16&&!(/^dijit/.test(id)||_16._btn_||_16 instanceof _2)){_12.push(_16);}if(!(_16 instanceof _3)){run(_15);}}};run(_11);return _12;};_10.findNonPlaceholderParent=function(_17){var pn=_17.parentNode;while(pn&&pn.hasAttribute("data-mx-placeholder")){pn=pn.parentNode;}return pn;};_10.resizeChildrenIn=function(_18,_19){var _1a=_a.findWidgets(_18);if(!_19&&_1a.length==1&&_18.children.length==1){var _1b=_1a[0],_1c=_10.findNonPlaceholderParent(_1b.domNode);if(_1c==_18||_1c==_1b.mxform.domNode){var box=_b.getContentBox(_18);if(typeof _1b.resize=="function"){_1b.resize({w:box.w,h:box.h});}return;}}_d.forEach(_1a,function(_1d){if(typeof _1d.resize=="function"){_1d.resize();}});};_10.fireOnReady=function(_1e,_1f){var _20=[];dojo.forEach(_1e,function(w){if(w.addOnLoad){_20.push(function(h){w.addOnLoad(h);});}});if(_1f){_20.push(function(){_1f();});}_7.sequence(_20);};_10.destroyChildren=function(_21){var _22=_a.findWidgets(_21),_23=_10.getDescendantWidgets(_21);_d.forEach(_22,function(_24){try{_24.destroyRecursive();}catch(e){_8.error(_24.id+".destroy: Unable to destroy:"+e.message);}});_d.forEach(_23,function(_25){if(!_25._destroyed){_8.error(_25.id+": widget not destroyed, check parent's uninitialize method");}});};function _26(_27,_28,_29){var _2a=[],i=_27.length;while(i--){var _2b=_27[i].prototype,fnc=_2b[_29];fnc&&_2a.push(fnc);}return _2a.length?function(){var _2c=null;for(var i=0,_2d;_2d=_2a[i];i++){try{_2d.call(this);}catch(e){var _2e=_2d.ctor&&_2d.ctor.prototype,_2f=(_2e&&_2e.declaredClass)||"some";_8.error(this.id+"."+_28+": Can not execute "+_29+" function of "+_2f+" addon :"+e.message);}}}:function(){};};function _30(_31,_32,_33){var _34=function(_35){if(this instanceof arguments.callee){var _36=(_35&&_35.callee==arguments.callee)?_35:arguments;try{_31&&_31.apply(this,_36);}catch(e){var _37=typeof e=="string"?e:e.message;_8.error(this.id+".Unable to render widget. ERROR: "+_37);this.loaded();this._broken=true;this._brokenError=_37;var _38=this.domNode&&this.domNode.parentNode,_39=_6.div({refWidgetId:this.id,style:"color:red"},"Unable to render "+this.id+" widget: "+_37);if(_38){_38.removeChild(this.domNode);_38.appendChild(_39);}else{var _3a=(arguments.length==2&&arguments[1].nodeName)?arguments[1]:null;if(_3a&&_3a.parentNode){_3a.parentNode.appendChild(_39);}}}}else{if(_32){var _3b=(arguments.callee.caller)?"from scope "+arguments.callee.caller.toString():"from unknown scope";}return new arguments.callee(arguments);}};if(_31){for(var x in _31){_34[x]=_31[x];}_34.prototype=_31.prototype;_34.prototype.constructor=_34;}return _34;};function _3c(_3d){var _3e=[];for(var i=0,l=_3d.length;i<l;i++){var _3f=_3d[i],_40=(typeof _3f=="string")?_e.getObject(_3f):_3f;if(_40==null||typeof (_40)=="object"){throw new Error("mxui.widget.declare: Mixin '"+_3f.toString()+"' is not loaded! Maybe it's broken???");}_3e.push(_40);}return _3e;};function _41(_42,_43,_44){var _45=function(_46){var _47=_46.inputargs,_48=false;if(_47 instanceof Array){var _49={};for(var i=0,l=_47.length;i<l;i++){if(typeof _47[i]=="object"){for(var x in _47[i]){_49[x]=_47[i][x];break;}_48=true;}else{_49[_47[i]]="";}}if(_48){}_47=_49;}if(_47){var _4a=_42.__inputargs?_42.__inputargs:(_42.__inputargs={});for(var i in _47){_4a[i]=_42[i]=_47[i];}}};for(var i=0,l=_43.length;i<l;i++){var _4b=_43[i].prototype;_45(_4b);}_45(_42);for(var i=0,l=_44.length;i<l;i++){var _4c=_44[i].prototype;_45(_4c);}};_10.declare=function(_4d,_4e){var _4f=_4e.superclass||_9,_50=_4e.mixins,_51=_4e.constructor,_52=_4d.split(".");if(!_50&&_4e.addons){_c.deprecated("mxui.widget.declare: addons are deprecated, use mixins instead (widget: "+_4d+")","","3.1");_50=_4e.addons;}_50=_50||[];if(_52.length==1){_4d="mxui.widget."+_52;_52=_4d.split(".");}var _53=_4f.prototype["_mx_"]?[_4f]:[_4f,_4];var _50=_3c(_50),_54=_53.concat(_50),_55=_52.pop();_4e.moduleName=_52.join(".");_4e.className=_55;_4e["initializer"]=_26(_54,"create","initialize");_4e["uninitializer"]=_26(_54,"destroy","uninitialize");_41(_4e,_53,_50);var _56=_f(_4d,_54,_4e);var _57=_30(_56,true,_4d);return _e.setObject(_4d,_57);};_10.createCSSMap=function(_58,css){for(var i in css){css[i]=_58+"-"+css[i];}css.baseClass=_58;return css;};_10.getDescendantWidgets=function(_59){return _59?_d.map(_59.querySelectorAll("[widgetid]"),_a.byNode):[];};_10.loadWidgetsIn=function(_5a,_5b,_5c,_5d){_5.parse(_5a,_5b);var _5e=_a.findWidgets(_5a);_7.collect(_d.map(_5e,function(_5f){var _60=_10.getDescendantWidgets(_5f.domNode),_61=_60.concat([_5f]);return function(_62){_10.fireOnReady(_61,function(){_10.applyContext([_5f],_5c,_62);});};}),_5d);};_10.ready=function(_63,_64,_65){var _66=[];_d.forEach(_63,function(_67){if(_67.addOnLoad){_66.push(function(_68){_67.addOnLoad(_68);});}});_7.collect(_66,_64,_65);};_10.applyContext=function(_69,_6a,_6b){_7.collect(_d.map(_69,function(_6c){if(_6c.applyContext){return function(cb){try{_6c.applyContext(_6a,cb);}catch(e){throw new Error(_6c.id+".applyContext: "+e);}};}else{return function(cb){try{var _6d=_a.findWidgets(_6c.domNode);_10.applyContext(_6d,_6a,cb);}catch(e){throw new Error(_6c.id+".applyContext: "+e);}};}}),_6b);};var _6e=null;_10.showTooltip=function(){if(!_6e){_6e=new _1();}_6e.show.apply(_6e,arguments);};_10.hideTooltip=function(_6f){if(!_6e){_6e=new _1();}if(_6f==null){_6f=_6e.currentNode;}_6e.hide(_6f);};});