/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/gestures/swipeToNavigate",["mxui/dom","dojo/aspect","dojo/on","dojo/dom-class","dojo/sniff","mxui/sys/history"],function(_1,_2,_3,_4,_5,_6){"use strict";var _7=_5("ios")&&"cordova" in window&&"screenshot" in window.navigator;if(!_7){return;}var _8={NAVIGATING:1,TAKING_SCREENSHOT:2,IDLE:3,SWIPING:4,TRANSITIONING_TO_OFF_SCREEN:5,TRANSITIONING_BACK_TO_ORIGIN:6,TOUCH_CANCELED:7};var _9=_8.NAVIGATING;var _a="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";var _b=_c("mx-screenshot-previous-page");_b.src=_a;var _d=_c("mx-screenshot-current-page");document.body.appendChild(_b);document.body.appendChild(_d);document.addEventListener("swiperight",_e);document.addEventListener("swiperightend",_f);document.addEventListener("swipeleft",_e);document.addEventListener("swipeleftend",_f);document.addEventListener("swipeleftcancel",_10);document.addEventListener("swiperightcancel",_10);document.addEventListener("touchstart",_11,true);_d.addEventListener("load",_12);_2.after(_6,"onNavigation",function(){_9=_8.NAVIGATING;});_2.after(window.mx.router.getContentForm(),"onNavigation",function(){_9=_8.TAKING_SCREENSHOT;_13();});function _11(){if(_9===_8.IDLE){_13();}};function _e(e){var _14=e.detail.originPageX<20;var _15=_9!==_8.IDLE&&_9!==_8.SWIPING;if(_15||!_14||_6.isAtBeginning()){return;}_9=_8.SWIPING;if(_d.style.display==="none"){_b.style.display="";_d.style.display="";}_d.style.left=e.detail.pageX+"px";};function _f(e){if(_9!==_8.SWIPING){return;}var _16=e.detail.pageX>=window.screen.width*0.5;if(_16){_9=_8.TRANSITIONING_TO_OFF_SCREEN;_17("100%",_18);}else{_9=_8.TRANSITIONING_BACK_TO_ORIGIN;_17("0",_19);}};function _10(){if(_9===_8.SWIPING){_9=_8.TOUCH_CANCELED;_17("0",_19);}};function _17(_1a,_1b){_d.style.transition="left 0.3s ease-out";window.setTimeout(function(){_d.style.transition="";_1b();},400);_d.style.left=_1a;};function _18(){if(_9!==_8.TRANSITIONING_TO_OFF_SCREEN){return;}var _1c=_1.create("div",{"class":"mx-swipe-navigation-progress"});var _1d=setTimeout(function(){document.body.appendChild(_1c);},200);var _1e=_2.after(window.mx.router.getContentForm(),"onNavigation",function(){_1e.remove();clearTimeout(_1d);_1.orphan(_1c);_19();});_6.back();};function _19(){_b.style.display="none";_d.style.left=0;_d.style.display="none";if(_9===_8.TOUCH_CANCELED||_9===_8.TRANSITIONING_BACK_TO_ORIGIN){_9=_8.IDLE;}};function _c(_1f){return _1.create("img",{"class":_1f,style:{position:"absolute",top:"-20px",left:0,width:window.screen.width+"px",height:window.screen.height+"px",display:"none"}});};function _13(){window.navigator.screenshot.URI(function(_20,_21){_d.src=_21.URI;},40);};function _12(){if(_9===_8.TAKING_SCREENSHOT){_9=_8.IDLE;}};return {remove:function(){document.body.removeChild(_b);document.body.removeChild(_d);document.removeEventListener("swiperight",_e);document.removeEventListener("swiperightend",_f);document.removeEventListener("swipeleft",_e);document.removeEventListener("swipeleftend",_f);document.removeEventListener("swipeleftcancel",_10);document.removeEventListener("swiperightcancel",_10);document.removeEventListener("touchstart",_11,true);}};});