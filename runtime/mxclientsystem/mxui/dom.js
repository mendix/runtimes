
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/dom",["dojo/sniff","dojo/_base/lang","dojo/_base/kernel","dojo/_base/connect","dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/window","mendix/logger"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){var _b=0,_c=document.createElement("p");var _d=function(_e){_e=_e||{};var _f=function(id,_10){if(!id){id=_b++;_10.setAttribute("data-id",id);}return id;};return function(_11,key,_12){var id=typeof _11==="string"?_11:_11.getAttribute("data-id"),map=_e[id];switch(arguments.length){case 1:return map;case 2:if(key===null){delete _e[id];return;}else{if(typeof key=="object"){if(!map){return _e[_f(id,_11)]=key;}else{return _2.mixin(map,key);}}else{return map&&map[key];}}break;case 3:if(_12===null){if(map){delete map[key];}for(var i in map){return;}delete _e[id];return;}else{if(!map){map=_e[_f(id,_11)]={};}return map[key]=_12;}}};};var dom={minContainerHeight:100,nodeTypes:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},walkTree:function(_13,_14){if(_13&&_13.hasChildNodes){for(var i=0;i<_13.childNodes.length;i++){dom.walkTree(_13.childNodes[i],_14);}}_14(_13);},walkNode:function(_15,_16,_17){var _18=[0],_19;var _1a=function(_1b){try{_19=_1b?_16.call(_17,_1b,_18.slice())!==false:false;}catch(e){_a.error("mxui.dom.walkNode: Unable to execute action on node: "+e.message);_19=false;}if(_19&&_1b.hasChildNodes){var i=_18.push(0)-1;var _1c=null,_1d=_1b.firstChild;while(_1d){_1d=(_1c=_1d).nextSibling;_1a(_1c);_18[i]++;}_18.pop();}};_1a(_15);},nextNode:function(_1e,_1f){if(!_1e||!_1f){return true;}var cl=_1f.length,sl=_1e.length,_20=_1f.length-1;return (sl>cl)||(cl==sl&&_1f[_20]>_1e[_20]);},getAncestorNode:function(_21,_22,_23){return _21&&((_21.nodeName==_22)?_21:((--_23==0)?false:arguments.callee(_21.parentNode,_22,_23)));},getFirstChild:function(_24,_25){_3.deprecated("mxui.dom.getFirstChild","Use dojo.query instead","5.0");if(typeof _25=="string"){_25=[_25.toLowerCase()];}var _26=false;var _27=function(_28){for(var i=0;i<_25.length;i++){if(_28.nodeName.toLowerCase()==_25[i]){if(_26==false){_26=_28;return false;}}}return true;};function _29(_2a,_2b){if(_2a&&_2b(_2a)&&_2a.hasChildNodes){for(var i=0;i<_2a.childNodes.length;i++){_29(_2a.childNodes[i],_2b);}}};_29(_24,_27);return _26;},escapeHTMLQuotes:function(str){return str.replace(/\'/g,"&#39;").replace(/\"/g,"&#34;");},convertNlToBr:function(str){return str.replace(/\n/g,"<br />");},setSelectOptions:function(_2c,_2d,_2e){var $=dom.create;if(!_2c){return;}_2d=_2d||{};dom.empty(_2c);_2c.appendChild($("option",{value:""},""));for(var key in _2d){var _2f=$("option",{value:key},_2d[key]);_2c.appendChild(_2f);if(key==_2e){_2f.selected=true;}}},getSelectedValue:function(_30){if(_30.nodeName.toLowerCase()=="select"){return (_30.selectedIndex!=-1)?_30.options[_30.selectedIndex].value:null;}else{return null;}},getSelectedText:function(_31){return _31.options[_31.selectedIndex].text;},selectOptionByValue:function(_32,_33){for(var i=0;i<_32.length;++i){if(_32.options[i].value==_33){_32.options[i].selected=true;}}},selectOptionByText:function(_34,_35){for(var i=0;i<_34.length;++i){if(_34.options[i].text==_35){_34.options[i].selected=true;}}},enableNode:function(_36){_36.removeAttribute("readonly");_36.removeAttribute("disabled");},disableNode:function(_37){_37.setAttribute("disabled","disabled");_37.setAttribute("readonly","readonly");},disableSelection:function(e){if(!_1("ie")){e.style.MozUserSelect="none";}else{e.unselectable="on";}return true;},clearSelection:function(){var w=window,s=document.selection;if(s){try{s.empty&&s.empty();}catch(e){}}else{s=w.getSelection&&w.getSelection();s&&s.removeAllRanges&&s.removeAllRanges();}},selectTextRange:function(_38,_39,_3a){if(_38.createTextRange){var _3b=_38.createTextRange();_3b.collapse(true);_3b.moveEnd("character",_3a);_3b.moveStart("character",_39);_3b.select();}else{if(_38.setSelectionRange){_38.setSelectionRange(_39,_3a);}}},getCursorPosition:function(_3c){if(document.selection){var _3d=Math.abs(document.selection.createRange().moveStart("character",-1000000));document.selection.createRange().moveEnd("character",-1000000);return _3d;}else{if(_3c.setSelectionRange){return _3c.selectionStart;}}},getSelection:function(_3e){if(document.selection){var _3f=Math.abs(document.selection.createRange().moveStart("character",-1000000));var end=Math.abs(document.selection.createRange().moveEnd("character",-1000000));return {start:_3f,end:end};}else{if(_3e.setSelectionRange){return {start:_3e.selectionStart,end:_3e.selectionEnd};}}},liveConnect:function(_40,evt,_41,r,_42){if(arguments.length==3){r=_41;_41=null;}var _43={},_44=[];for(var i in r){var _45=i.split(".");var tag=_45[0];var _46=_45[1];var _47=r[i];if((typeof _47=="string"&&_41[_47])||typeof _47=="function"){var _48={fnc:_47};if(tag){_43[String(tag).toUpperCase()]=_48;}else{if(_46){_44.push(_48);}}if(_46){_48.clazz=_46;}}}var _49=function(_4a){for(var i=0,_47;_47=_44[i];i++){if(_6.contains(_4a,_47.clazz)){return _47;}}return null;};var run=function(fnc,e){if(typeof (fnc)=="function"){fnc(e);}else{_41&&_41[fnc](e);}};return _4.connect(_40,evt,function(e){var _4b=e.target;var _4c=_40;var e2={target:e.target};for(var i in e){var val=e[i];if(val==null||!(val instanceof Object)){e2[i]=val;}}while(_4b!=_4c&&_4b!=null){var _4d=_43[_4b.nodeName];var _4e=_49(_4b);if(_4d){var _4f=_4d.clazz;_4d=((!_4f)||(_6.contains(_4b,_4f)))?_4d:null;}e2.currentTarget=_4b;_4d&&run(_4d.fnc,e2);_4e&&run(_4e.fnc,e2);if(_42&&(_4d||_4e)){break;}_4b=_4b.parentNode;}});},liveDisconnect:function(_50){_4.disconnect(_50);},create:function(tag,_51,_52){var _53,_54=[].slice.call(arguments,1);_51=_51||{};if(_51.nodeName||typeof _51=="string"){_52=_54;_51={};}else{_52=_54.slice(1);}if(tag=="#"){_53=document.createDocumentFragment();}else{_53=document.createElement(tag);for(var _55 in _51){var _56=_51[_55];if(_55=="style"&&typeof _56!="string"){var _57=_53.style;for(var i in _56){_57[i]=_56[i];}}else{_53.setAttribute(_55,_56);}}}_5.forEach(_52,function(_58){if(typeof _58=="string"){_5.forEach(_58.split("\r\n"),function(_59,i){if(i>0){_53.appendChild(dom.create("br"));}_53.appendChild(document.createTextNode(_59));});}else{_53.appendChild(_58);}});return _53;},synthesizeEvent:function(evt,_5a){var _5b=_2.mixin({},evt,_5a);_5b.preventDefault=function(){evt.preventDefault();};_5b.stopPropagation=function(){evt.stopPropagation();};return _5b;},capture:function(_5c,evt,_5d){var _5e=!_5c.addEventListener,_5f=_5c[_5e?"attachEvent":"addEventListener"],_60=_5c[_5e?"detachEvent":"removeEventListener"],_61=_5e?"on"+evt:evt;_5f.call(_5c,_61,_5d,true);return {remove:function(){_60.call(_5c,_61,_5d,true);}};},supports:function(_62){var _63=document.body.style;if(_62 in _63){return _62;}else{var _64=["Webkit","Moz"],_65=_62.charAt(0).toUpperCase()+_62.slice(1);for(var i=_64.length;i--;){var _66=_64[i]+_65;if(_66 in _63){return _66;}}}},text:function(_67,str){if(typeof str!=="undefined"){_67.innerHTML="";_67.appendChild(document.createTextNode(str));}else{return "textContent" in _67?_67.textContent:_67.innerText;}},html:function(_68,str){if(typeof str!=="undefined"){_68.innerHTML=str;}else{return _68.innerHTML;}},orphan:function(_69){var p=_69.parentNode;if(p){p.removeChild(_69);}},empty:function(_6a){var _6b;while(_6b=_6a.firstChild){_6a.removeChild(_6b);}},toArray:function(_6c){return _5.map(_6c,function(_6d){return _6d;});},escapeString:function(str){var _6e=str.split(/\r\n|\n/),out=[];for(var i=0;i<_6e.length;++i){dom.text(_c,_6e[i]);out.push(_c.innerHTML);}return out.join("\n");},unescapeString:function(str){return str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,"\"").replace(/&amp;/g,"&");},getCss:function(_6f,doc,_70){doc=doc||document;var _71=doc.getElementsByTagName("link"),re=new RegExp(mx.appUrl+_6f);for(var i=0,_72;_72=_71[i];i++){if(re.test(_72.href)){return _72;}}return null;},addCss:function(_73,doc,_74){doc=doc||document;if(dom.getCss(_73,doc,_74)){return;}var _75=doc.getElementsByTagName("head")[0],_76=dom.create("link",{rel:"stylesheet",type:"text/css",media:_74||"screen",href:mx.appUrl+_73});_75.appendChild(_76);},removeCss:function(_77,doc,_78){var _79=dom.getCss(_77,doc,_78);if(_79){_79.parentNode.removeChild(_79);return true;}return false;},ieFocusable:{"a":true,"body":true,"button":true,"frame":true,"iframe":true,"input":true,"isIndex":true,"object":true,"select":true,"textarea":true},getTabIndex:function(_7a){if(!_7a||!_7a.getAttribute){return null;}var _7b;if(_1("ie")||_1("trident")){_7b=_7a.tabIndex;if(_7b===0){var _7c=_7a.nodeName.toLowerCase(),_7d=_7a.attributes.tabIndex,_7e=_7d&&_7d.specified===true;return _7e||dom.ieFocusable[_7c]?"0":null;}else{return ""+_7b;}}else{var _7f=_7a.getAttribute("tabindex");_7b=String(_7a.tabIndex);if(_7f!=null||_7b>=0){if(!_1("ff")){return (_7f==="")?null:_7b;}else{return _7b;}}else{return null;}}},getFocusIndex:function(_80){var _81=dom.getTabIndex(_80);return _81>=0?_81:null;},coords:function(_82){return _2.mixin(_7.position(_82),_7.getMarginBox(_82));},data:_d(),getScopedData:_d,moveIntoView:function(_83,_84){_84=_84||0;var pos=_7.position(_83),_85=_9.getBox(),_86=_83.style,_87=pos.y+pos.h+_84,_88=pos.x+pos.w+_84;if(pos.y<_84||pos.h+_84*2>_85.h){_86.top=_84+"px";}else{if(_87>_85.h){_86.top=pos.y-(_87-_85.h)+"px";}}if(pos.x<_84||pos.w+_84*2>_85.w){_86.left=_84+"px";}else{if(_88>_85.w){_86.left=pos.x-(_88-_85.w)+"px";}}},getNodeExtents:function(_89){var cs=_8.getComputedStyle(_89),me=_7.getMarginExtents(_89,cs),be=_7.getBorderExtents(_89,cs),pe=_7.getPadExtents(_89,cs);return {w:me.w+be.w+pe.w,h:me.h+be.h+pe.h};}};return dom;});