/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/lib/form/ContentForm",["mxui/lib/pageTemplating/pageProvider","mxui/lib/pageTemplating/pageComponentComposer","mxui/lib/incubator","mxui/lib/form/_FormBase","mxui/wm/focus","mxui/widget","mxui/dom","mendix/lang","mendix/lib/NavigationError","dojo/Deferred","dojo/promise/all","dojo/dom-class","dojo/_base/array","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){"use strict";var $=_7.create;function _10(_11,_12){var _13=_11.findPlaceholder(_12);var _14=_3.conceiveSuccessor(_13);_11.appendTo(_14);return _14;};var _15=_f(_4,{_currentLayouts:null,_pendingRequest:null,widgetTemplates:null,constructor:function(){this.widgetTemplates={};this._currentLayouts=[];this.place="content";this.id="ContentForm";this.domNode=$("div",{"class":"mx-page"},$("div",{"class":"mx-placeholder","data-mx-placeholder":"main"}));},_updatePropertiesFrom:function(_16,_17){this.id=_16.id;this.path=_16.path;this.title=_17||_16.title;this._currentLayouts=_16.layouts;this.domNode.className="mx-page "+_16["class"];this.domNode.style.cssText=_16.style||"";},navigateTo:function(_18,_19,_1a,_1b,_1c,_1d,_1e){var _1f=this,_20=[];if(this._pendingRequest){this._pendingRequest.cancel(new _9("Loading of a page has been superseded by request for "+_18));}this._pendingRequest=(function(){var _21=new _a();_1.get(_18,_21.resolve,_21.reject);return _21;})().then(function(_22){var _23=new _a();_2.composeNewComponentsIn(_22,_1f._currentLayouts,_23.resolve,_23.reject);return _23;}).then(function(_24){_20=_8.map(_24.components,function(_25){return _10(_25,_1f.domNode);});_1f.widgetTemplates=_e.mixin(_1f.widgetTemplates,_24.widgetTemplates);_1f.viewState=_1c;_1b=_e.mixin({},_1b,{mxform:_1f});return _b(_8.map(_20,function(_26){var _27=new _a();_6.loadWidgetsIn(_26,_1b,_1a,_27.resolve);return _27;})).then(function(){return _24;});}).then(function(_28){_1f._updatePropertiesFrom(_28,_19);_8.forEach(_20,function(_29){_3.hatch(_29);_7.scrollOverflowParentTo(_29,0);},this);_1f.onNavigation();_1f.resize();if(!_5.get()){_5.first(_1f.domNode);}_1f._pendingRequest=null;if(_1d){_1d();}}).otherwise(function(e){_8.forEach(_20,function(_2a){_3.abort(_2a);});_1e?_1e(e):window.mx.onError(e);});},resize:function(){this.domNode.style.height="100%";_6.resizeWidgetsIn(this.domNode);this.domNode.style.height="";},onNavigation:function(){}});return _15;});