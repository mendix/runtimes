/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/lib/form/ContentForm",["mxui/lib/pageTemplating/pageProvider","mxui/lib/pageTemplating/pageComponentComposer","mxui/lib/incubator","mxui/lib/form/_FormBase","mxui/wm/focus","mxui/widget","mxui/dom","mendix/lang","mendix/lib/NavigationError","dojo/Deferred","dojo/promise/all","dojo/dom-class","dojo/_base/array","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){"use strict";var $=_7.create;function _10(_11,_12){var _13=_11.findPlaceholder(_12);var _14=_3.conceiveSuccessor(_13);_11.appendTo(_14);return _14;};var _15=_f(_4,{_currentLayouts:null,_pendingRequest:null,widgetTemplates:null,constructor:function(){this.widgetTemplates={};this._currentLayouts=[];this.place="content";this.id="ContentForm";this.domNode=$("div",{"class":"mx-page"},$("div",{"class":"mx-placeholder","data-mx-placeholder":"main"}));},_updatePropertiesFrom:function(_16,_17,_18){this._context=_17;this.id=_16.id;this.path=_16.path;this.title=_18||_16.title;this._currentLayouts=_16.layouts;this.domNode.className="mx-page "+_16["class"];this.domNode.style.cssText=_16.style||"";},navigateTo:function(_19,_1a,_1b,_1c,_1d,_1e,_1f){var _20=this,_21=[];if(this._pendingRequest){this._pendingRequest.cancel(new _9("Loading of a page has been superseded by request for "+_19));}this._pendingRequest=(function(){var _22=new _a();_1.get(_19,_22.resolve,_22.reject);return _22;})().then(function(_23){var _24=new _a();_2.composeNewComponentsIn(_23,_20._currentLayouts,_24.resolve,_24.reject);return _24;}).then(function(_25){_21=_8.map(_25.components,function(_26){return _10(_26,_20.domNode);});_20.widgetTemplates=_e.mixin(_20.widgetTemplates,_25.widgetTemplates);_20.viewState=_1d;_1c=_e.mixin({},_1c,{mxform:_20});return _b(_8.map(_21,function(_27){var _28=new _a();_6.loadWidgetsIn(_27,_1c,_1b,_28.resolve);return _28;})).then(function(){return _25;});}).then(function(_29){_20._updatePropertiesFrom(_29,_1b,_1a);_8.forEach(_21,function(_2a){_3.hatch(_2a);_7.scrollOverflowParentTo(_2a,0);},this);_20.onNavigation();_20.resize();if(!_5.get()){_5.first(_20.domNode);}_20._pendingRequest=null;if(_1e){_1e();}}).otherwise(function(e){_8.forEach(_21,function(_2b){_3.abort(_2b);});_1f?_1f(e):window.mx.onError(e);});},resize:function(){this.domNode.style.height="100%";_6.resizeWidgetsIn(this.domNode);this.domNode.style.height="";},onNavigation:function(){}});return _15;});