/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/lib/form/ContentForm",["mxui/lib/pageTemplating/pageProvider","mxui/lib/pageTemplating/pageComponentComposer","mxui/lib/incubator","mxui/lib/form/_FormBase","mxui/wm/focus","mxui/widget","mxui/dom","mendix/lang","mendix/lib/NavigationError","dojo/Deferred","dojo/promise/all","dojo/dom-class","dojo/_base/array","dojo/_base/lang","dojo/_base/declare"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){var $=_7.create;function _10(_11,_12){var _13=_11.findPlaceholder(_12);var _14=_3.conceiveSuccessor(_13);_11.appendTo(_14);return _14;};var _15=_f(_4,{_currentLayouts:null,_pendingRequest:null,widgetTemplates:null,constructor:function(){this._currentLayouts=[];this.place="content";this.id="ContentForm";this.domNode=$("div",{"class":"mx-page"},$("div",{"class":"mx-placeholder","data-mx-placeholder":"main"}));},_updatePropertiesFrom:function(_16,_17,_18,_19){this._context=_17;this.id=_16.id;this.path=_16.path;this.hash=_8.getUniqueId();this.title=_19||_16.title;this.url=_16.url;this.widgetTemplates=_16.widgetTemplates;this.viewState=_18;this.onLoading();},navigateTo:function(_1a,_1b,_1c,_1d,_1e,_1f,_20){var _21=this,_22=[];if(this._pendingRequest){this._pendingRequest.cancel(new _9("Loading of a page has been superseded by request for "+_1a));}this._pendingRequest=(function(){var _23=new _a();_1.get(_1a,_23.resolve,_23.reject);return _23;})().then(function(_24){var _25=new _a();_2.composeNewComponentsIn(_24,_21._currentLayouts,_25.resolve,_25.reject);return _25;}).then(function(_26){_22=_8.map(_26.components,function(_27){return _10(_27,_21.domNode);});_21._updatePropertiesFrom(_26,_1c,_1e,_1b);_1d=_e.mixin({},_1d,{mxform:_21});return _b(_8.map(_22,function(_28){var _29=new _a();_6.loadWidgetsIn(_28,_1d,_1c,_29.resolve);return _29;})).then(function(){return _26;});}).then(function(_2a){_21._currentLayouts=_2a.layouts;_21.domNode.className="mx-page "+_2a["class"];_21.domNode.style.cssText=_2a.style||"";_8.forEach(_22,function(_2b){_3.hatch(_2b);_7.scrollOverflowParentTo(_2b,0);});_21.onNavigation();_21.resize(true);if(!_5.get()){_5.first(_21.domNode);}_21._pendingRequest=null;if(_1f){_1f();}}).otherwise(function(e){_8.forEach(_22,function(_2c){_3.abort(_2c);});_20?_20(e):window.mx.onError(e);});},resize:function(_2d){if(_2d||!this._pendingRequest){this.inherited(arguments);}},onResize:function(){this.domNode.style.height="100%";_6.resizeWidgetsIn(this.domNode);this.domNode.style.height="";},onLoading:function(){}});return _15;});