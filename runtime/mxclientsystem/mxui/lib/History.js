
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/lib/History",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.lib.History");mxui.lib.History=function(){var _4=this,_5="mxui.lib.History",_6=0,_7=[],_8={},_9=null;var _a=function(_b){if(_1.config.isDebug){_b=_b.substr(_b.lastIndexOf(";")+1);}if(_b!=_7[_6]){var _c;if(_b==_7[_6+1]){_c=-1;_6++;}else{if(_b==_7[_6-1]){_c=1;_6--;}else{if(_6<_7.length){_6++;var _d=mxui.currentForm;if(_d){_1.addClass(_d.domNode,"mx-page-hidden");mxui.currentForm=null;}}return;}}var _e=_8[_b];if(_e){mx.ui.openForm(_e.path,{dir:_c,context:_e.context,instance:_e.form});}}};this.startup=function(){_9=_1.subscribe("/dojo/hashchange",_a);};this.exists=function(){return _6<_7.length;};this.back=function(){window.history.back();};this.register=function(_f){var _10=_f.hash;_8[_10]={form:_f,type:"form",path:_f.path,context:_f.context};for(var i=_6-1;i>=0;i--){var _11=_7[i],_12=_8[_11].form;delete _8[_11];_12.destroy();}_7=_7.slice(_6);_7.unshift(_10);_6=0;if(_1.config.isDebug){_1.hash(mx.ui.encodeUrlHash(_f.path,_f.context,_10));}else{_1.hash(_10);}};this.getForm=function(_13){return _8[_13];};this.destroy=function(){for(var _14 in _8){_8[_14].form.destroy();}if(_9){_1.unsubscribe(_9);_9=null;}_6=0;_7=[];_8={};};};});