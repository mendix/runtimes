
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/lib/Resizable",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.lib.Resizable");_1.declare("mxui.lib.Resizable",null,{node:null,margin:0,resizer:null,minWidth:0,minHeight:0,_events:null,_start:null,_resizing:false,constructor:function(_4,_5){_5=_5||{};this.node=_4;this.margin=_5.margin||0;this.resizer=_5.resizer;this.minWidth=_5.minWidth||0;this.minHeight=_5.minHeight||0;var $=mxui.dom.create,_6=$("#"),_7=["n","e","s","w","ne","se","sw","nw"];for(var i=0,_8;_8=_7[i];i++){var _9=$("div",{"class":"mx-resizer mx-resizer-"+_8,"data-resize-dir":_8});_1.setSelectable(_9,false);_6.appendChild(_9);}_4.appendChild(_6);this._events=[];this.reset();},reset:function(){this.clean();var _a=this;this._events=[_1.on(this.node,_1.touch.press,function(e){var _b=e.target.getAttribute("data-resize-dir");if(_b){_a.onMouseDown(_b,e);}})];},clean:function(){while(this._events.length){this._events.pop().remove();}},onMouseDown:function(_c,e){this.onResizeStart(e);this.clean();this._start={box:_1.marginBox(this.node),viewport:_2.getViewport(),pageX:e.pageX,pageY:e.pageY};this._events.push(_1.on(document,_1.touch.move,_1.hitch(this,"onMouseMove",_c)),_1.on(document,_1.touch.release,_1.hitch(this,"onMouseUp")));_1.stopEvent(e);},onMouseMove:function(_d,e){var _e=this._start,_f=_e.box,_10=this.margin,_11={};if(/e|w/.test(_d)){var _12=/w/.test(_d),_13=_12?_e.pageX-e.pageX:e.pageX-_e.pageX,_14=(_12?_f.l+_f.w:_e.viewport.w-_f.l)-_10;_11.w=Math.max(this.minWidth,Math.min(_14,_f.w+_13));if(_12){_11.l=Math.max(_10,_f.l+_f.w-_11.w);}}if(/n|s/.test(_d)){var _15=/n/.test(_d),_16=_15?_e.pageY-e.pageY:e.pageY-_e.pageY,_17=(_15?_f.t+_f.h:_e.viewport.h-_f.t)-_10;_11.h=Math.max(this.minHeight,Math.min(_17,_f.h+_16));if(_15){_11.t=Math.max(_10,_f.t+_f.h-_11.h);}}if(this.resizer){this.resizer(_11);}else{_1.marginBox(this.node,_11);}this.onResizing();_1.stopEvent(e);},onMouseUp:function(e){this.onResizeStop(e);this.reset();},onResizeStart:function(e){this._resizing=true;},onResizing:function(e){},onResizeStop:function(e){this._resizing=false;},destroy:function(){this.clean();}});});