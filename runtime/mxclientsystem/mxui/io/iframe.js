/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/io/iframe",["mendix/lib/DescribedServerError","mendix/lib/Error","mendix/lang","mendix/logger","dojo/sniff","dojo/request/iframe","dojo/dom-style","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9={name:"mxui.io.iframe",send:function(_a){var _b=function(){if(_5("ie")||_5("trident")){return true;}if(_5("opera")){return _5("opera")<10;}if(_5("chrome")){if(typeof window.externalHost!=="undefined"){return false;}return _5("chrome")<16;}return false;};if(_b()){var _c=_a.handle;_a.handle=function(_d){window.history.back();var _e=function(){_c(_d);};setTimeout(_e,50);};}_a.handleAs="json";var _f=_a.handle;delete _a.handle;var _10=_6("",_a);_10.always(function(_11){if(!_5("ie")&&!_5("trident")){var _12=_6._frame;_12.parentNode.removeChild(_12);_6._frame=null;window[_6._iframeName]=null;}var _13;if(_11 instanceof Error){_13=new _2(_11.message);_4.error(this.name+".send: An error occurred while uploading a file: the server did not respond");}else{if(_11.type&&_11.type==="exception"){_13=new _1(_11.description);_13._type="exception";_4.error(this.name+".send: "+_13.message);}}if(_f){_f(_13);}});},download:function(_14){var _15=_14.target||"internal",url=_14.url+"&target="+_15;if(!this._iframe){var _16=this._iframe=document.createElement(mx.ui.isQuirky?"<iframe onload=\"mxui.io.iframe.onload()\">":"iframe");_7.set(_16,{top:"-10px",height:"1px",position:"absolute",visibility:"hidden"});document.body.appendChild(_16);if(!mx.ui.isQuirky){_16.onload=_8.hitch(this,"onload");}}this._error=_14.error;this._iframe.contentWindow.location=url;},onload:function(){var _17=this._iframe,_18=this._error,doc=_17.contentDocument||_17.document,err=_3.getFileError(doc,this.name+".onload");if(err&&_18){_18(err);}delete this._error;}};return _9;});