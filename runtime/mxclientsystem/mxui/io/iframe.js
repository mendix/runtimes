/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/io/iframe",["mendix/lib/DescribedServerError","mendix/lib/Error","mendix/lang","mendix/logger","dojo/sniff","dojo/request/iframe","dojo/dom-style","dojo/_base/lang"],function(_1,_2,_3,_4,_5,_6,_7,_8){var _9=_5("ie")&&(_5("quirks")||_5("ie")<9);var _a={name:"mxui.io.iframe",send:function(_b){var _c=function(){if(_5("ie")||_5("trident")){return true;}if(_5("opera")){return _5("opera")<10;}if(_5("chrome")){if(typeof window.externalHost!=="undefined"){return false;}return _5("chrome")<16;}return false;};if(_c()){var _d=_b.handle;_b.handle=function(_e){window.history.back();var _f=function(){_d(_e);};setTimeout(_f,50);};}_b.handleAs="json";var _10=_b.handle;delete _b.handle;var _11=_6("",_b);_11.always(function(_12){if(!_5("ie")&&!_5("trident")){var _13=_6._frame;_13.parentNode.removeChild(_13);_6._frame=null;window[_6._iframeName]=null;}var _14;if(_12 instanceof Error){_14=new _2(_12.message);_4.error(this.name+".send: An error occurred while uploading a file: the server did not respond");}else{if(_12.type&&_12.type==="exception"){_14=new _1(_12.description);_14._type="exception";_4.error(this.name+".send: "+_14.message);}}if(_10){_10(_14);}});},download:function(_15){if(!this._iframe){var _16=this._iframe=document.createElement(_9?"<iframe onload=\"mxui.io.iframe.onload()\">":"iframe");_7.set(_16,{top:"-10px",height:"1px",position:"absolute",visibility:"hidden"});document.body.appendChild(_16);if(!_9){_16.onload=_8.hitch(this,"onload");}}this._error=_15.error;this._iframe.contentWindow.location=_15.url;},onload:function(){var _17=this._iframe,_18=this._error,doc=_17.contentDocument||_17.document,err=_3.getFileError(doc,this.name+".onload");if(err&&_18){_18(err);}delete this._error;}};return _a;});