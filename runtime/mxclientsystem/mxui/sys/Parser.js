/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/sys/Parser",["mendix/logger","big/big","dojo/i18n","dojo/date/locale","dojo/_base/lang"],function(_1,_2,_3,_4,_5){var _6="mxui.sys.Parser";var _7=function(_8,_9){_8.setFullYear(_9.getFullYear(),_9.getMonth(),_9.getDate());};var _a=function(_b,_c){_b.setHours(_c.getHours(),_c.getMinutes(),_c.getSeconds(),_c.getMilliseconds());};var _d=function(_e,_f,_10){return _10.dateLocale.format(new _10.Date(_e),_f);};var _11=function(_12,_13,_14){var _15=_14.dateLocale.parse(_12,_13);if(_15&&_15.toGregorian){_15=_15.toGregorian();}if(!_15){if(_12.indexOf("‚Äè")==-1){if(!_13.datePattern){_13.datePattern=_14.datePattern;}_13.datePattern=_13.datePattern.replace(/\u200f/g,"");_15=_4.parse(_12,_13);}}return _15;};function _16(_17,_18){return new Array(_18+1).join(_17);};function _19(str,_1a,_1b){return str.length<_1b?str+_16(_1a,_1b-str.length):str;};function _1c(_1d,_1e,_1f){var _20={name:_1d,decimalSeparator:_1e.decimal,groupSeparator:_1e.group,groupSize:3,datePattern:_1f["dateFormat-short"]};var _21="\\d+"+"|"+"\\d"+_16("\\d?",_20.groupSize-1)+"(?:\\"+_20.groupSeparator+_16("\\d",_20.groupSize)+")*",_22="\\"+_20.decimalSeparator+"\\d+",_23="^"+"(-)?"+"("+_21+")"+"("+_22+")?"+"$";_20.numberPattern=new RegExp(_23);var _24=_5.getObject(window.mx.ui.getDatePackage());_20.dateLocale=_24.locale||_4;_20.Date=_24.Date||Date;return _20;};function _25(_26,_27,_28,_29){var _2a=_28>=0?_26.round(_28):_26,_2b=_2a.lt(0),_2c=_2a.toFixed().split("."),_2d=_2b?_2c[0].slice(1):_2c[0],_2e=_2c[1],_2f=_2d,_30=_2e;if(_28>=0){_30=_19(_2e||"","0",_28);}if(_27){var i=_2d.length%_29.groupSize||_29.groupSize;_2f=_2d.substr(0,i);for(;i<_2d.length;i+=_29.groupSize){_2f+=_29.groupSeparator+_2d.substr(i,_29.groupSize);}}return (_2b?"-":"")+_2f+(_30?_29.decimalSeparator+_30:"");};function _31(_32,_33,_34){var _35=_34.numberPattern.exec(_32);if(!_35){return null;}var _36=new _2(_32.split(_34.groupSeparator).join("").split(_34.decimalSeparator).join("."));return _33>=0?_36.round(_33):_36;};function _37(){var _38=this,_39;this.toString=function(){return _6;};this.startup=function(_3a){require([_3.getL10nName("dojo.cldr","number",window.dojo.locale),_3.getL10nName("dojo.cldr","gregorian",window.dojo.locale)],function(_3b,_3c){_39=_1c(window.dojo.locale,_3b,_3c);if(_3a){_3a();}});};this.parseDate=function(_3d,_3e){if(!_3d){return null;}_3e=_3e||{};var _3f={selector:_3e.selector||"date",formatLength:_3e.format||"short",datePattern:_3e.datepattern||_3e.datePattern,timePattern:_3e.timePattern};var _40=_11(_3d,_3f,_39);if(_40){if(_3f.selector=="time"){var now=new Date();now.setMilliseconds(_40.getMilliseconds());now.setSeconds(_40.getSeconds());now.setMinutes(_40.getMinutes());now.setHours(_40.getHours());return +now;}}return _40&&_40.getTime();};this.formatDate=function(_41,_42){var _43=Number(_41);if(_41===""){return _41;}else{if(isNaN(_43)){return null;}}_42=_42||{};var _44=new Date(_43),_45={locale:_39.name,selector:_42.selector||"date",formatLength:_42.format||"short",datePattern:_42.datepattern||_42.datePattern,timePattern:_42.timePattern};if(_45.selector=="time"){var now=new Date(0);now.setMilliseconds(_44.getMilliseconds());now.setSeconds(_44.getSeconds());now.setMinutes(_44.getMinutes());now.setHours(_44.getHours());_44=now;}return _d(_44,_45,_39);};this.formatValue=function(_46,_47,_48){_48=_48||{};if(_46===""){return "";}switch(_47.toLowerCase()){case "decimal":case "float":return _25(new _2(_46),!!_48.groups,"places" in _48&&_48.places>=0?_48.places:-1,_39);case "currency":return _25(new _2(_46),!!_48.groups,"places" in _48&&_48.places>=0?_48.places:2,_39);case "autonumber":case "integer":case "long":return _25(new _2(_46),!!_48.groups,_48.places||0,_39);case "datetime":return _d(new Date(_46),_5.mixin({selector:"date"},_48),_39);case "boolean":return mx.ui.translate("mxui.common",_46);default:return _46;}};this.formatAttribute=function(obj,_49,_4a){var _4b=obj.getAttributeType(_49),_4c=obj.get2(_49);if(_4b=="Enum"){_4c=obj.getEnumCaption(_49,_4c);}return _38.formatValue(_4c,_4b,_4a);};this.parseValue2=function(_4d,_4e,_4f){_4f=_4f||{};if(_4d===""){return "";}switch(_4e.toLowerCase()){case "float":case "currency":case "integer":case "long":case "decimal":return _31(_4d,_4f.places,_39);case "datetime":return _11(_4d,_5.mixin({selector:"date"},_4f),_39);case "enum":return _4d;case "boolean":return _4d==mx.ui.translate("mxui.common",true);default:return _4d;}};this.localizeEpoch=function(_50){var obj=new Date(Number(_50));return new Date(obj.getUTCFullYear(),obj.getUTCMonth(),obj.getUTCDate(),obj.getUTCHours(),obj.getUTCMinutes(),obj.getUTCSeconds(),obj.getUTCMilliseconds()).getTime();};this.delocalizeEpoch=function(_51){var obj=new Date(Number(_51));return Date.UTC(obj.getFullYear(),obj.getMonth(),obj.getDate(),obj.getHours(),obj.getMinutes(),obj.getSeconds(),obj.getMilliseconds());};this.mergeDates=function(_52,_53,_54){var _55=new Date(_52);switch(_54){case "date":_7(_55,_53);break;case "time":_a(_55,_53);break;case "datetime":_7(_55,_53);_a(_55,_53);break;default:_55=_53;}return _55;};this.replaceXPathTokens=function(_56,_57){if(_57&&_57.hasTrackId()){_56=_56.replace(/\[%CurrentObject%\]/g,_57.getTrackId());}else{if(/\[%CurrentObject%\]/.test(_56)){}}return _56;};};return _37;});