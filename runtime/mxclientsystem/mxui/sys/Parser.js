
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/sys/Parser",["mendix/logger","dojo/i18n","dojo/date/locale","dojo/number","dojo/_base/lang"],function(_1,_2,_3,_4,_5){var _6="mxui.sys.Parser",_7=false;var _8=function(_9,_a){_9.setFullYear(_a.getFullYear(),_a.getMonth(),_a.getDate());};var _b=function(_c,_d){_c.setHours(_d.getHours(),_d.getMinutes(),_d.getSeconds(),_d.getMilliseconds());};var _e=function(_f,_10){var _11=_5.getObject(window.mx.ui.getDatePackage());return _11.locale.format(_11.Date?new _11.Date(_f):_f,_10);};var _12=function(_13,_14){var _15=_5.getObject(window.mx.ui.getDatePackage()),_16;if(_15.Date){_16=_15.locale.parse(_13,_14);if(_16){_16=_16.toGregorian();}}else{_16=_3.parse(_13,_14);}if(!_16){if(_13.indexOf("‚Äè")==-1){if(!_14.datePattern){var _17=_3._getGregorianBundle(window.dojo.locale);_14.datePattern=_17["dateFormat-short"];}_14.datePattern=_14.datePattern.replace(/\u200f/g,"");_16=_3.parse(_13,_14);}}return _16;};function _18(){var _19=this;this.toString=function(){return _6;};this.startup=function(_1a){_7=true;_1a();};this.shutdown=function(){_7=false;};this.isLoaded=function(){return _7;};this.parseDate=function(_1b,_1c){if(!_1b){return null;}_1c=_1c||{};var _1d={selector:_1c.selector||"date",formatLength:_1c.format||"short",datePattern:_1c.datepattern||_1c.datePattern,timePattern:_1c.timePattern};var _1e=_12(_1b,_1d);if(_1e){if(_1d.selector=="time"){var now=new Date();now.setMilliseconds(_1e.getMilliseconds());now.setSeconds(_1e.getSeconds());now.setMinutes(_1e.getMinutes());now.setHours(_1e.getHours());return +now;}}return _1e&&_1e.getTime();};this.formatDate=function(_1f,_20){var _21=Number(_1f);if(_1f===""){return _1f;}else{if(isNaN(_21)){return null;}}_20=_20||{};var _22=new Date(_21),_23={locale:window.dojo.locale,selector:_20.selector||"date",formatLength:_20.format||"short",datePattern:_20.datepattern||_20.datePattern,timePattern:_20.timePattern};if(_23.selector=="time"){var now=new Date(0);now.setMilliseconds(_22.getMilliseconds());now.setSeconds(_22.getSeconds());now.setMinutes(_22.getMinutes());now.setHours(_22.getHours());_22=now;}return _e(_22,_23);};this.parseNumber=function(_24,_25){var _26=_4.parse(_24);if(_25!=undefined){_26=_4.round(_26,_25);}return _26;};this.formatNumber=function(_27,_28,_29){var _2a={groups:_28,places:_29};if(!_28){var _2b=dojo.i18n.getLocalization("dojo.cldr","number",dojo.locale);_2a.pattern=_2b["decimalFormat"].replace(/,/g,"");}return _4.format(_27,_2a);};this.formatValue=function(_2c,_2d,_2e){_2e=_2e||{};if(_2c===""){return "";}switch(_2d.toLowerCase()){case "float":return this.formatNumber(_2c,_2e.groups,_2e.places);case "currency":var _2f="places" in _2e?_2e.places:2;return this.formatNumber(_2c,_2e.groups,_2f);case "autonumber":case "integer":case "long":return this.formatNumber(_2c,_2e.groups,_2e.places||0);case "datetime":return _e(new Date(_2c),dojo.mixin({selector:"date"},_2e));case "boolean":return mx.ui.translate("mxui.common",_2c);default:return _2c;}};this.formatAttribute=function(obj,_30,_31){var _32=obj.getAttributeType(_30),_33=obj.get(_30);if(_32=="Enum"){_33=obj.getEnumCaption(_30,_33);}return _19.formatValue(_33,_32,_31);};this.parseValue=function(_34,_35,_36){_36=_36||{};if(_34===""){return "";}switch(_35.toLowerCase()){case "float":case "currency":case "autonumber":case "integer":case "long":return this.parseNumber(_34,_36.places);case "datetime":return _12(_34,dojo.mixin({selector:"date"},_36));case "enum":return _34;case "boolean":return _34==mx.ui.translate("mxui.common",true);default:result=_34;}};this.localizeEpoch=function(_37){var obj=new Date(Number(_37));return new Date(obj.getUTCFullYear(),obj.getUTCMonth(),obj.getUTCDate(),obj.getUTCHours(),obj.getUTCMinutes(),obj.getUTCSeconds(),obj.getUTCMilliseconds()).getTime();};this.delocalizeEpoch=function(_38){var obj=new Date(Number(_38));return Date.UTC(obj.getFullYear(),obj.getMonth(),obj.getDate(),obj.getHours(),obj.getMinutes(),obj.getSeconds(),obj.getMilliseconds());};this.mergeDates=function(_39,_3a,_3b){var _3c=new Date(_39);switch(_3b){case "date":_8(_3c,_3a);break;case "time":_b(_3c,_3a);break;case "datetime":_8(_3c,_3a);_b(_3c,_3a);break;default:_3c=_3a;}return _3c;};this.replaceXPathTokens=function(_3d,_3e){if(_3e&&_3e.hasTrackId()){_3d=_3d.replace(/\[%CurrentObject%\]/g,_3e.getTrackId());}else{if(/\[%CurrentObject%\]/.test(_3d)){}}return _3d;};};return _18;});