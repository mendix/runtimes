
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/sys/Parser",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.sys.Parser");mxui.sys.Parser=function(_4){_4=_4||{};var _5=this,_6="mxui.sys.Parser",_7=false;var _8=function(_9,_a){_a=_a||{};if(!_a.groups){var _b=_1.i18n.getLocalization("dojo.cldr","number",_1.locale);_a.pattern=_b["decimalFormat"].replace(/,/g,"");}return _1.number.format(_9,_a);};var _c=function(_d,_e){_d.setFullYear(_e.getFullYear(),_e.getMonth(),_e.getDate());};var _f=function(_10,_11){_10.setHours(_11.getHours(),_11.getMinutes(),_11.getSeconds(),_11.getMilliseconds());};var _12=function(_13,_14){var _15=_1.getObject(mx.ui.getDatePackage());return _15.locale.format(_15.Date?new _15.Date(_13):_13,_14);};var _16=function(_17,_18){var _19=_1.getObject(mx.ui.getDatePackage()),_1a;if(_19.Date){_1a=_19.locale.parse(_17,_18);if(_1a){_1a=_1a.toGregorian();}}else{_1a=_1.date.locale.parse(_17,_18);}if(!_1a){if(_17.indexOf("‚Äè")==-1){if(!_18.datePattern){var _1b=_1.date.locale._getGregorianBundle(_1.locale);_18.datePattern=_1b["dateFormat-short"];}_18.datePattern=_18.datePattern.replace(/\u200f/g,"");_1a=_1.date.locale.parse(_17,_18);}}return _1a;};this.toString=function(){return _6;};this.startup=function(_1c){_7=true;_1c();};this.shutdown=function(){_7=false;};this.isLoaded=function(){return _7;};this.parseDate=function(_1d,_1e){if(!_1d){return null;}_1e=_1e||{};var _1f={selector:_1e.selector||"date",formatLength:_1e.format||"short",datePattern:_1e.datepattern||_1e.datePattern,timePattern:_1e.timePattern};var _20=_16(_1d,_1f);if(_20){if(_1f.selector=="time"){var now=new Date();now.setMilliseconds(_20.getMilliseconds());now.setSeconds(_20.getSeconds());now.setMinutes(_20.getMinutes());now.setHours(_20.getHours());return +now;}}return _20&&_20.getTime();};this.formatDate=function(_21,_22){var _23=Number(_21);if(_21===""){return _21;}else{if(isNaN(_23)){return null;}}_22=_22||{};var _24=new Date(_23),_25={locale:_1.locale,selector:_22.selector||"date",formatLength:_22.format||"short",datePattern:_22.datepattern||_22.datePattern,timePattern:_22.timePattern};if(_25.selector=="time"){var now=new Date(0);now.setMilliseconds(_24.getMilliseconds());now.setSeconds(_24.getSeconds());now.setMinutes(_24.getMinutes());now.setHours(_24.getHours());_24=now;}return _12(_24,_25);};this.parseNumber=function(_26,_27,_28){if(!_26){return NaN;}return _1.number.parse(_26,{places:_28,groups:_27});};this.formatNumber=function(_29,_2a,_2b){if(_29===""){return _29;}else{if(isNaN(_29)||Math.abs(_29)==Infinity){return null;}}if(_1.isString(_2b)){_2b=parseInt(_2b,10);}return _8(_29,{places:_2b,groups:_2a});};this.formatValue=function(_2c,_2d,_2e){var _2f;if(_2c===""){return "";}switch(_2d.toLowerCase()){case "float":_2f=_8(_2c,_2e);break;case "currency":_2f=_8(_2c,_1.mixin({places:2},_2e));break;case "autonumber":case "integer":case "long":_2f=_8(_2c,_1.mixin({places:0},_2e));break;case "datetime":_2f=_12(new Date(_2c),_1.mixin({selector:"date"},_2e));break;case "boolean":_2f=mx.ui.translate("mxui.common",_2c);break;default:_2f=_2c;}return _2f;};this.formatAttribute=function(obj,_30,_31){var _32=obj.getAttributeType(_30),_33=obj.get(_30);if(_32=="Enum"){_33=obj.getEnumCaption(_30,_33);}return mx.parser.formatValue(_33,_32,_31);};this.parseValue=function(_34,_35,_36){var _37;if(_34===""){return "";}switch(_35.toLowerCase()){case "float":case "currency":case "autonumber":case "integer":case "long":_37=_1.number.parse(_34,_36);break;case "datetime":_37=_16(_34,_1.mixin({selector:"date"},_36));break;case "enum":_37=_34;break;case "boolean":_37=_34==mx.ui.translate("mxui.common",true);break;default:_37=_34;}return _37;};this.localizeEpoch=function(_38){var obj=new Date(Number(_38));return new Date(obj.getUTCFullYear(),obj.getUTCMonth(),obj.getUTCDate(),obj.getUTCHours(),obj.getUTCMinutes(),obj.getUTCSeconds(),obj.getUTCMilliseconds()).getTime();};this.delocalizeEpoch=function(_39){var obj=new Date(Number(_39));return Date.UTC(obj.getFullYear(),obj.getMonth(),obj.getDate(),obj.getHours(),obj.getMinutes(),obj.getSeconds(),obj.getMilliseconds());};this.mergeDates=function(_3a,_3b,_3c){var _3d=new Date(_3a);switch(_3c){case "date":_c(_3d,_3b);break;case "time":_f(_3d,_3b);break;case "datetime":_c(_3d,_3b);_f(_3d,_3b);break;default:_3d=_3b;}return _3d;};this.replaceXPathTokens=function(_3e,_3f){if(_3f&&_3f.hasTrackId()){_3e=_3e.replace(/\[%CurrentObject%\]/g,_3f.getTrackId());}else{if(/\[%CurrentObject%\]/.test(_3e)){}}return _3e;};};});