
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/sys/Parser",["mendix/logger","dojo/i18n","dojo/date/locale","dojo/number","dojo/_base/lang"],function(_1,_2,_3,_4,_5){var _6="mxui.sys.Parser",_7=false;var _8=function(_9,_a){_9.setFullYear(_a.getFullYear(),_a.getMonth(),_a.getDate());};var _b=function(_c,_d){_c.setHours(_d.getHours(),_d.getMinutes(),_d.getSeconds(),_d.getMilliseconds());};var _e=function(_f,_10){var _11=_5.getObject(window.mx.ui.getDatePackage());return _11.locale.format(_11.Date?new _11.Date(_f):_f,_10);};var _12=function(_13,_14){var _15=_5.getObject(window.mx.ui.getDatePackage()),_16;if(_15.Date){_16=_15.locale.parse(_13,_14);if(_16){_16=_16.toGregorian();}}else{_16=_3.parse(_13,_14);}if(!_16){if(_13.indexOf("‚Äè")==-1){if(!_14.datePattern){var _17=_3._getGregorianBundle(window.dojo.locale);_14.datePattern=_17["dateFormat-short"];}_14.datePattern=_14.datePattern.replace(/\u200f/g,"");_16=_3.parse(_13,_14);}}return _16;};function _18(){var _19=this;this.toString=function(){return _6;};this.startup=function(_1a){_7=true;_1a();};this.shutdown=function(){_7=false;};this.isLoaded=function(){return _7;};this.parseDate=function(_1b,_1c){if(!_1b){return null;}_1c=_1c||{};var _1d={selector:_1c.selector||"date",formatLength:_1c.format||"short",datePattern:_1c.datepattern||_1c.datePattern,timePattern:_1c.timePattern};var _1e=_12(_1b,_1d);if(_1e){if(_1d.selector=="time"){var now=new Date();now.setMilliseconds(_1e.getMilliseconds());now.setSeconds(_1e.getSeconds());now.setMinutes(_1e.getMinutes());now.setHours(_1e.getHours());return +now;}}return _1e&&_1e.getTime();};this.formatDate=function(_1f,_20){var _21=Number(_1f);if(_1f===""){return _1f;}else{if(isNaN(_21)){return null;}}_20=_20||{};var _22=new Date(_21),_23={locale:window.dojo.locale,selector:_20.selector||"date",formatLength:_20.format||"short",datePattern:_20.datepattern||_20.datePattern,timePattern:_20.timePattern};if(_23.selector=="time"){var now=new Date(0);now.setMilliseconds(_22.getMilliseconds());now.setSeconds(_22.getSeconds());now.setMinutes(_22.getMinutes());now.setHours(_22.getHours());_22=now;}return _e(_22,_23);};this.parseNumber=function(_24){return dojo.number.parse(_24);};this.formatNumber=function(_25,_26,_27){var _28={groups:_26,places:_27};if(!_26){var _29=dojo.i18n.getLocalization("dojo.cldr","number",dojo.locale);_28.pattern=_29["decimalFormat"].replace(/,/g,"");}return _4.format(_25,_28);};this.formatValue=function(_2a,_2b,_2c){_2c=_2c||{};if(_2a===""){return "";}switch(_2b.toLowerCase()){case "float":return this.formatNumber(_2a,_2c.groups,_2c.places);case "currency":var _2d="places" in _2c?_2c.places:2;return this.formatNumber(_2a,_2c.groups,_2d);case "autonumber":case "integer":case "long":return this.formatNumber(_2a,_2c.groups,_2c.places||0);case "datetime":return _e(new Date(_2a),dojo.mixin({selector:"date"},_2c));case "boolean":return mx.ui.translate("mxui.common",_2a);default:return _2a;}};this.formatAttribute=function(obj,_2e,_2f){var _30=obj.getAttributeType(_2e),_31=obj.get(_2e);if(_30=="Enum"){_31=obj.getEnumCaption(_2e,_31);}return _19.formatValue(_31,_30,_2f);};this.parseValue=function(_32,_33,_34){_34=_34||{};if(_32===""){return "";}switch(_33.toLowerCase()){case "float":case "currency":case "autonumber":case "integer":case "long":return this.parseNumber(_32);case "datetime":return _12(_32,dojo.mixin({selector:"date"},_34));case "enum":return _32;case "boolean":return _32==mx.ui.translate("mxui.common",true);default:result=_32;}};this.localizeEpoch=function(_35){var obj=new Date(Number(_35));return new Date(obj.getUTCFullYear(),obj.getUTCMonth(),obj.getUTCDate(),obj.getUTCHours(),obj.getUTCMinutes(),obj.getUTCSeconds(),obj.getUTCMilliseconds()).getTime();};this.delocalizeEpoch=function(_36){var obj=new Date(Number(_36));return Date.UTC(obj.getFullYear(),obj.getMonth(),obj.getDate(),obj.getHours(),obj.getMinutes(),obj.getSeconds(),obj.getMilliseconds());};this.mergeDates=function(_37,_38,_39){var _3a=new Date(_37);switch(_39){case "date":_8(_3a,_38);break;case "time":_b(_3a,_38);break;case "datetime":_8(_3a,_38);_b(_3a,_38);break;default:_3a=_38;}return _3a;};this.replaceXPathTokens=function(_3b,_3c){if(_3c&&_3c.hasTrackId()){_3b=_3b.replace(/\[%CurrentObject%\]/g,_3c.getTrackId());}else{if(/\[%CurrentObject%\]/.test(_3b)){}}return _3b;};};return _18;});