/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/sys/history",["mxui/lib/browserBackend"],function(_1){var _2=null;var _3={_queue:[],_process:function(){while(this._queue[0]){this._queue.shift().call();}},startPush:function(){this._queue.push(null);},endPush:function(){if(this._queue.length===0||this._queue[0]!==null){throw new Error("Invalid state of the queue");}this._queue.shift();this._process();},push:function(_4){this._queue.push(_4);this._process();},empty:function(){return this._queue.length==0;}};var _5={init:function(){_1.history.replaceState(null,"",_6());_1.history.onPopstate(function(e){_1.setTimeout(function(){_7(e.state);if(!_3.empty()){_3.endPush();}},0);});},back:function(){_3.startPush();_1.history.back();},forward:function(){_3.startPush();_1.history.forward();},push:function(_8){_3.push(function(){_1.history.pushState(_8,"",_6());_7(_8);});},onNavigation:function(){}};function _7(_9){if(_9!=null){_5.onNavigation(_2,_9);_2=_9;return;}_1.history.replaceState(_2,_1.getTitle(),_6()+_1.location.hash());};function _6(){return _1.location.pathname()+_1.location.search();};return _5;});