
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/compat",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.compat");(function(){var _4="6.0",_5=mendix.lang.deprecate;_5("mxui.dom",{removeElement:"orphan",setTextContent:"text",getTextContent:"text",textContent:"text"},_4);_5("mxui.dom","removeChildNodes","dojo","empty",_4);_5("mxui.dom","clearSelectOptions","dojo","empty",_4);_1.mixin(mxui.dom,{getAncestorClass:function(_6,_7,_8){_1.deprecated("mxui.dom.getAncestorClass","Use dojo.query instead",_4);return _6&&(_1.hasClass(_6,_7)?_6:((--_8==0)?false:arguments.callee(_6.parentNode,_7,_8)));},getElementsByTagNames:function(_9,_a){_1.deprecated("mxui.dom.getElementsByTagNames","Use dojo.query instead",_4);return _1.query(_a,_9);},getAncestorNodeWithAttribute:function(_b,_c,_d,_e){_1.deprecated("mxui.dom.getAncestorNodeWithAttribute","Use dojo.query instead",_4);return ((_b.nodeName==_c)&&(_b.getAttribute&&(_b.getAttribute(_d)!=null)))?_b:(--_e==0)?null:arguments.callee(_b.parentNode,_c,_d,_e);},setHTML:function(_f,str){_1.deprecated("mxui.dom.setHTML","Use mxui.dom.html instead",_4);mxui.dom.html(_f,str);},getSelectOptions:function(_10){_1.deprecated("mxui.dom.getSelectOptions","Use mxui.dom.getSelectedValue instead",_4);return [_10.options[_10.selectedIndex].value];},selectOption:function(_11,str){_1.deprecated("mxui.dom.selectOption","Use dojo.attr instead",_4);_11.value=str;},hasClass:function(_12,_13){_1.deprecated("mxui.dom.hasClass","Use dojo.hasClass instead",_4);return _1.hasClass(_12,_13);},getClass:function(_14){_1.deprecated("mxui.dom.getClass","Use dojo.getAttr instead",_4);return _14.className;},setClass:function(_15,str){_1.deprecated("mxui.dom.setClass","Use dojo.replaceClass instead",_4);_15.className=str;},addClass:function(_16,str){_1.deprecated("mxui.dom.addClass","Use dojo.addClass instead",_4);_1.addClass(_16,str);},addClasses:function(_17,_18){_1.deprecated("mxui.dom.addClasses","Use dojo.addClass instead",_4);_1.addClass(_17,_18);},removeClass:function(_19,str){_1.deprecated("mxui.dom.removeClass","Use dojo.removeClass instead",_4);_1.removeClass(_19,str);},hide:function(_1a){_1.deprecated("mxui.dom.hide","Use dojo.style instead",_4);_1a.style.display="none";},show:function(_1b){_1.deprecated("mxui.dom.show","Use dojo.style instead",_4);_1b.style.display="";},setReadOnly:function(_1c){_1.deprecated("mxui.dom.setReadOnly","Use dojo.setAttr instead",_4);return _1c.setAttribute("readonly","readonly");},unsetReadOnly:function(_1d){_1.deprecated("mxui.dom.unsetReadOnly","Use dojo.removeAttr instead",_4);return _1d.removeAttribute("readonly");},applyDisableStyle:function(_1e){_1.deprecated("mxui.dom.applyDisableStyle","Use dojo.setAttr instead",_4);var _1f=_1e.nodeName;if(_1f=="SELECT"||(_1f=="INPUT"&&_1e.type=="checkbox")){_1e.setAttribute("disabled","disabled");}else{if(_1f=="INPUT"||_1f=="TEXTAREA"||_1f=="BUTTON"){_1e.setAttribute("readonly","readonly");}}},applyEnableStyle:function(_20){_1.deprecated("mxui.dom.applyEnableStyle","Use dojo.removeAttr instead",_4);_20.removeAttribute("readonly");var _21=_20.nodeName.toLowerCase();if(_21=="select"||(_21=="input"&&_20.type=="checkbox")){_20.removeAttribute("disabled");}},setOpacity:function(_22,_23){_1.deprecated("mxui.dom.setOpacity","Use dojo.style instead",_4);_1.style(_22,"opacity",_23);},insertCss:function(_24,doc,_25){_1.deprecated("mxui.dom.insertCss","Use mxui.dom.addCss instead",_4);mxui.dom.addCss(_24,doc,_25);},escapeHTML:function(str){_1.deprecated("mxui.dom.escapeHTML","Use mxui.dom.escapeString instead",_4);return mxui.dom.escapeString(str);},getFormElementText:function(_26){_1.deprecated("mxui.dom.getFormElementText","Use dojo.getAttr instead",_4);if(_26.nodeName.toLowerCase()=="input"){return _26.value;}else{if(_26.nodeName.toLowerCase()=="select"){return _26.options[_26.selectedIndex].text;}}},getStringSize:function(str){_1.deprecated("mxui.dom.getStringSize","Use dojo.contentBox instead",_4);var _27=document.createElement("span");document.body.appendChild(_27);_27.innerHTML=(str==="")?"A":str;var _28=_27.offsetWidth+10;_27.parentNode.removeChild(_27);_27=null;return _28;},clone:function(_29){_1.deprecated("mxui.dom.clone","Use dojo.clone instead",_4);return _1.clone(_29);},getFirstElement:function(_2a){_1.deprecated("mxui.dom.getFirstElement","Use Element.children instead",_4);var _2b=_2a.children;return _2b.length===0?null:_2b[0];}});var _2c={};var _2d=function(_2e){if(_2e.target.match("MxApplication")){var _2f=_2e.param.contenturl,_30={};for(var x in _2e.param){_30[x]=_2e.param[x];}delete _30.contenturl;return {target:"Screen",params:{uilocation:"content",title:_2e.title,targetwidget:null,targeturl:_2f,targetparams:_30}};}else{if(_2e.uilocation){return {target:"Screen",params:{uilocation:_2e.uilocation,width:_2e.param?_2e.param.width:null,title:_2e.title,targetwidget:_2e.target,targeturl:null,targetparams:_2e.param}};}else{return _2e;}}};var _31=function(_32){_32=_32.toLowerCase();switch(_32){case "screen":return function(_33){return mx.screen.setContent(_33);};default:return _2c[_32];}};_1.mixin(mx.ui,{isQuirky:_1.isIE&&(_1.isQuirks||_1.isIE<9),confirm:function(_34){_1.deprecated("mx.ui.confirm","Use mx.ui.confirmation instead",_4);return mx.ui.confirmation({cancel:_34.canceltext,proceed:_34.proceedtext,content:_34.message,handler:_34.callback});},registerTarget:function(_35,_36){_2c[_35.toLowerCase()]=_36;},executeAction:function(_37){_1.deprecated("mx.ui.executeAction","Use mx.ui.action instead",_4);_37=_2d(_37);var _38=_37.target||"Screen",_39=_37.params,_3a=_31(_38);return _3a&&_3a(_39)||null;},showDialogMessage:function(_3b,_3c){_1.deprecated("mx.ui.showDialogMessage is deprecated, use info/warn/error instead","",_4);mx.ui.error(_3b);},newContext:function(_3d){_1.deprecated("mx.ui.newContext is deprecated, create an instance of mendix.lib.MxContext instead","",_4);return mx.context.create(_3d&&_3d.id);},getContext:function(_3e,_3f){_1.deprecated("mx.ui.getContext is deprecated, pass the instance of mendix.lib.MxContext instead","",_4);var _40=mx.context.get(_3e);if(!_40){_40=mx.context.create(_3f);}else{_3f!=null&&mx.context.subscribe(_3e,_3f.id);}return _40;},destroyContext:function(_41){mx.context.destroy(_41.ident);},cleanWidgetContext:function(_42){mx.context.unsubscribeAll(_42.id);},cleanContext:function(_43,_44){mx.context.clean(_43,_44.id);},getProgressIndicator:function(_45,_46){_1.deprecated("mx.ui.getProgressIndicator is deprecated, use mx.ui.getProgress instead","",_4);_45=String(_45).toLowerCase().replace("nonblocking","popup").replace("blocking","modal");return mx.ui.getProgress(_46,_45);},getLocale:function(){_1.deprecated("mx.ui.getLocale is deprecated, use dojo.locale instead","",_4);return _1.locale;}});mx.ui.registerTarget("MicroflowAction",function(_47){return mx.ui.action(_47.action,{store:{caller:_47.caller},context:_47.mxcontext,callback:_47.callback,params:{gridid:_47.gridid,applyto:"selection",guids:[_47.mxcontext.getTrackId()]}});});mx.ui.registerTarget("XASAction",function(_48){return mx.ui.action(_48.actionname,{store:{caller:_48.caller},async:/true/.test(_48.async),params:_48.actionparams,context:_48.mxcontext,callback:_48.callback,error:_48.error,progress:{type:_48.progress,message:_48.progressmsg}});});var _49={};var _4a=function(fnc){return function(_4b){try{var _4c=fnc(_4b);}catch(e){logger.error(name+".sendMessage: trouble calling subscriber: "+e);}return (_4c instanceof _1.Deferred||_4c instanceof Error)?_4c:_4b;};};_1.mixin(mx.screen||(mx.screen={}),{setContent:function(_4d){_1.deprecated("mx.screen.setContent is deprecated, use mx.ui.openForm instead","",_4);if("form" in _4d){_4d={targeturl:_4d.form.path,targetparams:_4d.targetparams,uilocation:_4d.form.location,title:_4d.form.title,resizable:_4d.form.resizable};}var _4e=_4d.targetparams&&_4d.targetparams.mxcontext;if(_4e){delete _4d.targetparams.mxcontext;}return mx.ui.openForm(_4d.targeturl,{params:_4d.targetparams,location:_4d.uilocation,title:_4d.title,resizable:_4d.resizable,context:_4e});},showProgress:function(){_1.deprecated("mx.screen.showProgress is deprecated, use mx.ui.showProgress instead","",_4);return this._lastProgress=mx.ui.showProgress();},hideProgress:function(id){_1.deprecated("mx.screen.hideProgress is deprecated, use mx.ui.hideProgress instead","",_4);return mx.ui.hideProgress(typeof id=="undefined"?this._lastProgress:id);},subscribe:function(_4f,_50,fnc){_1.deprecated("mx.screen.subscribe is deprecated, use mxform.listen instead","",_4);var id=mendix.lang.getUniqueId();return (_49[id]=[id,_4f,_50,fnc]);},unsubscribe:function(_51){_1.deprecated("mx.screen.unsubscribe is deprecated, use mxform.unlisten instead","",_4);if(_51){var id=_51[0];if(_49[id]){delete _49[id];}else{}}},sendMessage:function(_52,_53,_54){_1.deprecated("mx.screen.sendMessage is deprecated, use save / commit / rollback on mxform instead","",_4);var _55=mxui.currentForm;if(!_53||!_55){return null;}switch(_53){case "saveObject":return _55.save(callback);case "commitObject":return _55.commit(callback);case "rollbackObject":return _55.rollback(callback);default:var _56=new _1.Deferred(),_57=new _1.Deferred(),_58=[];for(var i in _49){var _59=_49[i],cid=_59[1],msg=_59[2],fnc=_59[3];if(cid==_52&&msg==_53){_58.push(_4a(fnc));}}_54&&_54.reversed&&_58.reverse();while(_58.length){_57.addCallback(_58.shift());}_57.addCallback(function(_5a){_56.callback();return _5a;});_57.addErrback(function(e){_56.errback(e);return e;});_57.callback(_54);return _56;}},getUIPlace:function(_5b){_1.deprecated("mx.screen.getUIPlace is deprecated, use place property of mxform instead","",_4);var _5c=_5b.widget&&_5b.widget.mxform;if(_5c){return _5c.place;}else{logger.error("mx.screen.getUIPlace: no widget passed, or widget not bound to a form.");}},getTitle:function(_5d){_1.deprecated("mx.screen.getTitle is deprecated, use mxform.getTitle instead","",_4);var _5e=_5d.widget&&_5d.widget.mxform;if(_5e){return _5e.getTitle();}else{logger.error("mx.screen.getTitle: no widget passed, or widget not bound to a form.");}},resumeContent:function(_5f){_1.deprecated("mx.screen.resumeContent is deprecated, use mxform.resume instead","",_4);var _60=_5f.widget&&_5f.widget.mxform;if(_60){_60.resume();}else{logger.error("mx.screen.resumeContent: no widget passed, or widget not bound to a form.");}},suspendContent:function(_61){_1.deprecated("mx.screen.suspendContent is deprecated, use mxform.suspend instead","",_4);var _62=_61.widget&&_61.widget.mxform;if(_62){_62.suspend();}else{logger.error("mx.screen.suspendContent: no widget passed, or widget not bound to a form.");}},disposeContent:function(_63){_1.deprecated("mx.screen.disposeContent is deprecated, use mxform.close instead","",_4);var _64=_63.widget&&_63.widget.mxform;if(_64){_64.close();}else{logger.error("mx.screen.disposeContent: no widget passed, or widget not bound to a form.");}},resizeContent:function(_65){_1.deprecated("mx.screen.resizeContent is deprecated, use mxform.resize instead","",_4);var _66=_65.widget&&_65.widget.mxform;if(_66){_66.resize();}else{logger.error("mx.screen.resizeContent: no widget passed, or widget not bound to a form.");}},reloadContent:function(_67){_1.deprecated("mx.screen.reloadContent is deprecated, use mxform.reload instead","",_4);var _68=_67.widget&&_67.widget.mxform;if(_68){_68.reload();}else{logger.error("mx.screen.reloadContent: no widget passed, or widget not bound to a form.");}},shutdown:mx.ui.shutdown,startup:mx.ui.startup,isLoaded:mx.ui.isLoaded});_5("mx.screen","showLogin","mx.ui","showLogin",_4);_5("mx.screen","hideLogin","mx.ui","hideLogin",_4);_5("mx.screen","logout","mx.session","logout",_4);_5("mx.screen","layout","mx.ui","resize",_4);_5("mx.screen","applyToNode","mx.ui","applyToNode",_4);mxui.lib.putContent=mendix.lib.putContent=function(url,_69,_6a){_1.deprecated("mxui.lib.putContent is deprecated, use mx.ui.openForm instead","",_4);if(typeof url=="object"){var _6b=url,_6c=_69;url=_6b.url;_69=_6b.params;_6a=_6b.node;}else{var _6d=new _1.Deferred();}mx.ui.openForm(url,{domNode:_6a,params:_69,error:function(_6e){_6d?_6d.errback(_6e):_6b.error&&_6b.error.call(_6c,_6e);},callback:function(_6f){_1.style(_6f.domNode,"height","auto");if(_6d){_6d.callback("",_6f.id,_6f);}else{_6b.callback&&_6b.callback.call(null,"",_6f.id,_6f);}},context:_69.context});return _6d;};mx.config={getForm:function(_70){_1.deprecated("mx.config.getForm is deprecated, use mx.ui.openForm instead","",_4);if(!_70.callback){var _71=new _1.Deferred();}mx.ui.getForm(_70.url,{error:_70.error,callback:function(_72){(_71||_70)["callback"](_72.domNode,_72.id);}});return _71;}};_5("mendix.dom","mxui.dom",_4);_5("mendix.html","mxui.html",_4);_5("mendix.wm.focus","mxui.wm.focus",_4);_5("mendix.dom","liveconnect","mxui.dom","liveConnect",_4);_5("mxui.addon","mxui.mixin",_4);_5("mendix.addon","mxui.mixin",_4);_5("mendix.widget","mxui.widget",_4);_5("mobile.dom","mxui.dom",_4);_5("mobile.widget","_Widget","mxui.widget","_WidgetBase",_4);})();});