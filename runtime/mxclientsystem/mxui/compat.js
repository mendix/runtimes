
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/compat",["dojo","dijit","dojox"],function(_1,_2,_3){_1.provide("mxui.compat");(function(){var _4="6.0",_5=mendix.lang.deprecate;_5("mxui.dom",{removeElement:"orphan",setTextContent:"text",getTextContent:"text",textContent:"text"},_4);_5("mxui.dom","removeChildNodes","dojo","empty",_4);_5("mxui.dom","clearSelectOptions","dojo","empty",_4);_1.mixin(mxui.dom,{copyChildren:function(_6,_7){_1.deprecated("mxui.dom.copyChildren","Use dojo.clone instead","7.0");var _8=_6.cloneNode(true);while(_8.firstChild){_7.appendChild(_8.removeChild(_8.firstChild));}},insertBefore:function(_9,_a){_1.deprecated("mxui.dom.insertBefore","Use dojo.place instead","7.0");if(_a.parentNode){_a.parentNode.insertBefore(_9,_a);}},insertAfter:function(_b,_c){_1.deprecated("mxui.dom.insertAfter","Use dojo.place instead","7.0");if(_c.parentNode){if(_c.nextSibling){_c.nextSibling.parentNode.insertBefore(_b,_c.nextSibling);}else{_c.parentNode.appendChild(_b);}}},getAncestorClass:function(_d,_e,_f){_1.deprecated("mxui.dom.getAncestorClass","Use dojo.query instead",_4);return _d&&(_1.hasClass(_d,_e)?_d:((--_f==0)?false:arguments.callee(_d.parentNode,_e,_f)));},getElementsByTagNames:function(_10,_11){_1.deprecated("mxui.dom.getElementsByTagNames","Use dojo.query instead",_4);return _1.query(_11,_10);},getAncestorNodeWithAttribute:function(_12,_13,_14,_15){_1.deprecated("mxui.dom.getAncestorNodeWithAttribute","Use dojo.query instead",_4);return ((_12.nodeName==_13)&&(_12.getAttribute&&(_12.getAttribute(_14)!=null)))?_12:(--_15==0)?null:arguments.callee(_12.parentNode,_13,_14,_15);},setHTML:function(_16,str){_1.deprecated("mxui.dom.setHTML","Use mxui.dom.html instead",_4);mxui.dom.html(_16,str);},getSelectOptions:function(_17){_1.deprecated("mxui.dom.getSelectOptions","Use mxui.dom.getSelectedValue instead",_4);return [_17.options[_17.selectedIndex].value];},selectOption:function(_18,str){_1.deprecated("mxui.dom.selectOption","Use dojo.attr instead",_4);_18.value=str;},hasClass:function(_19,_1a){_1.deprecated("mxui.dom.hasClass","Use dojo.hasClass instead",_4);return _1.hasClass(_19,_1a);},getClass:function(_1b){_1.deprecated("mxui.dom.getClass","Use dojo.getAttr instead",_4);return _1b.className;},setClass:function(_1c,str){_1.deprecated("mxui.dom.setClass","Use dojo.replaceClass instead",_4);_1c.className=str;},addClass:function(_1d,str){_1.deprecated("mxui.dom.addClass","Use dojo.addClass instead",_4);_1.addClass(_1d,str);},addClasses:function(_1e,_1f){_1.deprecated("mxui.dom.addClasses","Use dojo.addClass instead",_4);_1.addClass(_1e,_1f);},removeClass:function(_20,str){_1.deprecated("mxui.dom.removeClass","Use dojo.removeClass instead",_4);_1.removeClass(_20,str);},hide:function(_21){_1.deprecated("mxui.dom.hide","Use dojo.style instead",_4);_21.style.display="none";},show:function(_22){_1.deprecated("mxui.dom.show","Use dojo.style instead",_4);_22.style.display="";},setReadOnly:function(_23){_1.deprecated("mxui.dom.setReadOnly","Use dojo.setAttr instead",_4);return _23.setAttribute("readonly","readonly");},unsetReadOnly:function(_24){_1.deprecated("mxui.dom.unsetReadOnly","Use dojo.removeAttr instead",_4);return _24.removeAttribute("readonly");},applyDisableStyle:function(_25){_1.deprecated("mxui.dom.applyDisableStyle","Use dojo.setAttr instead",_4);var _26=_25.nodeName;if(_26=="SELECT"||(_26=="INPUT"&&_25.type=="checkbox")){_25.setAttribute("disabled","disabled");}else{if(_26=="INPUT"||_26=="TEXTAREA"||_26=="BUTTON"){_25.setAttribute("readonly","readonly");}}},applyEnableStyle:function(_27){_1.deprecated("mxui.dom.applyEnableStyle","Use dojo.removeAttr instead",_4);_27.removeAttribute("readonly");var _28=_27.nodeName.toLowerCase();if(_28=="select"||(_28=="input"&&_27.type=="checkbox")){_27.removeAttribute("disabled");}},setOpacity:function(_29,_2a){_1.deprecated("mxui.dom.setOpacity","Use dojo.style instead",_4);_1.style(_29,"opacity",_2a);},insertCss:function(_2b,doc,_2c){_1.deprecated("mxui.dom.insertCss","Use mxui.dom.addCss instead",_4);mxui.dom.addCss(_2b,doc,_2c);},escapeHTML:function(str){_1.deprecated("mxui.dom.escapeHTML","Use mxui.dom.escapeString instead",_4);return mxui.dom.escapeString(str);},getFormElementText:function(_2d){_1.deprecated("mxui.dom.getFormElementText","Use dojo.getAttr instead",_4);if(_2d.nodeName.toLowerCase()=="input"){return _2d.value;}else{if(_2d.nodeName.toLowerCase()=="select"){return _2d.options[_2d.selectedIndex].text;}}},getStringSize:function(str){_1.deprecated("mxui.dom.getStringSize","Use dojo.contentBox instead",_4);var _2e=document.createElement("span");document.body.appendChild(_2e);_2e.innerHTML=(str==="")?"A":str;var _2f=_2e.offsetWidth+10;_2e.parentNode.removeChild(_2e);_2e=null;return _2f;},clone:function(_30){_1.deprecated("mxui.dom.clone","Use dojo.clone instead",_4);return _1.clone(_30);},getFirstElement:function(_31){_1.deprecated("mxui.dom.getFirstElement","Use Element.children instead",_4);var _32=_31.children;return _32.length===0?null:_32[0];}});var _33={};var _34=function(_35){if(_35.target.match("MxApplication")){var _36=_35.param.contenturl,_37={};for(var x in _35.param){_37[x]=_35.param[x];}delete _37.contenturl;return {target:"Screen",params:{uilocation:"content",title:_35.title,targetwidget:null,targeturl:_36,targetparams:_37}};}else{if(_35.uilocation){return {target:"Screen",params:{uilocation:_35.uilocation,width:_35.param?_35.param.width:null,title:_35.title,targetwidget:_35.target,targeturl:null,targetparams:_35.param}};}else{return _35;}}};var _38=function(_39){_39=_39.toLowerCase();switch(_39){case "screen":return function(_3a){return mx.screen.setContent(_3a);};default:return _33[_39];}};_1.mixin(mx.ui,{isQuirky:_1.isIE&&(_1.isQuirks||_1.isIE<9),confirm:function(_3b){_1.deprecated("mx.ui.confirm","Use mx.ui.confirmation instead",_4);return mx.ui.confirmation({cancel:_3b.canceltext,proceed:_3b.proceedtext,content:_3b.message,handler:_3b.callback});},registerTarget:function(_3c,_3d){_33[_3c.toLowerCase()]=_3d;},executeAction:function(_3e){_1.deprecated("mx.ui.executeAction","Use mx.ui.action instead",_4);_3e=_34(_3e);var _3f=_3e.target||"Screen",_40=_3e.params,_41=_38(_3f);return _41&&_41(_40)||null;},showDialogMessage:function(_42,_43){_1.deprecated("mx.ui.showDialogMessage is deprecated, use info/warn/error instead","",_4);mx.ui.error(_42);},newContext:function(_44){_1.deprecated("mx.ui.newContext is deprecated, create an instance of mendix.lib.MxContext instead","",_4);return new mendix.lib.MxContext();},getProgressIndicator:function(_45,_46){_1.deprecated("mx.ui.getProgressIndicator is deprecated, use mx.ui.getProgress instead","",_4);_45=String(_45).toLowerCase().replace("nonblocking","popup").replace("blocking","modal");return mx.ui.getProgress(_46,_45);},getLocale:function(){_1.deprecated("mx.ui.getLocale is deprecated, use dojo.locale instead","",_4);return _1.locale;},getForm:function(_47,_48,_49){_1.deprecated("mx.ui.getForm() is deprecated, use openForm and pass domNode to open initialized form inline","",_4);var _4a=mxui.dom.create("div",{"style":"height: 0; overflow: hidden;"});document.body.appendChild(_4a);mx.ui.openFormInNode(_47,_4a,null,_48.params,function(_4b){mxui.dom.orphan(_4a);_48.callback&&_48.callback.call(_49,_4b);},_48.error);}});mx.ui.registerTarget("MicroflowAction",function(_4c){return mx.ui.action(_4c.action,{store:{caller:_4c.caller},context:_4c.mxcontext,callback:_4c.callback,params:{gridid:_4c.gridid,applyto:"selection",guids:[_4c.mxcontext.getTrackId()]}});});mx.ui.registerTarget("XASAction",function(_4d){return mx.ui.action(_4d.actionname,{store:{caller:_4d.caller},async:/true/.test(_4d.async),params:_4d.actionparams,context:_4d.mxcontext,callback:_4d.callback,error:_4d.error,progress:{type:_4d.progress,message:_4d.progressmsg}});});var _4e=mx.ui.showLogin;mx.ui.showLogin=function(_4f){if(_4f&&_4f.http_code!==undefined){_1.deprecated("Use mx.ui.showLogin(messageCode) instead of mx.ui.showLogin({ http_code: '..', no_alert: true/false })","",_4);var _50=_4f.http_code;if(_4f.no_alert&&!mendix.lang.inArray(_4f.http_code,["402","404","500","503"])){_50=undefined;}_4e.call(this,_50);}else{_4e.apply(this,arguments);}};var _51=null;_1.connect(mxui.widget.Login.prototype,"show",function(){_51=this;});mx.ui.hideLogin=function(){_1.deprecated("mx.ui.hideLogin is deprecated","",_4);_51&&_51.destroy();_51=null;};var _52={};var _53=function(fnc){return function(_54){try{var _55=fnc(_54);}catch(e){logger.error(name+".sendMessage: trouble calling subscriber: "+e);}return (_55 instanceof _1.Deferred||_55 instanceof Error)?_55:_54;};};_1.mixin(mx.screen||(mx.screen={}),{setContent:function(_56){_1.deprecated("mx.screen.setContent is deprecated, use mx.ui.openForm instead","",_4);if("form" in _56){_56={targeturl:_56.form.path,targetparams:_56.targetparams,uilocation:_56.form.location,title:_56.form.title,resizable:_56.form.resizable};}var _57=_56.targetparams&&_56.targetparams.mxcontext;if(_57){delete _56.targetparams.mxcontext;}return mx.ui.openForm(_56.targeturl,{params:_56.targetparams,location:_56.uilocation,title:_56.title,resizable:_56.resizable,context:_57});},showProgress:function(){_1.deprecated("mx.screen.showProgress is deprecated, use mx.ui.showProgress instead","",_4);return this._lastProgress=mx.ui.showProgress();},hideProgress:function(id){_1.deprecated("mx.screen.hideProgress is deprecated, use mx.ui.hideProgress instead","",_4);return mx.ui.hideProgress(typeof id=="undefined"?this._lastProgress:id);},subscribe:function(_58,_59,fnc){_1.deprecated("mx.screen.subscribe is deprecated, use mxform.listen instead","",_4);var id=mendix.lang.getUniqueId();return (_52[id]=[id,_58,_59,fnc]);},unsubscribe:function(_5a){_1.deprecated("mx.screen.unsubscribe is deprecated, use mxform.unlisten instead","",_4);if(_5a){var id=_5a[0];if(_52[id]){delete _52[id];}else{}}},sendMessage:function(_5b,_5c,_5d){_1.deprecated("mx.screen.sendMessage is deprecated, use save / commit / rollback on mxform instead","",_4);var _5e=mx.ui.getCurrentForm();if(!_5c||!_5e){return null;}switch(_5c){case "saveObject":return _5e.save(callback);case "commitObject":return _5e.commit(callback);case "rollbackObject":return _5e.rollback(callback);default:var _5f=new _1.Deferred(),_60=new _1.Deferred(),_61=[];for(var i in _52){var _62=_52[i],cid=_62[1],msg=_62[2],fnc=_62[3];if(cid==_5b&&msg==_5c){_61.push(_53(fnc));}}_5d&&_5d.reversed&&_61.reverse();while(_61.length){_60.addCallback(_61.shift());}_60.addCallback(function(_63){_5f.callback();return _63;});_60.addErrback(function(e){_5f.errback(e);return e;});_60.callback(_5d);return _5f;}},getUIPlace:function(_64){_1.deprecated("mx.screen.getUIPlace is deprecated, use place property of mxform instead","",_4);var _65=_64.widget&&_64.widget.mxform;if(_65){return _65.place;}else{logger.error("mx.screen.getUIPlace: no widget passed, or widget not bound to a form.");}},getTitle:function(_66){_1.deprecated("mx.screen.getTitle is deprecated, use mxform.getTitle instead","",_4);var _67=_66.widget&&_66.widget.mxform;if(_67){return _67.getTitle();}else{logger.error("mx.screen.getTitle: no widget passed, or widget not bound to a form.");}},resumeContent:function(_68){_1.deprecated("mx.screen.resumeContent is deprecated, don't use it","",_4);},suspendContent:function(_69){_1.deprecated("mx.screen.suspendContent is deprecated, don't use it","",_4);},disposeContent:function(_6a){_1.deprecated("mx.screen.disposeContent is deprecated, use mxform.close instead","",_4);var _6b=_6a.widget&&_6a.widget.mxform;if(_6b){_6b.close();}else{logger.error("mx.screen.disposeContent: no widget passed, or widget not bound to a form.");}},resizeContent:function(_6c){_1.deprecated("mx.screen.resizeContent is deprecated, use mxform.resize instead","",_4);var _6d=_6c.widget&&_6c.widget.mxform;if(_6d){_6d.resize();}else{logger.error("mx.screen.resizeContent: no widget passed, or widget not bound to a form.");}},reloadContent:function(){_1.deprecated("mx.screen.reloadContent is deprecated, use mx.ui.reload instead","",_4);mx.ui.reload();},refresh:function(){_1.deprecated("mx.screen.refresh is deprecated, use mx.ui.reload instead","",_4);mx.ui.reload();},shutdown:mx.ui.shutdown,startup:mx.ui.startup,isLoaded:mx.ui.isLoaded});_5("mx.screen","showLogin","mx.ui","showLogin",_4);_5("mx.screen","hideLogin","mx.ui","hideLogin",_4);_5("mx.screen","logout","mx","logout",_4);_5("mx.screen","layout","mx.ui","resize",_4);_5("mx.screen","applyToNode","mx.ui","applyToNode",_4);mxui.lib.putContent=mendix.lib.putContent=function(url,_6e,_6f){_1.deprecated("mxui.lib.putContent is deprecated, use mx.ui.openForm instead","",_4);if(typeof url=="object"){var _70=url,_71=_6e;url=_70.url;_6e=_70.params;_6f=_70.node;}else{var _72=new _1.Deferred();}mx.ui.openFormInNode(url,_6f,_6e.context,_6e,function(_73){_1.style(_73.domNode,"height","auto");if(_72){_72.callback("",_73.id,_73);}else{_70.callback&&_70.callback.call(null,"",_73.id,_73);}},function(_74){_72?_72.errback(_74):_70.error&&_70.error.call(_71,_74);});return _72;};_5("mendix.dom","mxui.dom",_4);_5("mendix.html","mxui.html",_4);_5("mendix.wm.focus","mxui.wm.focus",_4);_5("mendix.dom","liveconnect","mxui.dom","liveConnect",_4);_5("mxui.addon","mxui.mixin",_4);_5("mendix.addon","mxui.mixin",_4);_5("mendix.widget","mxui.widget",_4);_5("mobile.dom","mxui.dom",_4);_5("mobile.widget","_Widget","mxui.widget","_WidgetBase",_4);_5("mxui.html","setContent","mxui.dom","text",_4);_5("mxui.html","sanitizeHTMLString","mxui.dom","unescapeString",_4);})();});