
/* Copyright (c) 2005-2012, Mendix bv. All rights reserved. */

//>>built
define("mxui/mixin/_ValidationHelper",["dojo/dom-class","dojo/_base/declare"],function(_1,_2){var _3=_2(null,{required:false,requiredMsg:"",validator:null,_errorNode:null,_cellNode:null,_valsub:null,_valattr:null,_hasError:false,setupValidation:function(_4){var _5=this.domNode.parentNode;if(_5.nodeName==="TD"){this._cellNode=_5;}this._valattr=_4||null;},setValidationObject:function(_6){if(this._valsub){this.unsubscribe(this._valsub);}if(_6){this._valsub=this.subscribe({guid:_6.getGuid(),callback:this.onValidation,val:true});}this.removeError();},validatedMicroflow:function(_7){var _8=this;var _9=function(){window.mx.ui.execute({microflow:_7},{context:_8.mxcontext});};switch(_7.validate){case "node":if(this.isValid()){_9();}break;case "view":this.mxform.validate(_9);break;default:_9();break;}},onValidation:function(_a){var _b=_a[0],_c=this._valattr,_d=_b.getReasonByAttribute(_c);if(_d!=null){this.addError(_d);_b.removeAttribute(_c);}else{this.removeError();}},validate:function(){if(this.checkValidations&&!this.checkValidations()){return "";}if(this.required&&this.get("value")===""){return (this.requiredMessage||this.requiredMsg||window.mx.ui.translate("mendix.lib.Validations","required_field"));}},isValid:function(){var _e=this.validate();if(_e!=null){this.addError(_e);return false;}else{this.removeError();return true;}},addError:function(_f){this.removeError();this._hasError=true;if(_f){this._errorNode=mxui.dom.create("div",{"class":"alert alert-danger"},_f);this.domNode.parentNode.appendChild(this._errorNode);this.mxform.resize();}if(this._cellNode){_1.add(this._cellNode,"has-error");}if(this.validator){this.validator.addNotification();}},removeError:function(){if(this._errorNode){mxui.dom.orphan(this._errorNode);this._errorNode=null;}if(this._cellNode){_1.remove(this._cellNode,"has-error");}if(this.validator&&this._hasError){this.validator.removeNotification();}this._hasError=false;}});return _3;});