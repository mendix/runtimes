/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/mixin/_ValidationHelper",["mxui/dom","mxui/lib/errorMessage","dojo/dom-class","dojo/_base/declare"],function(_1,_2,_3,_4){var _5=_4(null,{required:false,requiredMsg:"",validator:null,_errorNode:null,_cellNode:null,_valsub:null,_valattr:null,_hasError:false,setupValidation:function(_6){var _7=this.domNode.parentNode;if(_7.nodeName==="TD"){this._cellNode=_7;}this._valattr=_6||null;},setValidationObject:function(_8){if(this._valsub){this.unsubscribe(this._valsub);}if(_8){this._valsub=this.subscribe({guid:_8.getGuid(),callback:this.onValidation,val:true});}this.removeError();},validatedMicroflow:function(_9){var _a=this;var _b=function(){window.mx.ui.execute({microflow:_9},{context:_a.mxcontext,store:{caller:_a.mxform}});};switch(_9.validate){case "node":if(this.isValid()){_b();}break;case "view":this.mxform.validate(_b);break;default:_b();break;}},onValidation:function(_c){var _d=_c[0],_e=this._valattr,_f=_d.getReasonByAttribute(_e);if(_f!=null){this.addError(_f);_d.removeAttribute(_e);}else{this.removeError();}},validate:function(){if(this.checkValidations&&!this.checkValidations()){return "";}if(this.required&&this.get("value")===""){return (this.requiredMessage||this.requiredMsg||window.mx.ui.translate("mendix.lib.Validations","required_field"));}},isValid:function(){var _10=this.validate();if(_10!=null){this.addError(_10);return false;}else{this.removeError();return true;}},addError:function(msg){this.removeError();this._hasError=true;if(msg){_2.show(this.domNode,msg);this.mxform.resize();}if(this._cellNode){_3.add(this._cellNode,"has-error");}if(this.validator){this.validator.addNotification();}},removeError:function(){_2.hide(this.domNode);if(this._cellNode){_3.remove(this._cellNode,"has-error");}if(this.validator&&this._hasError){this.validator.removeNotification();}this._hasError=false;}});return _5;});