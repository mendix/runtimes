/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("mxui/mixin/_ValidationHelper",["mxui/dom","mxui/lib/errorMessage","dojo/dom-class","dojo/_base/declare"],function(_1,_2,_3,_4){var _5=_4(null,{required:false,requiredMsg:"",validator:null,_errorNode:null,_valsub:null,_valattr:null,_hasError:false,setupValidation:function(_6){this._valattr=_6||null;},setValidationObject:function(_7){if(this._valsub){this.unsubscribe(this._valsub);}if(_7){this._valsub=this.subscribe({guid:_7.getGuid(),callback:this.onValidation,val:true});}this.removeError();},validatedMicroflow:function(_8){var _9=this;var _a=function(){window.mx.ui.execute({microflow:_8},{context:_9.mxcontext,store:{caller:_9.mxform}});};switch(_8.validate){case "node":if(this.isValid()){_a();}break;case "view":this.mxform.validate(_a);break;default:_a();break;}},onValidation:function(_b){var _c=_b[0],_d=this._valattr,_e=_c.getReasonByAttribute(_d);if(_e!=null){this.addError(_e);_c.removeAttribute(_d);}else{this.removeError();}},validate:function(){if(this.checkValidations&&!this.checkValidations()){return "";}if(this.required&&this.get("value")===""){return (this.requiredMessage||this.requiredMsg||window.mx.ui.translate("mendix.lib.Validations","required_field"));}},isValid:function(){var _f=this.validate();if(_f!=null){this.addError(_f);return false;}else{this.removeError();return true;}},addError:function(msg){this.removeError();this._hasError=true;if(msg){_2.show(this.domNode,msg);this.mxform.resize();}_3.add(this.domNode,"has-error");if(this.validator){this.validator.addNotification();}},removeError:function(){_2.hide(this.domNode);_3.remove(this.domNode,"has-error");if(this.validator&&this._hasError){this.validator.removeNotification();}this._hasError=false;}});return _5;});