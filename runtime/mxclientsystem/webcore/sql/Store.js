/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("webcore/sql/Store",["bluebird/bluebird","big/big","./transaction-creators","./runners","../Store","../TaskReader","../task-helpers"],function(_1,_2,_3,_4,_5,_6,_7){function _8(){return window.openDatabase("MendixDatabase","1","Mendix Database",10*1024*1024);};function _9(_a,_b){_5.call(this);_b=_b||_8;this._tableNames=_a;this._db=_b();this._initialize()(this._db);};_9.prototype=Object.create(_5.prototype);_9.prototype._getDatabase=function(){return this._databasePromise;};_9.prototype._initialize=function(){return function(db){var _c=_3.createCreateTransaction(this._tableNames);this._databasePromise=_7.promiseFromTask(_4.runWriteTransaction(db,_c)).then(function(){return db;});return this._databasePromise;}.bind(this);};_9.prototype._deleteDatabase=function(){return function(db){var _d=_3.createDropAllTablesTransaction(this._tableNames);this._databasePromise=_7.promiseFromTask(_4.runWriteTransaction(db,_d)).then(function(){return db;});return this._databasePromise;}.bind(this);};_9.prototype._fetch=function(_e){return function(db){var _f=_3.createFetchByGuidTransaction(_e);return _7.promiseFromTask(_4.runReadTransaction(db,_f));};};_9.prototype._fetchSlice=function(_10,_11,_12){return function(db){var _13=_3.createFetchSliceTransaction(_10,_11,_12.offset,_12.limit,_12.sort);return _7.promiseFromTask(_4.runReadTransaction(db,_13));};};_9.prototype._fillBulk=function(_14,_15){return _6.ask().chain(function(db){var _16=_3.createFillBulkTransaction(_14,_15);return new _6(function(_17){return _4.runWriteTransaction(db,_16);});});};_9.prototype._insertOrReplace=function(_18,_19){return function(db){var _1a=_3.createInsertOrReplaceTransaction(_18,_19);return _7.promiseFromTask(_4.runWriteTransaction(db,_1a));};};_9.prototype._fetchDirty=function(){return _6.ask().chain(function(db){var _1b=_3.createFetchDirtyObjectsTransaction();return new _6(function(_1c){return _4.runWriteTransaction(db,_1b);});});};_9.prototype._upload=function(){return _6.ask().chain(function(db){var _1d=_3.createUploadTransaction();return new _6(function(_1e){return _4.runWriteTransaction(db,_1d);});});};_9.prototype._cleanupDirtyObjects=function(){return function(db){var _1f=_3.createDirtyCleanupTransaction();return _4.runWriteTransaction(db,_1f);};};_9.prototype._updateObject=function(_20,obj){return _6.ask().chain(function(db){var _21=_3.createUpdateTransaction(_20,obj);return new _6(function(_22){return _4.runWriteTransaction(db,_21);});});};_9.prototype._deleteObject=function(_23,_24){return _6.ask().chain(function(db){var _25=_3.createDeleteTransaction(_23,_24);return new _6(function(_26){return _4.runWriteTransaction(db,_25);});});};return _9;});