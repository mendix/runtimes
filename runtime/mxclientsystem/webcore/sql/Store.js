/*
    Copyright (c) 2005-2015, Mendix bv. All rights reserved.
    See licenses.txt for third party licenses that apply.
*/

//>>built
define("webcore/sql/Store",["bluebird/bluebird","big/big","./transaction-creators","./runners","../Store","../Task"],function(_1,_2,_3,_4,_5,_6){function _7(){return window.openDatabase("MendixDatabase","1","Mendix Database",10*1024*1024);};function _8(_9,_a,_b){_5.call(this,_a);_b=_b||_7;this._tableNames=Object.keys(_9);this._db=_b();this._initialize()(this._db);};_8.prototype=Object.create(_5.prototype);_8.prototype._getDatabase=function(){return this._databasePromise;};_8.prototype._initialize=function(){return function(db){var _c=_3.createCreateTransaction(this._tableNames);this._databasePromise=_10(_4.runWriteTransaction(db,_c)).then(function(){return db;});return this._databasePromise;}.bind(this);};_8.prototype._deleteDatabase=function(){return function(db){var _d=_3.createDropAllTablesTransaction(this._tableNames);this._databasePromise=_10(_4.runWriteTransaction(db,_d)).then(function(){return db;});return this._databasePromise;}.bind(this);};_8.prototype._fetch=function(_e){return function(db){var _f=_3.createFetchByGuidTransaction(_e);return _10(_4.runReadTransaction(db,_f));};};_8.prototype._fetchSlice=function(_11,_12,_13){return function(db){var _14=_3.createFetchSliceTransaction(_11,_12,_13.offset,_13.limit,_13.sort);return _10(_4.runReadTransaction(db,_14));};};_8.prototype._fillBulk=function(_15,_16){return function(db){var _17=_3.createFillBulkTransaction(_15,_16);return _10(_4.runWriteTransaction(db,_17));};};_8.prototype._insertOrReplace=function(_18,obj){return function(db){var _19=_3.createInsertOrReplaceTransaction(_18,obj);return _10(_4.runWriteTransaction(db,_19));};};_8.prototype._upload=function(_1a){return function(db){var _1b=_3.createUploadTransaction(_1a);return _10(_4.runReadTransaction(db,_1b));};};_8.prototype._cleanupDirtyObjects=function(){return function(db){var _1c=_3.createDirtyCleanupTransaction();return _10(_4.runWriteTransaction(db,_1c));};};return _8;function _10(t){return new _1(function(_1d,_1e){t.fork(_1e,_1d);});};});